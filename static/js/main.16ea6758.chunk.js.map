{"version":3,"sources":["stores/AppReducer.js","stores/AppStore.js","db/AppDatabase.js","utils/AppLogicUtils.js","controllers/AppLogicController.js","components/drawers/NewStory.js","images/logo192.png","components/AppNav.js","components/StoryTitle.js","images/jake-reading.png","components/pages/EmptyProjectPage.js","components/drawers/AddCustomEntity.js","components/drawers/EditColors.js","components/entity_views/GameStateListItem.js","controllers/AppValidationsController.js","components/drawers/AddEditGameStateProp.js","components/sections/GameStateConfigSection.js","components/entity_views/LocationView.js","components/drawers/AddEditLocation.js","components/drawers/AddEditArea.js","components/sections/LocationConfigSection.js","components/entity_views/SimpleEntityView.js","components/drawers/AddEditCharacter.js","components/sections/CharacterConfigSection.js","components/drawers/AddEditCustomEntity.js","components/sections/CustomEntityConfigSection.js","components/pages/ConfigPage.js","components/entity_views/ChapterView.js","components/drawers/AddEditChapter.js","components/sections/StorylineSection.js","components/pages/StoryPage.js","AppLayout.js","App.js","reportWebVitals.js","index.js"],"names":["AppReducer","state","action","type","initialCheckDone","databaseLoadError","page","payload","storyLoaded","initialState","AppContext","createContext","AppStore","children","useReducer","dispatch","Provider","value","db","Dexie","version","stores","stories","game_state_props","locations","areas","characters","custom_entity_defs","custom_entities","default_entity_colors","chapters","acts","AppLogicUtils","name","default","edit_mode","removable","description","color","getEntitiesDefaultColors","Math","floor","random","AppLogicController","open","catch","err","console","error","stack","where","equals","first","undefined","data","transaction","a","add","title","bulkAdd","getNewStoryDefaultGameStateProps","getNewStoryDefaultCharacters","getNewStoryDefaultEntityColors","then","result","log","Promise","reject","defaultValue","editMode","key","update","id","delete","location_id","singular","getCustomEntityRandomColor","custom_entity_def_id","order","affectedChapter","oldOrder","newBaseOrder","affectedChapters","orderBy","each","chapter","push","length","forEach","affected","window","location","reload","NewStory","isDrawerVisible","onDrawerClose","useContext","Form","useForm","form","useState","visible","setVisible","setTitle","setVersion","useEffect","resetFields","openDrawer","closeDrawer","width","onClose","bodyStyle","paddingBottom","footer","style","textAlign","onClick","marginRight","htmlType","layout","onFinish","values","trim","message","createNewStory","success","requiredMark","gutter","span","Item","label","rules","required","placeholder","onChange","e","target","Sider","Layout","AppNav","collapsed","setCollapsed","shouldRenderMenu","setShouldRenderMenu","newStoryVisible","setNewStoryVisible","setTimeout","clearStoryTest","devStartOver","toggleNav","handleClick","className","collapsible","onCollapse","src","logo","alt","theme","mode","defaultSelectedKeys","disabled","icon","SettingFilled","BookFilled","CaretRightOutlined","marginLeft","marginTop","block","PlusOutlined","marginBottom","UploadOutlined","DownloadOutlined","onConfirm","onCancel","okText","cancelText","placement","DeleteFilled","BugOutlined","Header","Title","Typography","Text","StoryTitle","story","useLiveQuery","level","Content","EmptyProjectPage","jake_reading","AddCustomEntity","createNewCustomEntityDef","toLowerCase","replace","setFieldsValue","readOnly","EditColors","newDefaultColors","setNewDefaultColors","newCustomColors","setNewCustomColors","saveSucceed","setSaveSucceed","customEntityDefs","toArray","defaultEntityColors","Object","keys","updateDefaultEntityColor","parseInt","updateCustomEntityDefColor","dataSource","renderItem","item","textTransform","animation","enableAlpha","colors","newColors","setDefaultEntityColor","margin","setCustomEntityColor","GameStateListItem","gameState","onEditGameStateProp","onRemoveGameStateProp","endsWith","size","AppValidationsController","testNames","dbTable","invalidNames","resolve","entityDefId","TextArea","Input","Option","Select","AddEditGameStateProp","gameStateProp","setName","setType","defaultValueInt","setDefaultValueInt","defaultValueBool","setDefaultValueBool","defaultValueString","setDefaultValueString","defaultValueArray","setDefaultValueArray","valuesArray","split","join","unquotedEntries","entry","slice","populateDefault","displaySingleLineDefaultField","arrayFieldLabelAndPlaceholder","singular_name","valudateArrayTypes","defaultValues","saveGameStateProp","integerValue","Number","isInteger","booleanValue","validateEntityNames","invalidLocations","invalidAreas","invalidCharacters","customEntityDef","find","validateCustomEntityNames","invalidEntities","getDefaultValue","newData","createNewGameStateProp","editData","updateGameStateProp","quotesWrappedEntries","isDefaultDisabled","indexOf","defaultLocation","defaultArea","defaultCharacter","defaultEntity","isNameDisabled","isTypeDisabled","map","display","checkedChildren","unCheckedChildren","checked","defaultChecked","rows","GameStateConfigSection","addEditGameStatePropVisible","setAddEditGameStatePropVisible","currentGameStateProp","setCurrentGameStateProp","gameStates","header","strong","maxWidth","deleteGameStateProp","LocationView","canEdit","canRemove","onRemove","onEdit","onAddArea","onEditArea","onRemoveArea","options","extra","headStyle","background","area","AddEditLocation","setDescription","createNewLocation","updateLocation","AddEditArea","createNewArea","updateArea","LocationConfigSection","addEditLocationVisible","setAddEditLocationVisible","addEditAreaVisible","setAddEditAreaVisible","currentLocation","setCurrentLocation","currentArea","setCurrentArea","deleteLocation","removeLocation","editLocation","addArea","editArea","deleteArea","removeArea","SimpleEntityView","entity","entityName","AddEditCharacter","character","createNewCharacter","updateCharacter","CharacterConfigSection","addEditCharacterVisible","setAddEditCharacterVisible","currentCharacter","setCurrentCharacter","deleteCharacter","removeCharacter","editCharacter","AddEditCustomEntity","entityDef","singularCapitalized","charAt","toUpperCase","createNewCustomEntity","updateCustomEntity","CustomEntityConfigSection","addEditCustomEntityVisible","setAddEditCustomEntityVisible","currentCustomEntity","setCurrentCustomEntity","entities","deleteCustomEntityDef","danger","deleteCustomEntity","removeEntity","editEntity","TabPane","Tabs","ConfigPage","addCustomEntityVisible","setAddCustomEntityVisible","editColorsVisible","setEditColorsVisible","addCustomEntityButton","PlusSquareOutlined","buttons","BgColorsOutlined","tabBarExtraContent","tab","index","ChapterView","chapterIndex","totalChapters","onMoveOrderUp","onMoveOrderDown","CaretUpOutlined","CaretDownOutlined","AddEditChapter","setChapterIndex","createNewChapter","updateChapter","StorylineSection","addEditChapterVisible","setAddEditChapterVisible","currentChapter","setCurrentChapter","deleteChapter","removeChapter","editCharpter","orderInfo","updateChapterOrder","moveCharpterUp","moveCharpterDown","StoryPage","AppLayout","checkDatabaseOk","checkStoryLoaded","React","createElement","App","reportWebVitals","onPerfEntry","Function","getCLS","getFID","getFCP","getLCP","getTTFB","ReactDOM","render","StrictMode","document","getElementById"],"mappings":"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","file":"static/js/main.16ea6758.chunk.js","sourcesContent":["const AppReducer = (state, action) => {\n  switch (action.type) {\n    case 'SET_APP_INITIAL_CHECK_DONE':\n      return {\n        ...state,\n        initialCheckDone: true,\n        };\n    case 'SET_APP_DATABASE_LOAD_ERROR':\n      return {\n        ...state,\n        databaseLoadError: true,\n        initialCheckDone: true,\n      };\n    case 'SET_APP_PAGE':\n      return {\n        ...state,\n        page: action.payload,\n      };\n    case 'SET_STORY_LOADED':\n      return {\n        ...state,\n        storyLoaded: action.payload,\n        page: (action.payload ? 'CONFIG' : 'EMPTY'),\n        };\n\n    // case 'ADD_POST':\n    //     return {\n    //         ...state,\n    //         posts: state.posts.concat(action.payload)\n    //     };\n    // case 'REMOVE_POST':\n    //     return {\n    //         ...state,\n    //         posts: state.posts.filter(post => post.id !== action.payload)\n    //     };\n    // case 'SET_ERROR':\n    //     return {\n    //         ...state,\n    //         error: action.payload\n    //     };\n    default:\n        return state;\n  }\n};\n\nexport default AppReducer;\n","import React, {createContext, useReducer} from \"react\";\nimport AppReducer from './AppReducer'\n\nconst initialState = {\n  initialCheckDone: false,\n  databaseLoadError: false,\n  storyLoaded: false,\n  page: 'EMPTY',\n};\n\nconst AppStore = ({children}) => {\n    const [state, dispatch] = useReducer(AppReducer, initialState);\n    return (\n        <AppContext.Provider value={[state, dispatch]}>\n            {children}\n        </AppContext.Provider>\n    )\n};\n\nexport const AppContext = createContext(initialState);\nexport default AppStore;","import Dexie from 'dexie';\n\n\nconst db = new Dexie('RpgspDatabase');\n\ndb.version(1).stores({\n    stories: '++id',                                //title, version\n    game_state_props: '++id, name',                 //type, default, edit_mode, removable\n    locations: '++id, name',                        //description\n    areas: '++id, location_id, name',               //description\n    characters: '++id, name',                       //description\n    custom_entity_defs: '++id',                     //name, key, singular_name, color\n    custom_entities: '++id, custom_entity_def_id, name',  //description\n    default_entity_colors: '++id',                  //name, color\n    //\n    chapters: '++id, order',                        //name, description\n    acts: '++id, order, type',                      //name, description\n});\n\n//default_entity_colors for: locations, areas, characters\n\n//game_state_props.edit_mode = (string) \"none|all|name|type|default\"\n\n//act.type = (string) \"sequence|interactive\"\n\n\nexport const testDatabase = () => {\n  return db.open();\n};\n\nexport default db;\n","\nclass AppLogicUtils {\n  static getNewStoryDefaultGameStateProps() {\n    return [\n      {name: 'currentChapter', type: 'integer', default: 0, edit_mode: 'none', removable: false},\n      {name: 'currentAct', type: 'integer', default: 0, edit_mode: 'none', removable: false},\n      {name: 'currentActSequence', type: 'integer', default: 0, edit_mode: 'none', removable: false},\n      {name: 'currentLocation', type: 'location', default: null, edit_mode: 'default', removable: false},\n      {name: 'currentArea', type: 'area', default: null, edit_mode: 'default', removable: false},\n    ];\n  }\n\n  static getNewStoryDefaultCharacters() {\n    return [\n      {name: '[Playable character]', description: '[Add description]'},\n    ];\n  }\n\n  static getNewStoryDefaultEntityColors() {\n    return [\n      {name: 'locations', color: AppLogicUtils.getEntitiesDefaultColors('locations')},\n      {name: 'areas', color: AppLogicUtils.getEntitiesDefaultColors('areas')},\n      {name: 'characters', color: AppLogicUtils.getEntitiesDefaultColors('characters')},\n    ];\n  }\n\n  static getEntitiesDefaultColors(name = 'locations') {\n    switch(name) {\n      case 'characters':\n        return '#1890ff';\n      case 'areas':\n        return '#a0d911';\n      case 'locations':\n      default:\n        return '#3f6600';\n    }\n  }\n\n  static getCustomEntityRandomColor() {\n    const defaultColorList = ['#ffa940', '#73d13d', '#10239e', '#36cfc9', '#9e1068', '#9254de', '#85a5ff', '#fadb14', '#ffa940', '#391085'];\n    return defaultColorList[Math.floor(Math.random() * 10)];\n  }\n\n}\n\nexport default AppLogicUtils;","import db, { testDatabase } from '../db/AppDatabase';\nimport AppLogicUtils from '../utils/AppLogicUtils';\n\nclass AppLogicController {\n\n  static checkDatabaseOk(dispatch) {\n    testDatabase().catch((err) => {\n      console.error('Failed to open db: ' + (err.stack || err));\n      dispatch({type: 'SET_APP_DATABASE_LOAD_ERROR'});\n    });\n  }\n\n  static async checkStoryLoaded(dispatch) {\n    const story = await db.stories.where('id').equals(1).first();\n    if (story !== undefined) {\n      dispatch({type: 'SET_STORY_LOADED', payload: true});\n    }\n    dispatch({type: 'SET_APP_INITIAL_CHECK_DONE'});\n  }\n\n  //-- Story --//\n  static createNewStory(dispatch, data) {\n    return db.transaction('rw', db.stories, db.game_state_props, db.characters, db.default_entity_colors, async () => {\n      await db.stories.add({'title': data.title, 'version': data.version});\n      await db.game_state_props.bulkAdd( AppLogicUtils.getNewStoryDefaultGameStateProps() );\n      await db.characters.bulkAdd( AppLogicUtils.getNewStoryDefaultCharacters() );\n      await db.default_entity_colors.bulkAdd( AppLogicUtils.getNewStoryDefaultEntityColors() );\n    }).then(result => {\n      dispatch({type: 'SET_STORY_LOADED', payload: true});\n    }).catch(error => {\n      console.log('||--FAIL', error);\n      //return reject to allow catch chain\n      return Promise.reject(error);\n    });\n    // db.stories.add({'title': data.title, 'version': data.version}).then(() => {\n    //   dispatch({type: 'SET_STORY_LOADED', payload: true});\n    // });\n  }\n\n  //-- GameStateProps --//\n  static createNewGameStateProp(dispatch, data) {\n    return db.game_state_props.add({'name': data.name, 'type': data.type, 'default': data.defaultValue, 'edit_mode': data.editMode, 'removable': data.removable}).then(() => {\n      //\n    }).catch(error => {\n      console.log('||--FAIL', error);\n      //return reject to allow catch chain\n      return Promise.reject(error);\n    });\n  }\n\n  static updateGameStateProp(dispatch, key, data) {\n    return db.game_state_props.update(key, {'name': data.name, 'type': data.type, 'default': data.defaultValue, 'edit_mode': data.editMode, 'removable': data.removable}).then(() => {\n      //\n    }).catch(error => {\n      console.log('||--FAIL', error);\n      //return reject to allow catch chain\n      return Promise.reject(error);\n    });\n  }\n\n  static deleteGameStateProp(dispatch, id) {\n    return db.game_state_props.delete(id).then(() => {\n      //\n    }).catch(error => {\n      console.log('||--FAIL', error);\n      //return reject to allow catch chain\n      return Promise.reject(error);\n    });\n  }\n\n  //-- Location & Areas --//\n  static createNewLocation(dispatch, data) {\n    return db.locations.add({'name': data.name, 'description': data.description}).then(() => {\n      //\n    }).catch(error => {\n      console.log('||--FAIL', error);\n      //return reject to allow catch chain\n      return Promise.reject(error);\n    });\n  }\n\n  static updateLocation(dispatch, key, data) {\n    return db.locations.update(key, {'name': data.name, 'description': data.description}).then(() => {\n      //\n    }).catch(error => {\n      console.log('||--FAIL', error);\n      //return reject to allow catch chain\n      return Promise.reject(error);\n    });\n  }\n\n  static deleteLocation(dispatch, id) {\n    return db.transaction('rw', db.locations, db.areas, async () => {\n      await db.areas.where('location_id').equals(id).delete();\n      await db.locations.delete(id);\n    }).then(result => {\n      //\n    }).catch(error => {\n      console.log('||--FAIL', error);\n      //return reject to allow catch chain\n      return Promise.reject(error);\n    });\n  }\n\n  static createNewArea(dispatch, data) {\n    return db.areas.add({'location_id': data.location_id, 'name': data.name, 'description': data.description}).then(() => {\n      //\n    }).catch(error => {\n      console.log('||--FAIL', error);\n      //return reject to allow catch chain\n      return Promise.reject(error);\n    });\n  }\n\n  static updateArea(dispatch, key, data) {\n    return db.areas.update(key, {'name': data.name, 'description': data.description}).then(() => {\n      //\n    }).catch(error => {\n      console.log('||--FAIL', error);\n      //return reject to allow catch chain\n      return Promise.reject(error);\n    });\n  }\n\n  static deleteArea(dispatch, id) {\n    return db.areas.delete(id).then(() => {\n      //\n    }).catch(error => {\n      console.log('||--FAIL', error);\n      //return reject to allow catch chain\n      return Promise.reject(error);\n    });\n  }\n\n  //-- Character --//\n  static createNewCharacter(dispatch, data) {\n    return db.characters.add({'name': data.name, 'description': data.description}).then(() => {\n      //\n    }).catch(error => {\n      console.log('||--FAIL', error);\n      //return reject to allow catch chain\n      return Promise.reject(error);\n    });\n  }\n\n  static updateCharacter(dispatch, key, data) {\n    return db.characters.update(key, {'name': data.name, 'description': data.description}).then(() => {\n      //\n    }).catch(error => {\n      console.log('||--FAIL', error);\n      //return reject to allow catch chain\n      return Promise.reject(error);\n    });\n  }\n\n  static deleteCharacter(dispatch, id) {\n    return db.characters.delete(id).then(() => {\n      //\n    }).catch(error => {\n      console.log('||--FAIL', error);\n      //return reject to allow catch chain\n      return Promise.reject(error);\n    });\n  }\n\n  //-- Custom Entities --//\n  static createNewCustomEntityDef(dispatch, data) {\n    return db.custom_entity_defs.add({'name': data.name, 'key': data.key, 'singular_name': data.singular, 'color': AppLogicUtils.getCustomEntityRandomColor()}).then(() => {\n      //\n    }).catch(error => {\n      console.log('||--FAIL', error);\n      //return reject to allow catch chain\n      return Promise.reject(error);\n    });\n  }\n\n  static deleteCustomEntityDef(dispatch, id) {\n    return db.transaction('rw', db.custom_entity_defs, db.custom_entities, async () => {\n      await db.custom_entities.where('custom_entity_def_id').equals(id).delete();\n      await db.custom_entity_defs.delete(id);\n    }).then(result => {\n      //\n    }).catch(error => {\n      console.log('||--FAIL', error);\n      //return reject to allow catch chain\n      return Promise.reject(error);\n    });\n  }\n\n  static createNewCustomEntity(dispatch, data) {\n    return db.custom_entities.add({'custom_entity_def_id': data.custom_entity_def_id, 'name': data.name, 'description': data.description}).then(() => {\n      //\n    }).catch(error => {\n      console.log('||--FAIL', error);\n      //return reject to allow catch chain\n      return Promise.reject(error);\n    });\n  }\n\n  static updateCustomEntity(dispatch, key, data) {\n    return db.custom_entities.update(key, {'name': data.name, 'description': data.description}).then(() => {\n      //\n    }).catch(error => {\n      console.log('||--FAIL', error);\n      //return reject to allow catch chain\n      return Promise.reject(error);\n    });\n  }\n\n  static deleteCustomEntity(dispatch, id) {\n    return db.custom_entities.delete(id).then(() => {\n      //\n    }).catch(error => {\n      console.log('||--FAIL', error);\n      //return reject to allow catch chain\n      return Promise.reject(error);\n    });\n  }\n\n  //-- Colors --//\n  static updateDefaultEntityColor(dispatch, key, data) {\n    return db.default_entity_colors.update(key, {'color': data.color}).then(() => {\n      //\n    }).catch(error => {\n      console.log('||--FAIL', error);\n      //return reject to allow catch chain\n      return Promise.reject(error);\n    });\n  }\n\n  static updateCustomEntityDefColor(dispatch, key, data) {\n    return db.custom_entity_defs.update(key, {'color': data.color}).then(() => {\n      //\n    }).catch(error => {\n      console.log('||--FAIL', error);\n      //return reject to allow catch chain\n      return Promise.reject(error);\n    });\n  }\n\n  //-- Chapters --//\n  static createNewChapter(dispatch, data) {\n    return db.chapters.add({'name': data.name, 'description': data.description, 'order': data.order}).then(() => {\n      //\n    }).catch(error => {\n      console.log('||--FAIL', error);\n      //return reject to allow catch chain\n      return Promise.reject(error);\n    });\n  }\n\n  static updateChapter(dispatch, key, data) {\n    //do not accept order update\n    return db.chapters.update(key, {'name': data.name, 'description': data.description}).then(() => {\n      //\n    }).catch(error => {\n      console.log('||--FAIL', error);\n      //return reject to allow catch chain\n      return Promise.reject(error);\n    });\n  }\n\n  static updateChapterOrder(dispatch, key, data) {\n    return db.transaction('rw', db.chapters, async () => {\n      const affectedChapter = await db.chapters.where('order').equals(data.order).first();\n      await db.chapters.update(key, {'order': data.order});\n      await db.chapters.update(affectedChapter.id, {'order': data.oldOrder});\n    }).then(result => {\n      //\n    }).catch(error => {\n      console.log('||--FAIL', error);\n      //return reject to allow catch chain\n      return Promise.reject(error);\n    });\n  }\n\n  static deleteChapter(dispatch, id) {\n    return db.transaction('rw', db.chapters, async () => {\n      let newBaseOrder = null;\n      let affectedChapters = [];\n      const chapters = db.chapters.orderBy('order');\n      await chapters.each(chapter => {\n        if(newBaseOrder !== null){\n          affectedChapters.push({key: chapter.id, order: newBaseOrder + affectedChapters.length});\n        }\n        if(chapter.id === id){\n          newBaseOrder = chapter.order;\n        }\n      });\n      await db.chapters.delete(id);\n      affectedChapters.forEach(async (affected) => {\n        await db.chapters.update(affected.key, {'order': affected.order});\n      });\n    }).then(result => {\n      //\n    }).catch(error => {\n      console.log('||--FAIL', error);\n      //return reject to allow catch chain\n      return Promise.reject(error);\n    });\n  }\n\n  //-- Dev --//\n  static devStartOver(dispatch) {\n    return db.delete().then( () => window.location.reload() );\n  }\n}\n\nexport default AppLogicController;","import { useState, useEffect, useContext } from 'react';\nimport { Drawer, Form, Button, Col, Row, Input, message } from 'antd';\nimport { AppContext } from '../../stores/AppStore';\nimport AppLogicController from '../../controllers/AppLogicController';\n\nconst NewStory = ({ isDrawerVisible, onDrawerClose }) => {\n  const [,dispatch] = useContext(AppContext);\n  const [form] = Form.useForm();\n  const [visible, setVisible] = useState(false);\n  const [title, setTitle] = useState('');\n  const [version, setVersion] = useState('');\n\n  useEffect(() => {\n    if(isDrawerVisible) { //opening drawer\n      form.resetFields();\n      openDrawer();\n    }\n  }, [isDrawerVisible, form]);\n\n  const openDrawer = () => {\n    setVisible(true);\n  };\n\n  const closeDrawer = () => {\n    setVisible(false);\n    onDrawerClose && onDrawerClose();\n  };\n\n  const onFinish = (values) => {\n    const title = values.title.trim();\n    const version = values.version.trim();\n    if(title === '' || version === ''){\n      closeDrawer();\n      message.error('Something went wrong, sorry :(');\n      return;\n    }\n    const data = {title, version};\n    AppLogicController.createNewStory(dispatch, data).then(result => {\n      closeDrawer();\n      message.success('Story created!');\n    }).catch(error => {\n      closeDrawer();\n      message.error('Something went wrong, sorry :(');\n    });\n  };\n\n  return (\n    <Drawer\n      title=\"New story\"\n      width={360}\n      onClose={closeDrawer}\n      visible={visible}\n      bodyStyle={{ paddingBottom: 20 }}\n      footer={\n        <div style={{textAlign: 'right'}} >\n          <Button onClick={closeDrawer} style={{ marginRight: 8 }}>\n            Cancel\n          </Button>\n          <Button type=\"primary\" htmlType=\"submit\" form='create-story-id'>\n            Create\n          </Button>\n        </div>\n      }\n    >\n      <Form layout=\"vertical\" name='create-story' id='create-story-id' form={form} onFinish={onFinish} requiredMark={false}>\n        <Row gutter={16}>\n          <Col span={24}>\n            <Form.Item\n              name=\"title\"\n              label=\"Title\"\n              rules={[{ required: true, message: 'Please enter a title' }]}\n            >\n              <Input placeholder=\"Please enter a title\" value={title} onChange={(e) => { setTitle(e.target.value) }} />\n            </Form.Item>\n          </Col>\n        </Row>\n        <Row gutter={16}>\n          <Col span={24}>\n            <Form.Item\n              name=\"version\"\n              label=\"Version\"\n              rules={[{ required: true, message: 'Please enter a version' }]}\n            >\n              <Input placeholder=\"Please enter a version\" value={version} onChange={(e) => { setVersion(e.target.value) }} />\n            </Form.Item>\n          </Col>\n        </Row>\n      </Form>\n    </Drawer>\n  );\n};\n\nexport default NewStory;\n","export default \"data:image/png;base64,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\"","//-- Components --//\nimport { useState, useEffect, useContext } from 'react';\nimport { Layout, Menu, Col, Row, Button, Popconfirm } from 'antd';\nimport { SettingFilled, BookFilled, DownloadOutlined, UploadOutlined, DeleteFilled, PlusOutlined, BugOutlined, CaretRightOutlined } from '@ant-design/icons';\nimport NewStory from './drawers/NewStory';\n//-- Controller --//\nimport AppLogicController from '../controllers/AppLogicController';\n//-- Context --//\nimport { AppContext } from '../stores/AppStore';\n//-- Images --//\nimport logo from '../images/logo192.png';\n//-- Style --//\nimport '../styles/components/AppNav.scss';\n\nconst { Sider } = Layout;\n\nconst AppNav = () => {\n  const [state, dispatch] = useContext(AppContext);\n\n  const [collapsed, setCollapsed] = useState(false);\n  const [shouldRenderMenu, setShouldRenderMenu] = useState(true);\n  const [newStoryVisible, setNewStoryVisible] = useState(false);\n\n  useEffect(() => {\n    setShouldRenderMenu(false);\n    setTimeout(() => {\n      setShouldRenderMenu(true);\n    }, 5);\n  }, [state.storyLoaded]);\n\n\n  //test\n  const loadStoryTest = () => {\n    dispatch({type: 'SET_STORY_LOADED', payload: true});\n  };\n  const clearStoryTest = () => {\n    AppLogicController.devStartOver(dispatch);\n    //dispatch({type: 'SET_STORY_LOADED', payload: false});\n  };\n\n  //dev\n  const devStartOver = () => {\n    AppLogicController.devStartOver(dispatch);\n  };\n\n\n\n  const toggleNav = () => {\n    setCollapsed(!collapsed);\n  };\n\n  const handleClick = ({key}) => {\n    switch(key) {\n      case '1':\n        dispatch({type: 'SET_APP_PAGE', payload: 'CONFIG'});\n        break;\n      case '2':\n        dispatch({type: 'SET_APP_PAGE', payload: 'STORY'});\n        break;\n      default:\n        break;\n    }\n  };\n\n  const renderMenu = () => {\n    return (\n      <Menu theme=\"dark\" mode=\"inline\" defaultSelectedKeys={(state.storyLoaded ? ['1'] : [])} onClick={handleClick}>\n        <Menu.Item key=\"1\" disabled={!state.storyLoaded} icon={<SettingFilled />}>\n          Configuration\n        </Menu.Item>\n        <Menu.Item key=\"2\" disabled={!state.storyLoaded} icon={<BookFilled />}>\n          Story\n        </Menu.Item>\n        <Menu.Item key=\"3\" disabled={!state.storyLoaded} icon={<CaretRightOutlined />}>\n          Play\n        </Menu.Item>\n      </Menu>\n    );\n  };\n\n  const renderClearStory = () => {\n    return (\n      <Popconfirm\n        title='All data will be lost. Are you sure to delete this story?'\n        onConfirm={clearStoryTest}\n        onCancel={() => {}}\n        okText='Yes'\n        cancelText='No'\n        placement='right'\n      >\n        <Button type='default' block icon={<DeleteFilled />} style={{ marginBottom: 12 }}>Clear story</Button>\n      </Popconfirm>\n    );\n  };\n\n  return (\n    <>\n      <Sider className='app-nav' collapsible collapsed={collapsed} onCollapse={toggleNav}>\n        <div className={`logo ${collapsed ? 'collapsed' : ''}`}>\n          <img src={logo} alt=\"RPG Story Playtesting\" onClick={toggleNav} />\n        </div>\n        <div className='menu-wrapper'>\n          {shouldRenderMenu && renderMenu()}\n        </div>\n        {!collapsed &&\n          <Row gutter={16} style={{ marginLeft: 8, marginRight: 8, marginTop: 32 }}>\n            <Col span={24}>\n              {!state.storyLoaded &&\n                <Button type=\"default\" onClick={() => { setNewStoryVisible(true); }} block icon={<PlusOutlined />} style={{ marginBottom: 12 }} >New story</Button>\n              }\n              <Button type=\"default\" block icon={<UploadOutlined />} style={{ marginBottom: 12 }} onClick={loadStoryTest}>Load story</Button>\n              {state.storyLoaded &&\n                <>\n                  <Button type=\"default\" block icon={<DownloadOutlined />} style={{ marginBottom: 12 }}>Download story</Button>\n                  {renderClearStory()}\n                </>\n              }\n              <Button type=\"default\" block icon={<BugOutlined />} style={{ marginBottom: 12 }} onClick={devStartOver}>dev:startover</Button>\n            </Col>\n          </Row>\n        }\n      </Sider>\n      <NewStory isDrawerVisible={newStoryVisible} onDrawerClose={() => { setNewStoryVisible(false); }} />\n    </>\n  );\n};\n\nexport default AppNav;\n","import { Layout, Typography } from 'antd';\nimport { useLiveQuery } from 'dexie-react-hooks';\nimport db from '../db/AppDatabase';\nimport '../styles/components/StoryTitle.scss';\n\nconst { Header } = Layout;\nconst { Title, Text } = Typography;\n\nconst StoryTitle = () => {\n  const story = useLiveQuery(() => db.stories.where('id').equals(1).first());\n\n  if (story === undefined) return null;\n\n  return (\n    <Header className='story-title'>\n      <Title level={5}>RPG-SP: {story.title}</Title>\n      <Text type='secondary'>Version: {story.version}</Text>\n    </Header>\n  );\n};\n\nexport default StoryTitle;\n","export default __webpack_public_path__ + \"static/media/jake-reading.fddcdec6.png\";","import { Layout, Typography } from 'antd';\nimport jake_reading from '../../images/jake-reading.png';\nimport '../../styles/components/pages/EmptyProjectPage.scss';\n\nconst { Content } = Layout;\nconst { Text } = Typography;\n\nconst EmptyProjectPage = () => {\n\n  return (\n    <Content className='empty-project-page'>\n      <img src={jake_reading} alt=\"Start a new story\" />\n      <Text>Create a new story or load an existing one</Text>\n    </Content>\n  );\n};\n\nexport default EmptyProjectPage;\n","import { useState, useEffect, useContext } from 'react';\nimport { Drawer, Form, Button, Col, Row, Input, message } from 'antd';\nimport { AppContext } from '../../stores/AppStore';\nimport AppLogicController from '../../controllers/AppLogicController';\n\nconst AddCustomEntity = ({ isDrawerVisible, onDrawerClose }) => {\n  const [,dispatch] = useContext(AppContext);\n  const [form] = Form.useForm();\n  const [visible, setVisible] = useState(false);\n\n  useEffect(() => {\n    if(isDrawerVisible) { //opening drawer\n      form.resetFields();\n      openDrawer();\n    }\n  }, [isDrawerVisible, form]);\n\n  const openDrawer = () => {\n    setVisible(true);\n  };\n\n  const closeDrawer = () => {\n    setVisible(false);\n    onDrawerClose && onDrawerClose();\n  };\n\n  const onNameChange = (e) => {\n    const key = e.target.value.toLowerCase().replace(/\\s/g, '');\n    form.setFieldsValue({key: key});\n  };\n\n  const onFinish = (values) => {\n    const name = values.name.trim();\n    const key = values.key.trim();\n    const singular = values.singular.trim();\n    if(name === '' || singular === ''){\n      closeDrawer();\n      message.error('Do not leave empty fields, sorry :(');\n      return;\n    }\n    const data = {name, key, singular};\n    AppLogicController.createNewCustomEntityDef(dispatch, data).then(result => {\n      closeDrawer();\n      message.success('New entity created!');\n    }).catch(error => {\n      closeDrawer();\n      message.error('Something went wrong, sorry :(');\n    });\n  };\n\n  return (\n    <Drawer\n      title=\"Add Custom Entity\"\n      width={360}\n      onClose={closeDrawer}\n      visible={visible}\n      bodyStyle={{ paddingBottom: 20 }}\n      footer={\n        <div style={{textAlign: 'right'}} >\n          <Button onClick={closeDrawer} style={{ marginRight: 8 }}>\n            Cancel\n          </Button>\n          <Button type=\"primary\" htmlType=\"submit\" form='create-custom-entity-id'>\n            Add\n          </Button>\n        </div>\n      }\n    >\n      <Form layout=\"vertical\" name='create-custom-entity' id='create-custom-entity-id' form={form} onFinish={onFinish} requiredMark={false}>\n        <Row gutter={16}>\n          <Col span={24}>\n            <Form.Item\n              name=\"name\"\n              label=\"Name (use plural)\"\n              rules={[{ required: true, message: 'Please enter a name' }]}\n            >\n              <Input placeholder=\"Please enter a name\" onChange={onNameChange} />\n            </Form.Item>\n          </Col>\n        </Row>\n        <Row gutter={16}>\n          <Col span={24}>\n            <Form.Item\n              name=\"key\"\n              label=\"Key\"\n            >\n              <Input readOnly placeholder=\"\" />\n            </Form.Item>\n          </Col>\n        </Row>\n        <Row gutter={16}>\n          <Col span={24}>\n            <Form.Item\n              name=\"singular\"\n              label=\"Singular\"\n              rules={[{ required: true, message: 'Please enter singular entity name' }]}\n            >\n              <Input placeholder=\"Please enter singular entity name\" />\n            </Form.Item>\n          </Col>\n        </Row>\n      </Form>\n    </Drawer>\n  );\n};\n\nexport default AddCustomEntity;\n","import { useState, useEffect, useContext } from 'react';\nimport { useLiveQuery } from 'dexie-react-hooks';\nimport db from '../../db/AppDatabase';\nimport { Drawer, Button, List, Row, Col, Divider, message } from 'antd';\nimport { AppContext } from '../../stores/AppStore';\nimport AppLogicController from '../../controllers/AppLogicController';\nimport ColorPicker from 'rc-color-picker';\nimport 'rc-color-picker/assets/index.css';\n\nconst EditColors = ({ isDrawerVisible, onDrawerClose }) => {\n  const [,dispatch] = useContext(AppContext);\n  const [visible, setVisible] = useState(false);\n  const [newDefaultColors, setNewDefaultColors] = useState({});\n  const [newCustomColors, setNewCustomColors] = useState({});\n  const [saveSucceed, setSaveSucceed] = useState(true);\n\n  const customEntityDefs = useLiveQuery(() => db.custom_entity_defs.toArray());\n  const defaultEntityColors = useLiveQuery(() => db.default_entity_colors.toArray());\n\n  useEffect(() => {\n    if(isDrawerVisible) { //opening drawer\n      openDrawer();\n    }\n  }, [isDrawerVisible]);\n\n  const openDrawer = () => {\n    setNewDefaultColors({});\n    setNewCustomColors({});\n    setVisible(true);\n  };\n\n  const closeDrawer = () => {\n    setVisible(false);\n    onDrawerClose && onDrawerClose();\n  };\n\n  const setDefaultEntityColor = (id, color) => {\n    let newColors = newDefaultColors;\n    newColors[id] = color;\n    setNewDefaultColors(newColors);\n  };\n\n  const setCustomEntityColor = (id, color) => {\n    let newColors = newCustomColors;\n    newColors[id] = color;\n    setNewCustomColors(newColors);\n  };\n\n  const updateNewColors = () => {\n    setSaveSucceed(true);\n    if(Object.keys(newDefaultColors).length === 0 && Object.keys(newCustomColors).length === 0 ) {\n      closeDrawer();\n      return;\n    }\n    for (const id in newDefaultColors) {\n      AppLogicController.updateDefaultEntityColor(dispatch, parseInt(id), {'color': newDefaultColors[id]}).then(result => {\n        //\n      }).catch(error => {\n        setSaveSucceed(false);\n      });\n    }\n    for (const id in newCustomColors) {\n      AppLogicController.updateCustomEntityDefColor(dispatch, parseInt(id), {'color': newCustomColors[id]}).then(result => {\n        //\n      }).catch(error => {\n        setSaveSucceed(false);\n      });\n    }\n    if(saveSucceed) {\n      closeDrawer();\n      message.success('Colors updated!');\n    } else {\n      closeDrawer();\n      message.error('Something went wrong, sorry :(');\n    }    \n  };\n\n  return (\n    <Drawer\n      title=\"Edit Colors\"\n      width={360}\n      onClose={closeDrawer}\n      visible={visible}\n      bodyStyle={{ paddingBottom: 20 }}\n      footer={\n        <div style={{textAlign: 'right'}} >\n          <Button onClick={closeDrawer} style={{ marginRight: 8 }}>\n            Cancel\n          </Button>\n          <Button type=\"primary\" onClick={updateNewColors}>\n            Update\n          </Button>\n        </div>\n      }\n    >\n      { (defaultEntityColors !== undefined && defaultEntityColors.length > 0) && \n        <List\n          dataSource={defaultEntityColors}\n          renderItem={item => (\n            <List.Item className='default-ent-color-list-item'>\n              <Row style={{width: '100%'}}>\n                <Col span={18} style={{textTransform: 'capitalize'}}>{item.name}</Col>\n                <Col span={6} style={{textAlign: 'right'}}>\n                  <ColorPicker\n                    animation='slide-up'\n                    placement='bottomRight'\n                    enableAlpha={false}\n                    color={item.color}\n                    onChange={(colors) => { setDefaultEntityColor(item.id, colors.color) }}\n                  />\n                </Col>\n              </Row>\n            </List.Item>\n          )}\n        />\n      }\n      { (customEntityDefs !== undefined && customEntityDefs.length > 0) && \n        <>\n          <Divider style={{margin: '0'}} />\n          <List\n            dataSource={customEntityDefs}\n            renderItem={item => (\n              <List.Item className='custom-ent-color-list-item'>\n                <Row style={{width: '100%'}}>\n                  <Col span={18}>{item.name}</Col>\n                  <Col span={6} style={{textAlign: 'right'}}>\n                    <ColorPicker\n                      animation='slide-up'\n                      placement='bottomRight'\n                      enableAlpha={false}\n                      color={item.color}\n                      onChange={(colors) => { setCustomEntityColor(item.id, colors.color) }}\n                    />\n                  </Col>\n                </Row>\n              </List.Item>\n            )}\n          />\n        </>\n      }\n    </Drawer>\n  );\n};\n\nexport default EditColors;\n","import { List, Row, Col, Button, Popconfirm } from 'antd';\nimport '../../styles/components/GameStateListItem.scss';\n\nconst GameStateListItem = ({\n  gameState,\n  onEditGameStateProp = () => {},\n  onRemoveGameStateProp = () => {},\n}) => {\n\n  let defaultValue;\n  if (gameState.type.endsWith('arr')) {\n    defaultValue = '[ ' + gameState.default + ' ]';\n  } else {\n    defaultValue = gameState.default;\n  }\n\n  return (\n    <List.Item className='game-state-list-item'>\n      <Row>\n        <Col span={6}>{gameState.name}</Col>\n        <Col span={6}>{gameState.type}</Col>\n        <Col span={8}>{defaultValue}</Col>\n        <Col span={4} style={{textAlign: 'right'}}>\n          {gameState.edit_mode !== 'none' &&\n            <Button type='link' size='small' onClick={() => { onEditGameStateProp() }}>Edit</Button>\n          }\n          {gameState.removable &&\n            <Popconfirm\n              title={`Are you sure you want to remove this game state prop?`}\n              onConfirm={() => { onRemoveGameStateProp() }}\n              onCancel={() => {}}\n              okText='Yes'\n              cancelText='No'\n              placement='bottomRight'\n            >\n              <Button type='link' size='small'>Remove</Button>\n            </Popconfirm>\n          }\n        </Col>\n      </Row>\n    </List.Item>\n  );\n};\n\nexport default GameStateListItem;\n","import db from '../db/AppDatabase';\n\nclass AppValidationsController {\n  //-- validateEntityNames --//\n  static async validateEntityNames(testNames, dbTable) {\n    let invalidNames = [];\n    return db.transaction('r', dbTable, async () => {\n      for (const name of testNames) {\n        const entity = await dbTable.where({name: name}).first();\n        if(entity === undefined){\n          invalidNames.push(name);\n        }\n      }\n      if(invalidNames.length === 0) {\n        return Promise.resolve();\n      } else {\n        return Promise.reject(invalidNames);\n      }\n    });\n  }\n\n  static async validateCustomEntityNames(testNames, entityDefId) {\n    let invalidNames = [];\n    return db.transaction('r', db.custom_entities, async () => {\n      for (const name of testNames) {\n        const entity = await db.custom_entities.where({name: name, custom_entity_def_id: entityDefId}).first();\n        if(entity === undefined){\n          invalidNames.push(name);\n        }\n      }\n      if(invalidNames.length === 0) {\n        return Promise.resolve();\n      } else {\n        return Promise.reject(invalidNames);\n      }\n    });\n  }\n\n}\n\nexport default AppValidationsController;","import { useState, useEffect, useContext } from 'react';\nimport { Drawer, Form, Button, Col, Row, Input, InputNumber, Select, Switch, message } from 'antd';\nimport { AppContext } from '../../stores/AppStore';\nimport AppLogicController from '../../controllers/AppLogicController';\nimport AppValidationsController from '../../controllers/AppValidationsController';\nimport { useLiveQuery } from 'dexie-react-hooks';\nimport db from '../../db/AppDatabase';\n\nconst { TextArea } = Input;\nconst { Option } = Select;\n\nconst AddEditGameStateProp = ({ gameStateProp = null, isDrawerVisible, onDrawerClose }) => {\n  const [,dispatch] = useContext(AppContext);\n  const [form] = Form.useForm();\n  const [visible, setVisible] = useState(false);\n  const [name, setName] = useState('');\n  const [type, setType] = useState('');\n  const [defaultValueInt, setDefaultValueInt] = useState(0);\n  const [defaultValueBool, setDefaultValueBool] = useState(true);\n  const [defaultValueString, setDefaultValueString] = useState('');\n  const [defaultValueArray, setDefaultValueArray] = useState(true);\n\n  const customEntityDefs = useLiveQuery(() => db.custom_entity_defs.toArray());\n\n  useEffect(() => {\n    const populateDefault = (defaultValue) => {\n      if(!type.endsWith('arr')) { //not array\n        switch(type) {\n          case 'int':\n            form.setFieldsValue({defaultValueInt: defaultValue});\n            break;\n          case 'boolean':\n            form.setFieldsValue({defaultValueBool: defaultValue});\n            setDefaultValueBool(defaultValue);\n            break;\n          case 'string':\n          case 'location':\n          case 'area':\n          case 'character':\n          default: //custom entity\n            form.setFieldsValue({defaultValueString: defaultValue});\n            break;\n        }\n      } else { //array\n        if(defaultValue.length === 0) {\n          return;\n        }\n        const valuesArray = defaultValue.split(',');\n        switch(type) {\n          case 'intarr':\n          case 'booleanarr':\n            form.setFieldsValue({defaultValueArray: valuesArray.join('\\n')});\n            break;\n          case 'stringarr':\n          case 'locationarr':\n          case 'areaarr':\n          case 'characterarr':\n          default: //custom entity array\n            let unquotedEntries = [];\n            for (const entry of valuesArray) {\n              unquotedEntries.push(entry.slice(1, -1));\n            }\n            form.setFieldsValue({defaultValueArray: unquotedEntries.join('\\n')});\n            break;\n        }\n      }\n    };\n\n    if(isDrawerVisible) { //opening drawer\n      form.resetFields();\n      setType('');\n      if (gameStateProp) {\n        form.setFieldsValue({name: gameStateProp.name, type: gameStateProp.type});\n        setType(gameStateProp.type);\n        populateDefault(gameStateProp.default);\n      }\n      openDrawer();\n    }\n  }, [isDrawerVisible, form, gameStateProp]); // eslint-disable-line\n\n  const openDrawer = () => {\n    setVisible(true);\n  };\n\n  const closeDrawer = () => {\n    setVisible(false);\n    onDrawerClose && onDrawerClose();\n  };\n\n  const handleTypeChange = (value) => {\n    if(value === 'int') {\n      form.setFieldsValue({defaultValueInt: ''});\n    }\n    if(value === 'boolean') {\n      form.setFieldsValue({defaultValueBool: defaultValueBool});\n    }\n    if(value.endsWith('arr')){\n      form.setFieldsValue({defaultValueArray: ''});\n    }\n    if(value !== '' && value !== 'int' && value !== 'boolean' && !value.endsWith('arr')){\n      form.setFieldsValue({defaultValueString: ''});\n    }\n    setType(value);\n  };\n\n  const displaySingleLineDefaultField = () => {\n    return type !== '' && type !== 'int' && type !== 'boolean' && !type.endsWith('arr');\n  };\n\n  const displayArrayDefaultField = () => {\n    return type.endsWith('arr');\n  };\n\n  const arrayFieldLabelAndPlaceholder = (label = true) => {\n    switch(type) {\n      case 'intarr':\n        return label ? 'int[]' : 'Place one integer per line';\n      case 'booleanarr':\n        return label ? 'boolean[]' : 'Place one boolean per line';\n      case 'stringarr':\n        return label ? 'string[]' : 'Place one string per line';\n      case 'locationarr':\n        return label ? 'location[]' : 'Place one location per line';\n      case 'areaarr':\n        return label ? 'area[]' : 'Place one area per line';\n      case 'characterarr':\n        return label ? 'character[]' : 'Place one character per line';\n      default:\n        if(type.endsWith('arr')) {\n          const singular_name = type.slice(0, -3);\n          return label ? singular_name+'[]' : 'Place one '+singular_name+' per line';\n        } else {\n          return label ? '[]' : 'Place one item per line';\n        }\n    }\n  };\n\n  const onFinish = (values) => {\n    const name = values.name.trim();\n    if(name === ''){\n      message.error('Do not leave name empty');\n      return;\n    }\n    //validate type & default value\n    switch(type) {\n      case 'int':\n        if(!Number.isInteger(parseInt(values.defaultValueInt))){\n          message.error('Default is not an integer');\n        } else {\n          saveGameStateProp(values);\n        }\n        break;\n      case 'boolean':\n      case 'string':\n        saveGameStateProp(values);\n        break;\n      case 'location':\n        const defaultLocation = values.defaultValueString.trim();\n        AppValidationsController.validateEntityNames([defaultLocation], db.locations).then(() => {\n          saveGameStateProp(values);\n        }).catch(invalidLocations => {\n          message.error('Invalid values: ' + invalidLocations.join(', '));\n        });\n        break;\n      case 'area':\n        const defaultArea = values.defaultValueString.trim();\n        AppValidationsController.validateEntityNames([defaultArea], db.areas).then(() => {\n          saveGameStateProp(values);\n        }).catch(invalidAreas => {\n          message.error('Invalid values: ' + invalidAreas.join(', '));\n        });\n        break;\n      case 'character':\n        const defaultCharacter = values.defaultValueString.trim();\n        AppValidationsController.validateEntityNames([defaultCharacter], db.characters).then(() => {\n          saveGameStateProp(values);\n        }).catch(invalidCharacters => {\n          message.error('Invalid values: ' + invalidCharacters.join(', '));\n        });\n        break;\n      default:\n        if(!type.endsWith('arr')) { \n          if(type !== 'boolean' && type !== 'string') { //custom entity\n            const customEntityDef = customEntityDefs.find(customEntityDef => customEntityDef.singular_name === type);\n            if (customEntityDef) {\n              const defaultEntity = values.defaultValueString.trim();\n              AppValidationsController.validateCustomEntityNames([defaultEntity], customEntityDef.id).then(() => {\n                saveGameStateProp(values);\n              }).catch(invalidEntities => {\n                message.error('Invalid values: ' + invalidEntities.join(', '));\n              });\n            }\n          }\n        } else { //any array type\n          valudateArrayTypes(values)\n        }\n        break;\n    }\n  };\n\n  const valudateArrayTypes = (values) => {\n    const defaultValues = values.defaultValueArray;\n    if(defaultValues.length === 0) {\n      saveGameStateProp(values);\n    } else {\n      const valuesArray = defaultValues.split('\\n');\n      switch(type) {\n        case 'intarr':\n          for (const integerValue of valuesArray) {\n            if(!Number.isInteger(parseInt(integerValue))){\n              message.error('All values in array must be integers');\n              return;\n            }\n          }\n          saveGameStateProp(values);\n          break;\n        case 'booleanarr':\n          for (const booleanValue of valuesArray) {\n            if(!(booleanValue === 'true' || booleanValue === 'false')){\n              message.error('All values in array must be \"true\" or \"false\"');\n              return;\n            }\n          }\n          saveGameStateProp(values);\n          break;\n        case 'stringarr':\n          for (const stringValue of valuesArray) {\n            if(stringValue.trim() === ''){\n              message.error('Do not leave empty strings (just spaces are considered empty)');\n              return;\n            }\n          }\n          saveGameStateProp(values);\n          break;\n        case 'locationarr':\n          AppValidationsController.validateEntityNames(valuesArray, db.locations).then(() => {\n            saveGameStateProp(values);\n          }).catch(invalidLocations => {\n            message.error('Invalid values: ' + invalidLocations.join(', '));\n          });\n          break;\n        case 'areaarr':\n          AppValidationsController.validateEntityNames(valuesArray, db.areas).then(() => {\n            saveGameStateProp(values);\n          }).catch(invalidAreas => {\n            message.error('Invalid values: ' + invalidAreas.join(', '));\n          });\n          break;\n        case 'characterarr':\n          AppValidationsController.validateEntityNames(valuesArray, db.characters).then(() => {\n            saveGameStateProp(values);\n          }).catch(invalidCharacters => {\n            message.error('Invalid values: ' + invalidCharacters.join(', '));\n          });\n          break;\n        default: //custom entities\n          const singular_name = type.slice(0, -3);\n          const customEntityDef = customEntityDefs.find(customEntityDef => customEntityDef.singular_name === singular_name);\n          if (customEntityDef) {\n            AppValidationsController.validateCustomEntityNames(valuesArray, customEntityDef.id).then(() => {\n              saveGameStateProp(values);\n            }).catch(invalidEntities => {\n              message.error('Invalid values: ' + invalidEntities.join(', '));\n            });\n          }\n          break;\n      }\n    }\n  };\n\n  const saveGameStateProp = (values) => {\n    if (gameStateProp === null) { //new gameStateProp\n      const name = values.name.trim();\n      const defaultValue = getDefaultValue(values);\n      const editMode = 'name|default';\n      const removable = true;\n      const newData = {name, type, defaultValue, editMode, removable};\n      AppLogicController.createNewGameStateProp(dispatch, newData).then(result => {\n        closeDrawer();\n        message.success('New game state prop created!');\n      }).catch(error => {\n        closeDrawer();\n        message.error('Something went wrong, sorry :(');\n      });\n    } else { //editing gameStateProp\n      const name = values.name.trim();\n      const defaultValue = getDefaultValue(values);\n      const editMode = gameStateProp.edit_mode;\n      const removable = gameStateProp.removable;\n      const editData = {name, type, defaultValue, editMode, removable};\n      AppLogicController.updateGameStateProp(dispatch, gameStateProp.id, editData).then(result => {\n        closeDrawer();\n        message.success('Game state prop edited!');\n      }).catch(error => {\n        closeDrawer();\n        message.error('Something went wrong, sorry :(');\n      });\n    }\n  };\n\n  const getDefaultValue = (values) => {\n    if(!type.endsWith('arr')) { //not array\n      switch(type) {\n        case 'int':\n          return parseInt(values.defaultValueInt);\n        case 'boolean':\n          return values.defaultValueBool;\n        case 'string':\n        case 'location':\n        case 'area':\n        case 'character':\n        default: //custom entity\n          return values.defaultValueString;\n      }\n    } else { //array\n      const defaultValues = values.defaultValueArray;\n      if(defaultValues.length === 0) {\n        return '';\n      }\n      const valuesArray = defaultValues.split('\\n');\n      switch(type) {\n        case 'intarr':\n        case 'booleanarr':\n          return valuesArray.join(',');\n        case 'stringarr':\n        case 'locationarr':\n        case 'areaarr':\n        case 'characterarr':\n        default: //custom entity array\n          let quotesWrappedEntries = [];\n          for (const entry of valuesArray) {\n            quotesWrappedEntries.push('\"' + entry + '\"');\n          }\n          return quotesWrappedEntries.join(',');\n      }\n    }\n  };\n\n  const isNameDisabled = () => {\n    if(gameStateProp === null) {\n      return false;\n    } else {\n      const editMode = gameStateProp.edit_mode.split('|');\n      return editMode.indexOf('all') < 0 && editMode.indexOf('name') < 0;\n    } \n  };\n\n  const isTypeDisabled = () => {\n    if(gameStateProp === null) {\n      return false;\n    } else {\n      const editMode = gameStateProp.edit_mode.split('|');\n      return editMode.indexOf('all') < 0 && editMode.indexOf('type') < 0;\n    } \n  };\n\n  const isDefaultDisabled = () => {\n    if(gameStateProp === null) {\n      return false;\n    } else {\n      const editMode = gameStateProp.edit_mode.split('|');\n      return editMode.indexOf('all') < 0 && editMode.indexOf('default') < 0;\n    } \n  };\n\n  return (\n    <Drawer\n      title={(gameStateProp === null) ? 'New prop' : 'Edit prop'}\n      width={360}\n      onClose={closeDrawer}\n      visible={visible}\n      bodyStyle={{ paddingBottom: 20 }}\n      footer={\n        <div style={{textAlign: 'right'}} >\n          <Button onClick={closeDrawer} style={{ marginRight: 8 }}>\n            Cancel\n          </Button>\n          <Button type=\"primary\" htmlType=\"submit\" form='add-edit-game-state-prop-id'>\n            {(gameStateProp === null) ? 'Create' : 'Update'}\n          </Button>\n        </div>\n      }\n    >\n      <Form layout='vertical' name='add-edit-game-state-prop' id='add-edit-game-state-prop-id' form={form} onFinish={onFinish} requiredMark={false}>\n        <Row gutter={16}>\n          <Col span={24}>\n            <Form.Item\n              name=\"name\"\n              label=\"Name\"\n              rules={[{ required: true, message: 'Please enter a name' }]}\n            >\n              <Input placeholder=\"Please enter a name\" value={name} onChange={(e) => { setName(e.target.value) }} disabled={isNameDisabled()} />\n            </Form.Item>\n          </Col>\n        </Row>\n        <Row gutter={16}>\n          <Col span={24}>\n            <Form.Item\n              name=\"type\"\n              label=\"Type\"\n              rules={[{ required: true, message: 'Please select a type' }]}\n            >\n              <Select value={type} onChange={(e) => { handleTypeChange(e) }} disabled={isTypeDisabled()}>\n                <Option value='int'>int</Option>\n                <Option value='intarr'>int[]</Option>\n                <Option value='boolean'>boolean</Option>\n                <Option value='booleanarr'>boolean[]</Option>\n                <Option value='string'>string</Option>\n                <Option value='stringarr'>string[]</Option>\n                <Option value='location'>location</Option>\n                <Option value='locationarr'>location[]</Option>\n                <Option value='area'>area</Option>\n                <Option value='areaarr'>area[]</Option>\n                <Option value='character'>character</Option>\n                <Option value='characterarr'>character[]</Option>\n                { customEntityDefs !== undefined && customEntityDefs.map((customEntityDef) =>\n                  <>\n                    <Option value={customEntityDef.singular_name}>{customEntityDef.singular_name}</Option>\n                    <Option value={customEntityDef.singular_name + 'arr'}>{customEntityDef.singular_name}[]</Option>\n                  </>\n                  )\n                }\n              </Select>\n            </Form.Item>\n          </Col>\n        </Row>\n        <Row gutter={16} style={{display: (type === 'int' ? 'block' : 'none')}}>\n          <Col span={24}>\n            <Form.Item\n              name=\"defaultValueInt\"\n              label=\"Default value (int)\"\n              rules={[{ required: (type === 'int'), message: 'Please enter an integer' }]}\n            >\n              <InputNumber disabled={isDefaultDisabled()} placeholder=\"Please enter an integer\" value={defaultValueInt} onChange={(e) => { setDefaultValueInt(e) }} style={{width: '100%'}} />\n            </Form.Item>\n          </Col>\n        </Row>\n        <Row gutter={16} style={{display: (type === 'boolean' ? 'block' : 'none')}}>\n          <Col span={24}>\n            <Form.Item\n              name=\"defaultValueBool\"\n              label=\"Default value (boolean)\"\n            >\n              <Switch disabled={isDefaultDisabled()} checkedChildren=\"true\" unCheckedChildren=\"false\" checked={defaultValueBool} defaultChecked onChange={(e) => { setDefaultValueBool(e) }} />\n            </Form.Item>\n          </Col>\n        </Row>\n        <Row gutter={16} style={{display: (displaySingleLineDefaultField() ? 'block' : 'none')}}>\n          <Col span={24}>\n            <Form.Item\n              name=\"defaultValueString\"\n              label=\"Default value (string)\"\n              rules={[{ required: displaySingleLineDefaultField() && type !== 'string', message: 'Please enter a default value' }]}\n            >\n              <Input disabled={isDefaultDisabled()} placeholder=\"Please enter a default value\" value={defaultValueString} onChange={(e) => { setDefaultValueString(e.target.value) }} />\n            </Form.Item>\n          </Col>\n        </Row>\n        <Row gutter={16} style={{display: (displayArrayDefaultField() ? 'block' : 'none')}}>\n          <Col span={24}>\n            <Form.Item\n              name=\"defaultValueArray\"\n              label={'Default value (' + arrayFieldLabelAndPlaceholder() + ')'}\n            >\n              <TextArea disabled={isDefaultDisabled()} rows={10} placeholder={arrayFieldLabelAndPlaceholder(false) + ' Leave empty for empty array.'} value={defaultValueArray} onChange={(e) => { setDefaultValueArray(e.target.value) }} />\n            </Form.Item>\n          </Col>\n        </Row>\n      </Form>\n    </Drawer>\n  );\n};\n\nexport default AddEditGameStateProp;\n","import { useState, useContext } from 'react';\nimport { AppContext } from '../../stores/AppStore';\nimport AppLogicController from '../../controllers/AppLogicController';\nimport { useLiveQuery } from 'dexie-react-hooks';\nimport db from '../../db/AppDatabase';\nimport GameStateListItem from '../entity_views/GameStateListItem';\nimport { List, Row, Col, Typography, Button, message } from 'antd';\nimport AddEditGameStateProp from '../drawers/AddEditGameStateProp';\n\nconst { Text } = Typography;\n\nconst GameStateConfigSection = () => {\n  const [,dispatch] = useContext(AppContext);\n  const [addEditGameStatePropVisible, setAddEditGameStatePropVisible] = useState(false);\n  const [currentGameStateProp, setCurrentGameStateProp] = useState(null);\n\n  const gameStates = useLiveQuery(() => db.game_state_props.toArray());\n\n  const addGameStateProp = () => {\n    setCurrentGameStateProp(null);\n    setAddEditGameStatePropVisible(true);\n  };\n\n  const editGameStateProp = (gameStateProp) => {\n    setCurrentGameStateProp(gameStateProp);\n    setAddEditGameStatePropVisible(true);\n  };\n\n  const removeGameStateProp = (gameStateProp) => {\n    AppLogicController.deleteGameStateProp(dispatch, gameStateProp.id).then(result => {\n      message.success('Game state prop removed!');\n    }).catch(error => {\n      message.error('Something went wrong, sorry :(');\n    });\n  };\n\n  const header = (\n    <Row>\n      <Col span={6}><Text strong>Name</Text></Col>\n      <Col span={6}><Text strong>Type</Text></Col>\n      <Col span={8}><Text strong>Default</Text></Col>\n      <Col span={4}></Col>\n    </Row>\n  );\n\n  return (\n    <div>\n      { (gameStates !== undefined && gameStates.length > 0) && \n        <List\n          style={{marginBottom: '20px', maxWidth: '94%'}}\n          header={header}\n          dataSource={gameStates}\n          renderItem={item => (\n            <GameStateListItem\n              gameState={item}\n              onEditGameStateProp={() => { editGameStateProp(item); }} \n              onRemoveGameStateProp={() => { removeGameStateProp(item); }} \n            />\n          )}\n        />\n      }\n      <Button type='primary' onClick={addGameStateProp}>\n        Add Game State Prop\n      </Button>\n      <AddEditGameStateProp\n        gameStateProp={currentGameStateProp}\n        isDrawerVisible={addEditGameStatePropVisible} \n        onDrawerClose={() => { setAddEditGameStatePropVisible(false); }} \n      />\n    </div>\n  );\n};\n\nexport default GameStateConfigSection;","import { Card, Divider, Typography, Button, List, Row, Col, Popconfirm } from 'antd';\nimport { useLiveQuery } from 'dexie-react-hooks';\nimport db from '../../db/AppDatabase';\nimport '../../styles/components/LocationView.scss';\n\nconst { Text } = Typography;\n\nconst LocationView = ({ \n  location,  \n  canEdit = true, \n  canRemove = true,\n  onRemove = () => {},\n  onEdit = () => {},\n  //\n  onAddArea = () => {},\n  onEditArea = () => {},\n  onRemoveArea = () => {},\n}) => {\n\n  const areas = useLiveQuery(() => db.areas.where('location_id').equals(location.id).toArray());\n\n  const options = [];\n  if(canEdit) {\n    options.push(<Button key='edit-location' type='link' size='small' onClick={onEdit}>Edit</Button>);\n  }\n  if(canRemove) {\n    options.push(\n      <Popconfirm\n        key='remove-location'\n        title={`Are you sure you want to remove this location and all its areas?`}\n        onConfirm={onRemove}\n        onCancel={() => {}}\n        okText='Yes'\n        cancelText='No'\n        placement='bottomRight'\n      >\n        <Button type='link' size='small'>Remove</Button>\n      </Popconfirm>\n    );\n  }\n\n  const header = (\n    <Row>\n      <Col span={6}><Text strong>Area Name</Text></Col>\n      <Col span={12}><Text strong>Description</Text></Col>\n      <Col span={6}></Col>\n    </Row>\n  );\n\n  return (\n    <Card className='location-view' size='small' title={location.name} extra={options} headStyle={{ background: '#f5f5f5'}} >\n      <Text>{location.description}</Text>\n      <Divider />\n      { (areas !== undefined && areas.length > 0) && \n        <List\n          header={header}\n          dataSource={areas}\n          renderItem={area => (\n            <List.Item className='area-list-item'>\n              <Row>\n                <Col span={6}>{area.name}</Col>\n                <Col span={12}>{area.description}</Col>\n                <Col span={6} style={{textAlign: 'right'}}>\n                  <Button type='link' size='small' onClick={() => { onEditArea(area) }}>Edit</Button>\n                  <Popconfirm\n                    title={`Are you sure you want to remove this area?`}\n                    onConfirm={() => { onRemoveArea(area) }}\n                    onCancel={() => {}}\n                    okText='Yes'\n                    cancelText='No'\n                    placement='bottomRight'\n                  >\n                    <Button type='link' size='small'>Remove</Button>\n                  </Popconfirm>\n                </Col>\n              </Row>\n            </List.Item>\n          )}\n        />\n      }\n      <Button type='default' size='small' onClick={onAddArea}>\n        Add Area\n      </Button>\n    </Card>\n  );\n};\n\nexport default LocationView;\n","import { useState, useEffect, useContext } from 'react';\nimport { Drawer, Form, Button, Col, Row, Input, message } from 'antd';\nimport { AppContext } from '../../stores/AppStore';\nimport AppLogicController from '../../controllers/AppLogicController';\n\nconst { TextArea } = Input;\n\nconst AddEditLocation = ({ location = null, isDrawerVisible, onDrawerClose }) => {\n  const [,dispatch] = useContext(AppContext);\n  const [form] = Form.useForm();\n  const [visible, setVisible] = useState(false);\n  const [name, setName] = useState('');\n  const [description, setDescription] = useState('');\n\n  useEffect(() => {\n    if(isDrawerVisible) { //opening drawer\n      form.resetFields();\n      if (location) {\n        form.setFieldsValue({name: location.name, description: location.description});\n      }\n      openDrawer();\n    }\n  }, [isDrawerVisible, form, location]);\n\n  const openDrawer = () => {\n    setVisible(true);\n  };\n\n  const closeDrawer = () => {\n    setVisible(false);\n    onDrawerClose && onDrawerClose();\n  };\n\n  const onFinish = (values) => {\n    const name = values.name.trim();\n    const description = values.description.trim();\n    if(name === '' || description === ''){\n      closeDrawer();\n      message.error('Do not leave empty fields, sorry :(');\n      return;\n    }\n    const data = {name, description};\n    if (location === null) { //new location\n      AppLogicController.createNewLocation(dispatch, data).then(result => {\n        closeDrawer();\n        message.success('New location created!');\n      }).catch(error => {\n        closeDrawer();\n        message.error('Something went wrong, sorry :(');\n      });\n    } else { //editing location\n      AppLogicController.updateLocation(dispatch, location.id, data).then(result => {\n        closeDrawer();\n        message.success('Location edited!');\n      }).catch(error => {\n        closeDrawer();\n        message.error('Something went wrong, sorry :(');\n      });\n    }\n  };\n\n  return (\n    <Drawer\n      title={(location === null) ? 'New location' : 'Edit location'}\n      width={360}\n      onClose={closeDrawer}\n      visible={visible}\n      bodyStyle={{ paddingBottom: 20 }}\n      footer={\n        <div style={{textAlign: 'right'}} >\n          <Button onClick={closeDrawer} style={{ marginRight: 8 }}>\n            Cancel\n          </Button>\n          <Button type=\"primary\" htmlType=\"submit\" form='add-edit-location-id'>\n            {(location === null) ? 'Create' : 'Update'}\n          </Button>\n        </div>\n      }\n    >\n      <Form layout='vertical' name='add-edit-location' id='add-edit-location-id' form={form} onFinish={onFinish} requiredMark={false}>\n        <Row gutter={16}>\n          <Col span={24}>\n            <Form.Item\n              name=\"name\"\n              label=\"Name\"\n              rules={[{ required: true, message: 'Please enter a name' }]}\n            >\n              <Input placeholder=\"Please enter a name\" value={name} onChange={(e) => { setName(e.target.value) }} />\n            </Form.Item>\n          </Col>\n        </Row>\n        <Row gutter={16}>\n          <Col span={24}>\n            <Form.Item\n              name=\"description\"\n              label=\"Description\"\n              rules={[{ required: true, message: 'Please enter a description' }]}\n            >\n              <TextArea rows={10} placeholder=\"Please enter a description\" value={description} onChange={(e) => { setDescription(e.target.value) }} />\n            </Form.Item>\n          </Col>\n        </Row>\n      </Form>\n    </Drawer>\n  );\n};\n\nexport default AddEditLocation;\n","import { useState, useEffect, useContext } from 'react';\nimport { Drawer, Form, Button, Col, Row, Input, message } from 'antd';\nimport { AppContext } from '../../stores/AppStore';\nimport AppLogicController from '../../controllers/AppLogicController';\n\nconst { TextArea } = Input;\n\nconst AddEditArea = ({ area = null, location, isDrawerVisible, onDrawerClose }) => {\n  const [,dispatch] = useContext(AppContext);\n  const [form] = Form.useForm();\n  const [visible, setVisible] = useState(false);\n  const [name, setName] = useState('');\n  const [description, setDescription] = useState('');\n\n  useEffect(() => {\n    if(isDrawerVisible) { //opening drawer\n      form.resetFields();\n      if (area) {\n        form.setFieldsValue({name: area.name, description: area.description});\n      }\n      openDrawer();\n    }\n  }, [isDrawerVisible, form, area]);\n\n  const openDrawer = () => {\n    setVisible(true);\n  };\n\n  const closeDrawer = () => {\n    setVisible(false);\n    onDrawerClose && onDrawerClose();\n  };\n\n  const onFinish = (values) => {\n    const name = values.name.trim();\n    const description = values.description.trim();\n    if(name === '' || description === ''){\n      closeDrawer();\n      message.error('Do not leave empty fields, sorry :(');\n      return;\n    }\n    let data = {name, description};\n    if (area === null) { //new area\n      data.location_id = location.id;\n      AppLogicController.createNewArea(dispatch, data).then(result => {\n        closeDrawer();\n        message.success('New area created!');\n      }).catch(error => {\n        closeDrawer();\n        message.error('Something went wrong, sorry :(');\n      });\n    } else { //editing area\n      AppLogicController.updateArea(dispatch, area.id, data).then(result => {\n        closeDrawer();\n        message.success('Area edited!');\n      }).catch(error => {\n        closeDrawer();\n        message.error('Something went wrong, sorry :(');\n      });\n    }\n  };\n\n  return (\n    <Drawer\n      title={((area === null) ? 'New area' : 'Edit area') + ' in ' + (location && location.name)}\n      width={360}\n      onClose={closeDrawer}\n      visible={visible}\n      bodyStyle={{ paddingBottom: 20 }}\n      footer={\n        <div style={{textAlign: 'right'}} >\n          <Button onClick={closeDrawer} style={{ marginRight: 8 }}>\n            Cancel\n          </Button>\n          <Button type=\"primary\" htmlType=\"submit\" form='add-edit-area-id'>\n            {(area === null) ? 'Create' : 'Update'}\n          </Button>\n        </div>\n      }\n    >\n      <Form layout='vertical' name='add-edit-area' id='add-edit-area-id' form={form} onFinish={onFinish} requiredMark={false}>\n        <Row gutter={16}>\n          <Col span={24}>\n            <Form.Item\n              name=\"name\"\n              label=\"Name\"\n              rules={[{ required: true, message: 'Please enter a name' }]}\n            >\n              <Input placeholder=\"Please enter a name\" value={name} onChange={(e) => { setName(e.target.value) }} />\n            </Form.Item>\n          </Col>\n        </Row>\n        <Row gutter={16}>\n          <Col span={24}>\n            <Form.Item\n              name=\"description\"\n              label=\"Description\"\n              rules={[{ required: true, message: 'Please enter a description' }]}\n            >\n              <TextArea rows={10} placeholder=\"Please enter a description\" value={description} onChange={(e) => { setDescription(e.target.value) }} />\n            </Form.Item>\n          </Col>\n        </Row>\n      </Form>\n    </Drawer>\n  );\n};\n\nexport default AddEditArea;\n","import { useState, useContext } from 'react';\nimport { AppContext } from '../../stores/AppStore';\nimport AppLogicController from '../../controllers/AppLogicController';\nimport { Button, message } from 'antd';\nimport { useLiveQuery } from 'dexie-react-hooks';\nimport db from '../../db/AppDatabase';\nimport LocationView from '../entity_views/LocationView';\nimport AddEditLocation from '../drawers/AddEditLocation';\nimport AddEditArea from '../drawers/AddEditArea';\n\nconst LocationConfigSection = () => {\n  const [,dispatch] = useContext(AppContext);\n  const [addEditLocationVisible, setAddEditLocationVisible] = useState(false);\n  const [addEditAreaVisible, setAddEditAreaVisible] = useState(false);\n  const [currentLocation, setCurrentLocation] = useState(null);\n  const [currentArea, setCurrentArea] = useState(null);\n\n  const locations = useLiveQuery(() => db.locations.toArray());\n\n  //location handlers\n  const addLocation = () => {\n    setCurrentLocation(null);\n    setAddEditLocationVisible(true);\n  };\n\n  const editLocation = (location) => {\n    setCurrentLocation(location);\n    setAddEditLocationVisible(true);\n  };\n\n  const removeLocation = (location) => {\n    AppLogicController.deleteLocation(dispatch, location.id).then(result => {\n      message.success('Location removed!');\n    }).catch(error => {\n      message.error('Something went wrong, sorry :(');\n    });\n  };\n\n  //area handlers\n  const addArea = (location) => {\n    setCurrentArea(null);\n    setCurrentLocation(location);\n    setAddEditAreaVisible(true);\n  };\n\n  const editArea = (area, location) => {\n    setCurrentLocation(location);\n    setCurrentArea(area);\n    setAddEditAreaVisible(true);\n  };\n\n  const removeArea = (area) => {\n    AppLogicController.deleteArea(dispatch, area.id).then(result => {\n      message.success('Area removed!');\n    }).catch(error => {\n      message.error('Something went wrong, sorry :(');\n    });\n  };\n\n  return (\n    <div>\n      { locations !== undefined && locations.map(location =>\n        <LocationView \n          key={location.id} \n          location={location} \n          onRemove={() => { removeLocation(location) }} \n          onEdit={() => { editLocation(location) }} \n          onAddArea={() => { addArea(location) }} \n          onEditArea={(area) => { editArea(area, location) }}\n          onRemoveArea={(area) => { removeArea(area) }}\n        />\n        )\n      }\n      <Button type='primary' onClick={addLocation}>\n        Add Location\n      </Button>\n      <AddEditLocation\n        location={currentLocation}\n        isDrawerVisible={addEditLocationVisible} \n        onDrawerClose={() => { setAddEditLocationVisible(false); }} \n      />\n      <AddEditArea\n        area={currentArea}\n        location={currentLocation}\n        isDrawerVisible={addEditAreaVisible} \n        onDrawerClose={() => { setAddEditAreaVisible(false); }} \n      />\n    </div>\n  );\n};\n\nexport default LocationConfigSection;\n","import { Card, Typography, Button, Popconfirm } from 'antd';\nimport '../../styles/components/SimpleEntityView.scss';\n\nconst { Text } = Typography;\n\nconst SimpleEntityView = ({ \n  entity, \n  entityName = 'entity', \n  canEdit = true, \n  canRemove = true,\n  onRemove = () => {},\n  onEdit = () => {},\n}) => {\n\n  const options = [];\n  if(canEdit) {\n    options.push(<Button key='edit-entity' type='link' size='small' onClick={onEdit}>Edit</Button>);\n  }\n  if(canRemove) {\n    options.push(\n      <Popconfirm\n        key='remove-entity'\n        title={`Are you sure you want to remove this ${entityName}?`}\n        onConfirm={onRemove}\n        onCancel={() => {}}\n        okText='Yes'\n        cancelText='No'\n        placement='bottomRight'\n      >\n        <Button type='link' size='small'>Remove</Button>\n      </Popconfirm>\n    );\n  }\n\n  return (\n    <Card className='simple-entity-view' size='small' title={entity.name} extra={options} headStyle={{ background: '#f5f5f5'}} >\n      <Text>{entity.description}</Text>\n    </Card>\n  );\n};\n\nexport default SimpleEntityView;\n","import { useState, useEffect, useContext } from 'react';\nimport { Drawer, Form, Button, Col, Row, Input, message } from 'antd';\nimport { AppContext } from '../../stores/AppStore';\nimport AppLogicController from '../../controllers/AppLogicController';\n\nconst { TextArea } = Input;\n\nconst AddEditCharacter = ({ character = null, isDrawerVisible, onDrawerClose }) => {\n  const [,dispatch] = useContext(AppContext);\n  const [form] = Form.useForm();\n  const [visible, setVisible] = useState(false);\n  const [name, setName] = useState('');\n  const [description, setDescription] = useState('');\n\n  useEffect(() => {\n    if(isDrawerVisible) { //opening drawer\n      form.resetFields();\n      if (character) {\n        form.setFieldsValue({name: character.name, description: character.description});\n      }\n      openDrawer();\n    }\n  }, [isDrawerVisible, form, character]);\n\n  const openDrawer = () => {\n    setVisible(true);\n  };\n\n  const closeDrawer = () => {\n    setVisible(false);\n    onDrawerClose && onDrawerClose();\n  };\n\n  const onFinish = (values) => {\n    const name = values.name.trim();\n    const description = values.description.trim();\n    if(name === '' || description === ''){\n      closeDrawer();\n      message.error('Do not leave empty fields, sorry :(');\n      return;\n    }\n    const data = {name, description};\n    if (character === null) { //new character\n      AppLogicController.createNewCharacter(dispatch, data).then(result => {\n        closeDrawer();\n        message.success('New character created!');\n      }).catch(error => {\n        closeDrawer();\n        message.error('Something went wrong, sorry :(');\n      });\n    } else { //editing character\n      AppLogicController.updateCharacter(dispatch, character.id, data).then(result => {\n        closeDrawer();\n        message.success('Character edited!');\n      }).catch(error => {\n        closeDrawer();\n        message.error('Something went wrong, sorry :(');\n      });\n    }\n  };\n\n  return (\n    <Drawer\n      title={(character === null) ? 'New character' : 'Edit character'}\n      width={360}\n      onClose={closeDrawer}\n      visible={visible}\n      bodyStyle={{ paddingBottom: 20 }}\n      footer={\n        <div style={{textAlign: 'right'}} >\n          <Button onClick={closeDrawer} style={{ marginRight: 8 }}>\n            Cancel\n          </Button>\n          <Button type=\"primary\" htmlType=\"submit\" form='add-edit-character-id'>\n            {(character === null) ? 'Create' : 'Update'}\n          </Button>\n        </div>\n      }\n    >\n      <Form layout='vertical' name='add-edit-character' id='add-edit-character-id' form={form} onFinish={onFinish} requiredMark={false}>\n        <Row gutter={16}>\n          <Col span={24}>\n            <Form.Item\n              name=\"name\"\n              label=\"Name\"\n              rules={[{ required: true, message: 'Please enter a name' }]}\n            >\n              <Input placeholder=\"Please enter a name\" value={name} onChange={(e) => { setName(e.target.value) }} />\n            </Form.Item>\n          </Col>\n        </Row>\n        <Row gutter={16}>\n          <Col span={24}>\n            <Form.Item\n              name=\"description\"\n              label=\"Description\"\n              rules={[{ required: true, message: 'Please enter a description' }]}\n            >\n              <TextArea rows={10} placeholder=\"Please enter a description\" value={description} onChange={(e) => { setDescription(e.target.value) }} />\n            </Form.Item>\n          </Col>\n        </Row>\n      </Form>\n    </Drawer>\n  );\n};\n\nexport default AddEditCharacter;\n","import { useState, useContext } from 'react';\nimport { AppContext } from '../../stores/AppStore';\nimport AppLogicController from '../../controllers/AppLogicController';\nimport { Button, message } from 'antd';\nimport { useLiveQuery } from 'dexie-react-hooks';\nimport db from '../../db/AppDatabase';\nimport SimpleEntityView from '../entity_views/SimpleEntityView';\nimport AddEditCharacter from '../drawers/AddEditCharacter';\n\nconst CharacterConfigSection = () => {\n  const [,dispatch] = useContext(AppContext);\n  const [addEditCharacterVisible, setAddEditCharacterVisible] = useState(false);\n  const [currentCharacter, setCurrentCharacter] = useState(null);\n\n  const characters = useLiveQuery(() => db.characters.toArray());\n\n  const addCharacter = () => {\n    setCurrentCharacter(null);\n    setAddEditCharacterVisible(true);\n  };\n\n  const editCharacter = (character) => {\n    setCurrentCharacter(character);\n    setAddEditCharacterVisible(true);\n  };\n\n  const removeCharacter = (character) => {\n    AppLogicController.deleteCharacter(dispatch, character.id).then(result => {\n      message.success('Character removed!');\n    }).catch(error => {\n      message.error('Something went wrong, sorry :(');\n    });\n  };\n\n  return (\n    <div>\n      { characters !== undefined && characters.map(character =>\n        <SimpleEntityView \n          key={character.id} \n          entity={character} \n          entityName='character' \n          onRemove={() => { removeCharacter(character) }} \n          onEdit={() => { editCharacter(character) }} \n        />\n        )\n      }\n      <Button type='primary' onClick={addCharacter}>\n        Add Character\n      </Button>\n      <AddEditCharacter\n        character={currentCharacter}\n        isDrawerVisible={addEditCharacterVisible} \n        onDrawerClose={() => { setAddEditCharacterVisible(false); }} \n      />\n    </div>\n  );\n};\n\nexport default CharacterConfigSection;\n","import { useState, useEffect, useContext } from 'react';\nimport { Drawer, Form, Button, Col, Row, Input, message } from 'antd';\nimport { AppContext } from '../../stores/AppStore';\nimport AppLogicController from '../../controllers/AppLogicController';\n\nconst { TextArea } = Input;\n\nconst AddEditCustomEntity = ({ entity = null, entityDef, isDrawerVisible, onDrawerClose }) => {\n  const [,dispatch] = useContext(AppContext);\n  const [form] = Form.useForm();\n  const [visible, setVisible] = useState(false);\n  const [name, setName] = useState('');\n  const [description, setDescription] = useState('');\n  const singularCapitalized = entityDef.singular_name.toLowerCase().charAt(0).toUpperCase() + entityDef.singular_name.toLowerCase().slice(1);\n\n  useEffect(() => {\n    if(isDrawerVisible) { //opening drawer\n      form.resetFields();\n      if (entity) {\n        form.setFieldsValue({name: entity.name, description: entity.description});\n      }\n      openDrawer();\n    }\n  }, [isDrawerVisible, form, entity]);\n\n  const openDrawer = () => {\n    setVisible(true);\n  };\n\n  const closeDrawer = () => {\n    setVisible(false);\n    onDrawerClose && onDrawerClose();\n  };\n\n  const onFinish = (values) => {\n    const name = values.name.trim();\n    const description = values.description.trim();\n    if(name === '' || description === ''){\n      closeDrawer();\n      message.error('Do not leave empty fields, sorry :(');\n      return;\n    }\n    let data = {name, description};\n    if (entity === null) { //new entity\n      data.custom_entity_def_id = entityDef.id;\n      AppLogicController.createNewCustomEntity(dispatch, data).then(result => {\n        closeDrawer();\n        message.success('New ' + entityDef.singular_name.toLowerCase() + ' created!');\n      }).catch(error => {\n        closeDrawer();\n        message.error('Something went wrong, sorry :(');\n      });\n    } else { //editing entity\n      AppLogicController.updateCustomEntity(dispatch, entity.id, data).then(result => {\n        closeDrawer();\n        message.success(singularCapitalized + ' edited!');\n      }).catch(error => {\n        closeDrawer();\n        message.error('Something went wrong, sorry :(');\n      });\n    }\n  };\n\n  return (\n    <Drawer\n      title={((entity === null) ? 'New' : 'Edit') + ' ' + entityDef.singular_name.toLowerCase()}\n      width={360}\n      onClose={closeDrawer}\n      visible={visible}\n      bodyStyle={{ paddingBottom: 20 }}\n      footer={\n        <div style={{textAlign: 'right'}} >\n          <Button onClick={closeDrawer} style={{ marginRight: 8 }}>\n            Cancel\n          </Button>\n          <Button type=\"primary\" htmlType=\"submit\" form={'add-edit-custom-entity-id-' + entityDef.key}>\n            {(entity === null) ? 'Create' : 'Update'}\n          </Button>\n        </div>\n      }\n    >\n      <Form layout='vertical' name={'add-edit-custom-entity-' + entityDef.key} id={'add-edit-custom-entity-id-' + entityDef.key} form={form} onFinish={(values) => { onFinish(values) }} requiredMark={false}>\n        <Row gutter={16}>\n          <Col span={24}>\n            <Form.Item\n              name=\"name\"\n              label=\"Name\"\n              rules={[{ required: true, message: 'Please enter a name' }]}\n            >\n              <Input placeholder=\"Please enter a name\" value={name} onChange={(e) => { setName(e.target.value) }} />\n            </Form.Item>\n          </Col>\n        </Row>\n        <Row gutter={16}>\n          <Col span={24}>\n            <Form.Item\n              name=\"description\"\n              label=\"Description\"\n              rules={[{ required: true, message: 'Please enter a description' }]}\n            >\n              <TextArea rows={10} placeholder=\"Please enter a description\" value={description} onChange={(e) => { setDescription(e.target.value) }} />\n            </Form.Item>\n          </Col>\n        </Row>\n      </Form>\n    </Drawer>\n  );\n};\n\nexport default AddEditCustomEntity;\n","import { useState, useContext } from 'react';\nimport { AppContext } from '../../stores/AppStore';\nimport AppLogicController from '../../controllers/AppLogicController';\nimport { Button, Popconfirm, message } from 'antd';\nimport { useLiveQuery } from 'dexie-react-hooks';\nimport db from '../../db/AppDatabase';\nimport SimpleEntityView from '../entity_views/SimpleEntityView';\nimport AddEditCustomEntity from '../drawers/AddEditCustomEntity';\n\nconst CustomEntityConfigSection = ({ entityDef }) => {\n  const [,dispatch] = useContext(AppContext);\n  const singularCapitalized = entityDef.singular_name.toLowerCase().charAt(0).toUpperCase() + entityDef.singular_name.toLowerCase().slice(1);\n  const [addEditCustomEntityVisible, setAddEditCustomEntityVisible] = useState(false);\n  const [currentCustomEntity, setCurrentCustomEntity] = useState(null);\n\n  const entities = useLiveQuery(() => db.custom_entities.where('custom_entity_def_id').equals(entityDef.id).toArray());\n\n  const addCustomEntity = () => {\n    setCurrentCustomEntity(null);\n    setAddEditCustomEntityVisible(true);\n  };\n\n  const editEntity = (entity) => {\n    setCurrentCustomEntity(entity);\n    setAddEditCustomEntityVisible(true);\n  };\n\n  const removeEntity = (entity) => {\n    AppLogicController.deleteCustomEntity(dispatch, entity.id).then(result => {\n      message.success(singularCapitalized + ' removed!');\n    }).catch(error => {\n      message.error('Something went wrong, sorry :(');\n    });\n  };\n\n  const onRemoveEntityDef = () => {\n    AppLogicController.deleteCustomEntityDef(dispatch, entityDef.id).then(result => {\n      message.success(entityDef.name + ' removed!');\n    }).catch(error => {\n      message.error('Something went wrong, sorry :(');\n    });\n  };\n\n  return (\n    <div>\n      <div style={{textAlign: 'right', marginBottom: '20px'}} >\n        <Popconfirm\n          key='remove-entity-def'\n          title={`This section and all its content will be removed!! Are you sure you want to remove this entity?`}\n          onConfirm={onRemoveEntityDef}\n          onCancel={() => {}}\n          okText='Yes'\n          cancelText='No'\n          placement='bottomRight'\n        >\n          <Button type='default' danger>\n            Remove entity\n          </Button>\n        </Popconfirm>\n      </div>\n      { entities !== undefined && entities.map(entity =>\n        <SimpleEntityView \n          key={entity.id} \n          entity={entity} \n          entityName={entityDef.singular_name.toLowerCase()} \n          onRemove={() => { removeEntity(entity) }} \n          onEdit={() => { editEntity(entity) }} \n        />\n        )\n      }\n      <Button type='primary' onClick={addCustomEntity}>\n        Add {singularCapitalized}\n      </Button>\n      <AddEditCustomEntity\n        entity={currentCustomEntity}\n        entityDef={entityDef}\n        isDrawerVisible={addEditCustomEntityVisible} \n        onDrawerClose={() => { setAddEditCustomEntityVisible(false); }} \n      />\n    </div>\n  );\n};\n\nexport default CustomEntityConfigSection;\n","import { useState } from 'react';\nimport { Layout, Tabs, Button } from 'antd';\nimport '../../styles/components/pages/ConfigPage.scss';\nimport { PlusSquareOutlined, BgColorsOutlined } from '@ant-design/icons';\nimport AddCustomEntity from '../drawers/AddCustomEntity';\nimport EditColors from '../drawers/EditColors';\nimport { useLiveQuery } from 'dexie-react-hooks';\nimport db from '../../db/AppDatabase';\nimport GameStateConfigSection from '../sections/GameStateConfigSection';\nimport LocationConfigSection from '../sections/LocationConfigSection';\nimport CharacterConfigSection from '../sections/CharacterConfigSection';\nimport CustomEntityConfigSection from '../sections/CustomEntityConfigSection';\n\nconst { Content } = Layout;\nconst { TabPane } = Tabs;\n\nconst ConfigPage = () => {\n  const [addCustomEntityVisible, setAddCustomEntityVisible] = useState(false);\n  const [editColorsVisible, setEditColorsVisible] = useState(false);\n\n  const customEntityDefs = useLiveQuery(() => db.custom_entity_defs.toArray());\n\n  const addCustomEntityButton = <Button size='small' key='add-custom' icon={<PlusSquareOutlined />} onClick={() => { setAddCustomEntityVisible(true); }}>Add entity</Button>;\n\n  const colorsButton = <Button size='small' key='edit-colors' icon={<BgColorsOutlined />} style={{marginRight: '4px'}} onClick={() => { setEditColorsVisible(true); }}>Colors</Button>;\n\n  const buttons = [colorsButton, addCustomEntityButton];\n\n  return (\n    <>\n      <Content className='config-page'>\n        <Tabs type=\"card\" size=\"small\" tabBarExtraContent={buttons}>\n          <TabPane tab=\"Game State\" key=\"1\">\n            <GameStateConfigSection />\n          </TabPane>\n          <TabPane tab=\"Locations\" key=\"2\">\n            <LocationConfigSection />\n          </TabPane>\n          <TabPane tab=\"Characters\" key=\"3\">\n            <CharacterConfigSection />\n          </TabPane>\n          { customEntityDefs !== undefined && customEntityDefs.map((customEntityDef, index) =>\n              <TabPane tab={customEntityDef.name} key={index + 4}>\n                <CustomEntityConfigSection entityDef={customEntityDef} />\n              </TabPane>\n            )\n          }\n        </Tabs>\n      </Content>\n      <AddCustomEntity isDrawerVisible={addCustomEntityVisible} onDrawerClose={() => { setAddCustomEntityVisible(false); }} />\n      <EditColors isDrawerVisible={editColorsVisible} onDrawerClose={() => { setEditColorsVisible(false); }} />\n    </>\n  );\n};\n\nexport default ConfigPage;\n","import { Card, Typography, Button, Popconfirm } from 'antd';\nimport { CaretUpOutlined, CaretDownOutlined } from '@ant-design/icons';\nimport '../../styles/components/entity_views/ChapterView.scss';\n\nconst { Text } = Typography;\n\nconst ChapterView = ({ \n  chapter,\n  chapterIndex = null,\n  totalChapters = 0,\n  canEdit = true, \n  canRemove = true,\n  onRemove = () => {},\n  onEdit = () => {},\n  onMoveOrderUp = () => {},\n  onMoveOrderDown = () => {},\n}) => {\n\n  const options = [];\n  options.push(\n    <Button \n      type=\"default\"\n      key='move-up' \n      icon={<CaretUpOutlined />} \n      size='small' style={{marginRight: '4px'}} \n      disabled={chapterIndex === 0}\n      onClick={onMoveOrderUp} />\n  );\n  options.push(\n    <Button \n      type=\"default\" \n      key='move-down' \n      icon={<CaretDownOutlined />} \n      size='small' \n      style={{marginRight: '24px'}} \n      disabled={chapterIndex === (totalChapters-1)}\n      onClick={onMoveOrderDown} />\n  );\n  if(canEdit) {\n    options.push(<Button key='edit-chapter' type='link' size='small' onClick={onEdit}>Edit</Button>);\n  }\n  if(canRemove) {\n    options.push(\n      <Popconfirm\n        key='remove-chapter'\n        title='Are you sure you want to remove this chapter?'\n        onConfirm={onRemove}\n        onCancel={() => {}}\n        okText='Yes'\n        cancelText='No'\n        placement='bottomRight'\n      >\n        <Button type='link' size='small'>Remove</Button>\n      </Popconfirm>\n    );\n  }\n\n  const title = 'Chapter ' + chapter.order + ': ' + chapter.name;\n\n  return (\n    <Card className='chapter-view' size='small' title={title} extra={options} headStyle={{ background: '#f5f5f5'}} >\n      <Text>{chapter.description}</Text>\n    </Card>\n  );\n};\n\nexport default ChapterView;\n","import { useState, useEffect, useContext } from 'react';\nimport { Drawer, Form, Button, Col, Row, Input, message } from 'antd';\nimport { AppContext } from '../../stores/AppStore';\nimport AppLogicController from '../../controllers/AppLogicController';\n\nconst { TextArea } = Input;\n\nconst AddEditChapter = ({ chapter = null, totalChapters = 0, isDrawerVisible, onDrawerClose }) => {\n  const [,dispatch] = useContext(AppContext);\n  const [form] = Form.useForm();\n  const [visible, setVisible] = useState(false);\n  const [chapterIndex, setChapterIndex] = useState(0);\n  const [name, setName] = useState('');\n  const [description, setDescription] = useState('');\n\n  useEffect(() => {\n    if(isDrawerVisible) { //opening drawer\n      form.resetFields();\n      if (chapter) {\n        form.setFieldsValue({name: chapter.name, description: chapter.description, chapterIndex: chapter.order});\n        setChapterIndex(chapter.order);\n      } else {\n        const index = totalChapters + 1;\n        form.setFieldsValue({chapterIndex: index});\n        setChapterIndex(index);\n      }\n      openDrawer();\n    }\n  }, [isDrawerVisible, form, chapter, totalChapters]);\n\n  const openDrawer = () => {\n    setVisible(true);\n  };\n\n  const closeDrawer = () => {\n    setVisible(false);\n    onDrawerClose && onDrawerClose();\n  };\n\n  const onFinish = (values) => {\n    const name = values.name.trim();\n    const description = values.description.trim();\n    if(name === '' || description === ''){\n      closeDrawer();\n      message.error('Do not leave empty fields, sorry :(');\n      return;\n    }\n    const data = {name, description, order: chapterIndex};\n    if (chapter === null) { //new chapter\n      AppLogicController.createNewChapter(dispatch, data).then(result => {\n        closeDrawer();\n        message.success('New chapter created!');\n      }).catch(error => {\n        closeDrawer();\n        message.error('Something went wrong, sorry :(');\n      });\n    } else { //editing chapter\n      AppLogicController.updateChapter(dispatch, chapter.id, data).then(result => {\n        closeDrawer();\n        message.success('Chapter edited!');\n      }).catch(error => {\n        closeDrawer();\n        message.error('Something went wrong, sorry :(');\n      });\n    }\n  };\n\n  return (\n    <Drawer\n      title={(chapter === null) ? 'New chapter' : 'Edit chapter'}\n      width={360}\n      onClose={closeDrawer}\n      visible={visible}\n      bodyStyle={{ paddingBottom: 20 }}\n      footer={\n        <div style={{textAlign: 'right'}} >\n          <Button onClick={closeDrawer} style={{ marginRight: 8 }}>\n            Cancel\n          </Button>\n          <Button type=\"primary\" htmlType=\"submit\" form='add-edit-chapter-id'>\n            {(chapter === null) ? 'Create' : 'Update'}\n          </Button>\n        </div>\n      }\n    >\n      <Form layout='vertical' name='add-edit-chapter' id='add-edit-chapter-id' form={form} onFinish={onFinish} requiredMark={false}>\n        <Row gutter={16}>\n          <Col span={24}>\n            <Form.Item\n              name=\"chapterIndex\"\n              label=\"Chapter\"\n            >\n              <Input placeholder=\"#\" value={chapterIndex} disabled />\n            </Form.Item>\n          </Col>\n        </Row>\n        <Row gutter={16}>\n          <Col span={24}>\n            <Form.Item\n              name=\"name\"\n              label=\"Name\"\n              rules={[{ required: true, message: 'Please enter a name' }]}\n            >\n              <Input placeholder=\"Please enter a name\" value={name} onChange={(e) => { setName(e.target.value) }} />\n            </Form.Item>\n          </Col>\n        </Row>\n        <Row gutter={16}>\n          <Col span={24}>\n            <Form.Item\n              name=\"description\"\n              label=\"Description\"\n              rules={[{ required: true, message: 'Please enter a description' }]}\n            >\n              <TextArea rows={10} placeholder=\"Please enter a description\" value={description} onChange={(e) => { setDescription(e.target.value) }} />\n            </Form.Item>\n          </Col>\n        </Row>\n      </Form>\n    </Drawer>\n  );\n};\n\nexport default AddEditChapter;\n","import { useState, useContext } from 'react';\nimport { AppContext } from '../../stores/AppStore';\nimport AppLogicController from '../../controllers/AppLogicController';\nimport { Button, message } from 'antd';\nimport { useLiveQuery } from 'dexie-react-hooks';\nimport db from '../../db/AppDatabase';\nimport ChapterView from '../entity_views/ChapterView';\nimport AddEditChapter from '../drawers/AddEditChapter';\n\nconst StorylineSection = () => {\n  const [,dispatch] = useContext(AppContext);\n  const [addEditChapterVisible, setAddEditChapterVisible] = useState(false);\n  const [currentChapter, setCurrentChapter] = useState(null);\n\n  const chapters = useLiveQuery(() => db.chapters.orderBy('order').toArray());\n\n  const addChapter = () => {\n    setCurrentChapter(null);\n    setAddEditChapterVisible(true);\n  };\n\n  const editCharpter = (chapter) => {\n    setCurrentChapter(chapter);\n    setAddEditChapterVisible(true);\n  };\n\n  const moveCharpterUp = (chapter) => {\n    const orderInfo = {oldOrder: chapter.order, order: chapter.order - 1};\n    AppLogicController.updateChapterOrder(dispatch, chapter.id, orderInfo).then(result => {\n      //\n    }).catch(error => {\n      message.error('Something went wrong, sorry :(');\n    });\n  };\n\n  const moveCharpterDown = (chapter) => {\n    const orderInfo = {oldOrder: chapter.order, order: chapter.order + 1};\n    AppLogicController.updateChapterOrder(dispatch, chapter.id, orderInfo).then(result => {\n      //\n    }).catch(error => {\n      message.error('Something went wrong, sorry :(');\n    });\n  };\n\n  const removeChapter = (chapter) => {\n    AppLogicController.deleteChapter(dispatch, chapter.id).then(result => {\n      message.success('Chapter removed!');\n    }).catch(error => {\n      message.error('Something went wrong, sorry :(');\n    });\n  };\n\n  const totalChapters = (chapters !== undefined) ? chapters.length : 0;\n\n  return (\n    <div>\n      { chapters !== undefined && chapters.map((chapter, index) =>\n        <ChapterView \n          key={chapter.id} \n          chapter={chapter}\n          chapterIndex={index} \n          totalChapters={totalChapters}\n          onRemove={() => { removeChapter(chapter) }} \n          onEdit={() => { editCharpter(chapter) }} \n          onMoveOrderUp={() => { moveCharpterUp(chapter) }} \n          onMoveOrderDown={() => { moveCharpterDown(chapter) }} \n        />\n        )\n      }\n      <Button type='primary' onClick={addChapter}>\n        Add Chapter\n      </Button>\n      <AddEditChapter\n        chapter={currentChapter}\n        totalChapters={totalChapters}\n        isDrawerVisible={addEditChapterVisible} \n        onDrawerClose={() => { setAddEditChapterVisible(false); }} \n      />\n    </div>\n  );\n};\n\nexport default StorylineSection;\n","import { Layout, Tabs } from 'antd';\nimport '../../styles/components/pages/StoryPage.scss';\nimport StorylineSection from '../sections/StorylineSection';\n\nconst { Content } = Layout;\nconst { TabPane } = Tabs;\n\nconst StoryPage = () => {\n\n  return (\n    <Content className='story-page'>\n      <Tabs type='card' size='small'>\n        <TabPane tab='Storyline' key='1'>\n          <StorylineSection />\n        </TabPane>\n        <TabPane tab='Sequence Actions' key='2'>\n          <p>Sequence Actions</p>\n        </TabPane>\n      </Tabs>\n    </Content>\n  );\n};\n\nexport default StoryPage;\n","//-- Components --//\nimport React, { useEffect, useContext } from 'react';\nimport { Layout, Typography, Spin } from 'antd';\nimport AppNav from './components/AppNav';\nimport StoryTitle from './components/StoryTitle';\nimport EmptyProjectPage from './components/pages/EmptyProjectPage';\nimport ConfigPage from './components/pages/ConfigPage';\nimport StoryPage from './components/pages/StoryPage';\n//-- Context --//\nimport { AppContext } from './stores/AppStore';\n//-- Controller --//\nimport AppLogicController from './controllers/AppLogicController';\n//-- Images --//\nimport logo from './images/logo192.png';\n\n\nconst { Text } = Typography;\n\nconst AppLayout = () => {\n  const [state, dispatch] = useContext(AppContext);\n\n  useEffect(() => {\n    //Mount\n    AppLogicController.checkDatabaseOk(dispatch);\n    AppLogicController.checkStoryLoaded(dispatch);\n\n  }, []); // eslint-disable-line\n\n  if(!state.initialCheckDone) {\n    return (\n      <div className='app loading'>\n        <img src={logo} alt='RPG Story Playtesting' />\n        <Spin size='large' />\n      </div>\n    );\n    \n  }\n\n  if(state.databaseLoadError) {\n    return (\n      <Text>This application requires IndexedDB. Please use a browser that supports this feature.</Text>\n    );\n  }\n\n  return (\n    <div className=\"app\">\n      <Layout>\n        <AppNav />\n        <Layout className=\"app-layout\">\n          {state.storyLoaded\n            ?\n              <>\n                <StoryTitle />\n                {React.createElement(state.page === 'CONFIG' ? ConfigPage : StoryPage)}\n              </>\n            : \n              <EmptyProjectPage />\n          }\n        </Layout>\n        \n      </Layout>\n    </div>\n  );\n};\n\nexport default AppLayout;\n","import AppLayout from './AppLayout';\nimport AppStore from './stores/AppStore';\nimport './styles/AntDThemeConfig.less';\nimport './styles/App.scss';\n\nconst App = () => {\n  return (\n    <AppStore>\n      <AppLayout />\n    </AppStore>\n  );\n};\n\nexport default App;\n","const reportWebVitals = onPerfEntry => {\n  if (onPerfEntry && onPerfEntry instanceof Function) {\n    import('web-vitals').then(({ getCLS, getFID, getFCP, getLCP, getTTFB }) => {\n      getCLS(onPerfEntry);\n      getFID(onPerfEntry);\n      getFCP(onPerfEntry);\n      getLCP(onPerfEntry);\n      getTTFB(onPerfEntry);\n    });\n  }\n};\n\nexport default reportWebVitals;\n","import React from 'react';\nimport ReactDOM from 'react-dom';\nimport './index.css';\nimport App from './App';\nimport reportWebVitals from './reportWebVitals';\n\nReactDOM.render(\n  <React.StrictMode>\n    <App />\n  </React.StrictMode>,\n  document.getElementById('root')\n);\n\n// If you want to start measuring performance in your app, pass a function\n// to log results (for example: reportWebVitals(console.log))\n// or send to an analytics endpoint. Learn more: https://bit.ly/CRA-vitals\nreportWebVitals();\n"],"sourceRoot":""}