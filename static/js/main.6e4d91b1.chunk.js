(this.webpackJsonprpgsp=this.webpackJsonprpgsp||[]).push([[0],{230:function(e,t,n){},302:function(e,t,n){},303:function(e,t,n){},305:function(e,t,n){},306:function(e,t,n){},367:function(e,t,n){},368:function(e,t,n){},369:function(e,t,n){},370:function(e,t,n){},371:function(e,t,n){},372:function(e,t,n){},373:function(e,t,n){},374:function(e,t,n){},375:function(e,t,n){},376:function(e,t,n){},377:function(e,t,n){},378:function(e,t,n){},379:function(e,t,n){"use strict";n.r(t);var a=n(0),r=n.n(a),c=n(21),i=n.n(c),o=(n(230),n(7)),s=n(387),l=n(215),u=n(382),d=n(17),j=n.n(d),b=n(27),h=n(219),f=n(394),p=n(383),m=n(120),O=n(384),y=n(105),x=n(58),g=n(400),v=n(401),w=n(402),A=n(403),C=n(404),S=n(405),E=n(225),k=n(406),T=n(407),R=n(386),P=n(393),I=n(390),N=n(33),D=function(e,t){switch(t.type){case"SET_APP_INITIAL_CHECK_DONE":return Object(N.a)(Object(N.a)({},e),{},{initialCheckDone:!0});case"SET_APP_DATABASE_LOAD_ERROR":return Object(N.a)(Object(N.a)({},e),{},{databaseLoadError:!0,initialCheckDone:!0});case"SET_APP_STORY_LOAD_ERROR":return Object(N.a)(Object(N.a)({},e),{},{globalLoading:!1,storyLoadError:!0,storyErrorMessage:t.payload||null});case"SET_APP_PAGE":return Object(N.a)(Object(N.a)({},e),{},{page:t.payload});case"SET_APP_GLOBAL_LOADING":return Object(N.a)(Object(N.a)({},e),{},{globalLoading:t.payload||!1});case"SET_STORY_LOADED":return Object(N.a)(Object(N.a)({},e),{},{globalLoading:!1,storyLoaded:t.payload,storyRunnable:!1,page:t.payload?"CONFIG":"EMPTY"});case"SET_STORY_VERIFYING_RUNNABLE":return Object(N.a)(Object(N.a)({},e),{},{storyVerifyingRunnable:!0,storyRunnable:!1});case"SET_STORY_NOT_RUNNABLE":return Object(N.a)(Object(N.a)({},e),{},{storyVerifyingRunnable:!1,storyRunnable:!1});case"SET_STORY_RUNNABLE":return Object(N.a)(Object(N.a)({},e),{},{storyVerifyingRunnable:!1,storyRunnable:!0});default:return e}},_=n(1),L={initialCheckDone:!1,globalLoading:!1,databaseLoadError:!1,storyLoadError:!1,storyErrorMessage:null,storyLoaded:!1,storyVerifyingRunnable:!1,storyRunnable:!1,page:"EMPTY"},B=Object(a.createContext)(L),F=function(e){var t=e.children,n=Object(a.useReducer)(D,L),r=Object(o.a)(n,2),c=r[0],i=r[1];return Object(_.jsx)(B.Provider,{value:[c,i],children:t})},V=n(44),Q=n(45),q=new(n(172).default)("RpgspDatabase");q.version(1).stores({stories:"++id",game_state_props:"++id, name",locations:"++id, name",areas:"++id, location_id, name",characters:"++id, name",custom_entity_defs:"++id, singular_name",custom_entities:"++id, custom_entity_def_id, name",default_entity_colors:"++id",chapters:"++id, order",acts:"++id, order, chapter_id, type"});var G=q,U=function(){function e(){Object(V.a)(this,e)}return Object(Q.a)(e,null,[{key:"getNewStoryDefaultGameStateProps",value:function(){return[{name:"currentChapter",type:"int",default:0,edit_mode:"none",removable:!1},{name:"currentAct",type:"int",default:0,edit_mode:"none",removable:!1},{name:"currentActSequence",type:"int",default:0,edit_mode:"none",removable:!1},{name:"currentLocation",type:"location",default:null,edit_mode:"default",removable:!1},{name:"currentArea",type:"area",default:null,edit_mode:"default",removable:!1}]}},{key:"getNewStoryDefaultCharacters",value:function(){return[{name:"[Playable character]",description:"[Add description]"}]}},{key:"getNewStoryDefaultEntityColors",value:function(){return[{name:"locations",color:e.getEntitiesDefaultColors("locations")},{name:"areas",color:e.getEntitiesDefaultColors("areas")},{name:"characters",color:e.getEntitiesDefaultColors("characters")}]}},{key:"getEntitiesDefaultColors",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"locations";switch(e){case"characters":return"#1890ff";case"areas":return"#a0d911";case"locations":default:return"#3f6600"}}},{key:"getCustomEntityRandomColor",value:function(){return["#ffa940","#73d13d","#10239e","#36cfc9","#9e1068","#9254de","#85a5ff","#fadb14","#ffa940","#391085"][Math.floor(10*Math.random())]}}]),e}(),z=function(){function e(){Object(V.a)(this,e)}return Object(Q.a)(e,null,[{key:"checkDatabaseOk",value:function(e){q.open().catch((function(t){console.error("Failed to open db: "+(t.stack||t)),e({type:"SET_APP_DATABASE_LOAD_ERROR"})}))}},{key:"checkStoryLoaded",value:function(){var e=Object(b.a)(j.a.mark((function e(t){return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,G.stories.where("id").equals(1).first();case 2:void 0!==e.sent&&t({type:"SET_STORY_LOADED",payload:!0}),t({type:"SET_APP_INITIAL_CHECK_DONE"});case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()},{key:"createNewStory",value:function(e,t){return G.transaction("rw",G.stories,G.game_state_props,G.characters,G.default_entity_colors,Object(b.a)(j.a.mark((function e(){return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,G.stories.add({title:t.title,version:t.version});case 2:return e.next=4,G.game_state_props.bulkAdd(U.getNewStoryDefaultGameStateProps());case 4:return e.next=6,G.characters.bulkAdd(U.getNewStoryDefaultCharacters());case 6:return e.next=8,G.default_entity_colors.bulkAdd(U.getNewStoryDefaultEntityColors());case 8:case"end":return e.stop()}}),e)})))).then((function(t){e({type:"SET_STORY_LOADED",payload:!0})})).catch((function(e){return console.log("||--FAIL",e),Promise.reject(e)}))}},{key:"createNewGameStateProp",value:function(e,t){return G.game_state_props.add({name:t.name,type:t.type,default:t.defaultValue,edit_mode:t.editMode,removable:t.removable}).then((function(){})).catch((function(e){return console.log("||--FAIL",e),Promise.reject(e)}))}},{key:"updateGameStateProp",value:function(e,t,n){return G.game_state_props.update(t,{name:n.name,type:n.type,default:n.defaultValue,edit_mode:n.editMode,removable:n.removable}).then((function(){})).catch((function(e){return console.log("||--FAIL",e),Promise.reject(e)}))}},{key:"deleteGameStateProp",value:function(e,t){return G.game_state_props.delete(t).then((function(){})).catch((function(e){return console.log("||--FAIL",e),Promise.reject(e)}))}},{key:"createNewLocation",value:function(e,t){return G.locations.add({name:t.name,description:t.description}).then((function(){})).catch((function(e){return console.log("||--FAIL",e),Promise.reject(e)}))}},{key:"updateLocation",value:function(e,t,n){return G.locations.update(t,{name:n.name,description:n.description}).then((function(){})).catch((function(e){return console.log("||--FAIL",e),Promise.reject(e)}))}},{key:"deleteLocation",value:function(e,t){return G.transaction("rw",G.locations,G.areas,Object(b.a)(j.a.mark((function e(){return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,G.areas.where("location_id").equals(t).delete();case 2:return e.next=4,G.locations.delete(t);case 4:case"end":return e.stop()}}),e)})))).then((function(e){})).catch((function(e){return console.log("||--FAIL",e),Promise.reject(e)}))}},{key:"createNewArea",value:function(e,t){return G.areas.add({location_id:t.location_id,name:t.name,description:t.description}).then((function(){})).catch((function(e){return console.log("||--FAIL",e),Promise.reject(e)}))}},{key:"updateArea",value:function(e,t,n){return G.areas.update(t,{name:n.name,description:n.description}).then((function(){})).catch((function(e){return console.log("||--FAIL",e),Promise.reject(e)}))}},{key:"deleteArea",value:function(e,t){return G.areas.delete(t).then((function(){})).catch((function(e){return console.log("||--FAIL",e),Promise.reject(e)}))}},{key:"createNewCharacter",value:function(e,t){return G.characters.add({name:t.name,description:t.description}).then((function(){})).catch((function(e){return console.log("||--FAIL",e),Promise.reject(e)}))}},{key:"updateCharacter",value:function(e,t,n){return G.characters.update(t,{name:n.name,description:n.description}).then((function(){})).catch((function(e){return console.log("||--FAIL",e),Promise.reject(e)}))}},{key:"deleteCharacter",value:function(e,t){return G.characters.delete(t).then((function(){})).catch((function(e){return console.log("||--FAIL",e),Promise.reject(e)}))}},{key:"createNewCustomEntityDef",value:function(e,t){return G.custom_entity_defs.add({name:t.name,key:t.key,singular_name:t.singular,color:U.getCustomEntityRandomColor()}).then((function(){})).catch((function(e){return console.log("||--FAIL",e),Promise.reject(e)}))}},{key:"deleteCustomEntityDef",value:function(e,t){return G.transaction("rw",G.custom_entity_defs,G.custom_entities,Object(b.a)(j.a.mark((function e(){return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,G.custom_entities.where("custom_entity_def_id").equals(t).delete();case 2:return e.next=4,G.custom_entity_defs.delete(t);case 4:case"end":return e.stop()}}),e)})))).then((function(e){})).catch((function(e){return console.log("||--FAIL",e),Promise.reject(e)}))}},{key:"createNewCustomEntity",value:function(e,t){return G.custom_entities.add({custom_entity_def_id:t.custom_entity_def_id,name:t.name,description:t.description}).then((function(){})).catch((function(e){return console.log("||--FAIL",e),Promise.reject(e)}))}},{key:"updateCustomEntity",value:function(e,t,n){return G.custom_entities.update(t,{name:n.name,description:n.description}).then((function(){})).catch((function(e){return console.log("||--FAIL",e),Promise.reject(e)}))}},{key:"deleteCustomEntity",value:function(e,t){return G.custom_entities.delete(t).then((function(){})).catch((function(e){return console.log("||--FAIL",e),Promise.reject(e)}))}},{key:"updateDefaultEntityColor",value:function(e,t,n){return G.default_entity_colors.update(t,{color:n.color}).then((function(){})).catch((function(e){return console.log("||--FAIL",e),Promise.reject(e)}))}},{key:"updateCustomEntityDefColor",value:function(e,t,n){return G.custom_entity_defs.update(t,{color:n.color}).then((function(){})).catch((function(e){return console.log("||--FAIL",e),Promise.reject(e)}))}},{key:"createNewChapter",value:function(e,t){return G.chapters.add({name:t.name,description:t.description,order:t.order}).then((function(){})).catch((function(e){return console.log("||--FAIL",e),Promise.reject(e)}))}},{key:"updateChapter",value:function(e,t,n){return G.chapters.update(t,{name:n.name,description:n.description}).then((function(){})).catch((function(e){return console.log("||--FAIL",e),Promise.reject(e)}))}},{key:"updateChapterOrder",value:function(e,t,n){return G.transaction("rw",G.chapters,Object(b.a)(j.a.mark((function e(){var a;return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,G.chapters.where("order").equals(n.order).first();case 2:return a=e.sent,e.next=5,G.chapters.update(t,{order:n.order});case 5:return e.next=7,G.chapters.update(a.id,{order:n.oldOrder});case 7:case"end":return e.stop()}}),e)})))).then((function(e){})).catch((function(e){return console.log("||--FAIL",e),Promise.reject(e)}))}},{key:"deleteChapter",value:function(e,t){return G.transaction("rw",G.chapters,Object(b.a)(j.a.mark((function e(){var n,a,r;return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=null,a=[],r=G.chapters.orderBy("order"),e.next=5,r.each((function(e){null!==n&&a.push({key:e.id,order:n+a.length}),e.id===t&&(n=e.order)}));case 5:return e.next=7,G.chapters.delete(t);case 7:a.forEach(function(){var e=Object(b.a)(j.a.mark((function e(t){return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,G.chapters.update(t.key,{order:t.order});case 2:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}());case 8:case"end":return e.stop()}}),e)})))).then((function(e){})).catch((function(e){return console.log("||--FAIL",e),Promise.reject(e)}))}},{key:"createNewAct",value:function(e,t){return G.acts.add({chapter_id:t.chapter_id,name:t.name,description:t.description,order:t.order,type:t.type}).then((function(){})).catch((function(e){return console.log("||--FAIL",e),Promise.reject(e)}))}},{key:"updateAct",value:function(e,t,n){return G.acts.update(t,{name:n.name,description:n.description}).then((function(){})).catch((function(e){return console.log("||--FAIL",e),Promise.reject(e)}))}},{key:"updateActOrder",value:function(e,t,n){return G.transaction("rw",G.acts,Object(b.a)(j.a.mark((function e(){var a;return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,G.acts.where({chapter_id:n.chapter_id,order:n.order}).first();case 2:return a=e.sent,e.next=5,G.acts.update(t,{order:n.order});case 5:return e.next=7,G.acts.update(a.id,{order:n.oldOrder});case 7:case"end":return e.stop()}}),e)})))).then((function(e){})).catch((function(e){return console.log("||--FAIL",e),Promise.reject(e)}))}},{key:"deleteAct",value:function(e,t,n){return G.transaction("rw",G.acts,Object(b.a)(j.a.mark((function e(){var a,r,c,i;return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=null,r=[],e.next=4,G.acts.where("chapter_id").equals(n).toArray();case 4:return c=e.sent,i=c.sort((function(e,t){return e.order-t.order})),e.next=8,i.forEach((function(e){null!==a&&r.push({key:e.id,order:a+r.length}),e.id===t&&(a=e.order)}));case 8:return e.next=10,G.acts.delete(t);case 10:r.forEach(function(){var e=Object(b.a)(j.a.mark((function e(t){return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,G.acts.update(t.key,{order:t.order});case 2:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}());case 11:case"end":return e.stop()}}),e)})))).then((function(e){})).catch((function(e){return console.log("||--FAIL",e),Promise.reject(e)}))}},{key:"devStartOver",value:function(e){return G.delete().then((function(){return window.location.reload()}))}}]),e}(),M=function(e){var t=e.isDrawerVisible,n=e.onDrawerClose,r=Object(a.useContext)(B),c=Object(o.a)(r,2)[1],i=R.a.useForm(),s=Object(o.a)(i,1)[0],l=Object(a.useState)(!1),u=Object(o.a)(l,2),d=u[0],j=u[1],b=Object(a.useState)(""),f=Object(o.a)(b,2),p=f[0],O=f[1],g=Object(a.useState)(""),v=Object(o.a)(g,2),w=v[0],A=v[1];Object(a.useEffect)((function(){t&&(s.resetFields(),C())}),[t,s]);var C=function(){j(!0)},S=function(){j(!1),n&&n()};return Object(_.jsx)(P.a,{title:"New story",width:360,onClose:S,visible:d,bodyStyle:{paddingBottom:20},footer:Object(_.jsxs)("div",{style:{textAlign:"right"},children:[Object(_.jsx)(m.a,{onClick:S,style:{marginRight:8},children:"Cancel"}),Object(_.jsx)(m.a,{type:"primary",htmlType:"submit",form:"create-story-id",children:"Create"})]}),children:Object(_.jsxs)(R.a,{layout:"vertical",name:"create-story",id:"create-story-id",form:s,onFinish:function(e){var t=e.title.trim(),n=e.version.trim();if(""===t||""===n)return S(),void h.b.error("Something went wrong, sorry :(");var a={title:t,version:n};z.createNewStory(c,a).then((function(e){S(),h.b.success("Story created!")})).catch((function(e){S(),h.b.error("Something went wrong, sorry :(")}))},requiredMark:!1,children:[Object(_.jsx)(y.a,{gutter:16,children:Object(_.jsx)(x.a,{span:24,children:Object(_.jsx)(R.a.Item,{name:"title",label:"Title",rules:[{required:!0,message:"Please enter a title"}],children:Object(_.jsx)(I.a,{placeholder:"Please enter a title",value:p,onChange:function(e){O(e.target.value)}})})})}),Object(_.jsx)(y.a,{gutter:16,children:Object(_.jsx)(x.a,{span:24,children:Object(_.jsx)(R.a.Item,{name:"version",label:"Version",rules:[{required:!0,message:"Please enter a version"}],children:Object(_.jsx)(I.a,{placeholder:"Please enter a version",value:w,onChange:function(e){A(e.target.value)}})})})})]})})},K=n(65),Y=function(){function e(){Object(V.a)(this,e)}return Object(Q.a)(e,null,[{key:"verifyStoryRunnable",value:function(){var e=Object(b.a)(j.a.mark((function e(t){return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t({type:"SET_STORY_VERIFYING_RUNNABLE"}),setTimeout((function(){t({type:"SET_STORY_RUNNABLE"})}),3e3);case 2:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()},{key:"validateEntityNames",value:function(){var e=Object(b.a)(j.a.mark((function e(t,n){var a;return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=[],e.abrupt("return",G.transaction("r",n,Object(b.a)(j.a.mark((function e(){var r,c,i;return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:r=Object(K.a)(t),e.prev=1,r.s();case 3:if((c=r.n()).done){e.next=11;break}return i=c.value,e.next=7,n.where({name:i}).first();case 7:void 0===e.sent&&a.push(i);case 9:e.next=3;break;case 11:e.next=16;break;case 13:e.prev=13,e.t0=e.catch(1),r.e(e.t0);case 16:return e.prev=16,r.f(),e.finish(16);case 19:if(0!==a.length){e.next=23;break}return e.abrupt("return",Promise.resolve());case 23:return e.abrupt("return",Promise.reject(a));case 24:case"end":return e.stop()}}),e,null,[[1,13,16,19]])})))));case 2:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}()},{key:"validateCustomEntityNames",value:function(){var e=Object(b.a)(j.a.mark((function e(t,n){var a;return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=[],e.abrupt("return",G.transaction("r",G.custom_entities,Object(b.a)(j.a.mark((function e(){var r,c,i;return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:r=Object(K.a)(t),e.prev=1,r.s();case 3:if((c=r.n()).done){e.next=11;break}return i=c.value,e.next=7,G.custom_entities.where({name:i,custom_entity_def_id:n}).first();case 7:void 0===e.sent&&a.push(i);case 9:e.next=3;break;case 11:e.next=16;break;case 13:e.prev=13,e.t0=e.catch(1),r.e(e.t0);case 16:return e.prev=16,r.f(),e.finish(16);case 19:if(0!==a.length){e.next=23;break}return e.abrupt("return",Promise.resolve());case 23:return e.abrupt("return",Promise.reject(a));case 24:case"end":return e.stop()}}),e,null,[[1,13,16,19]])})))));case 2:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}()}]),e}(),X=n(154),J=n(207),Z=n.n(J),W=function(){function e(){Object(V.a)(this,e)}return Object(Q.a)(e,null,[{key:"downloadStory",value:function(){var e=Object(b.a)(j.a.mark((function e(t){var n,a,r,c,i,o,s,l=arguments;return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=l.length>1&&void 0!==l[1]?l[1]:function(){},a=l.length>2&&void 0!==l[2]?l[2]:function(){},e.prev=2,e.next=5,G.stories.where("id").equals(1).first();case 5:return r=e.sent,c=new Date,i=c.getFullYear().toString()+c.getMonth().toString()+c.getDate().toString()+"-"+c.getHours().toString()+c.getMinutes().toString()+c.getSeconds().toString(),o=r.title.replaceAll(" ","_")+"-"+i+".json",e.next=11,Object(X.a)(G,{prettyJson:!0,progressCallback:n});case 11:s=e.sent,Z()(s,o,"application/json"),e.next=18;break;case 15:e.prev=15,e.t0=e.catch(2),a(e.t0);case 18:case"end":return e.stop()}}),e,null,[[2,15]])})));return function(t){return e.apply(this,arguments)}}()},{key:"loadStoryFromFile",value:function(){var e=Object(b.a)(j.a.mark((function e(t,n){var a,r,c=arguments;return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(a=c.length>2&&void 0!==c[2]?c[2]:function(){},r=c.length>3&&void 0!==c[3]?c[3]:function(){},e.prev=2,!G.isOpen()){e.next=6;break}return e.next=6,G.delete().then((function(){return G.open()}));case 6:return e.next=8,Object(X.b)(G,n,{acceptMissingTables:!1,acceptVersionDiff:!1,acceptNameDiff:!1,acceptChangedPrimaryKey:!1,progressCallback:a});case 8:return e.next=10,G.stories.where("id").equals(1).first();case 10:void 0!==e.sent&&t({type:"SET_STORY_LOADED",payload:!0}),r(),e.next=19;break;case 15:e.prev=15,e.t0=e.catch(2),t({type:"SET_APP_STORY_LOAD_ERROR",payload:e.t0}),console.log(e.t0);case 19:case"end":return e.stop()}}),e,null,[[2,15]])})));return function(t,n){return e.apply(this,arguments)}}()},{key:"loadStoryFromUrl",value:function(){var e=Object(b.a)(j.a.mark((function e(t,n){var a,r,c=arguments;return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=c.length>2&&void 0!==c[2]?c[2]:function(){},r=c.length>3&&void 0!==c[3]?c[3]:function(){},t({type:"SET_APP_GLOBAL_LOADING",payload:!0}),e.next=5,new Promise((function(e){return setTimeout(e,800)}));case 5:try{fetch(n).then(function(){var e=Object(b.a)(j.a.mark((function e(n){return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(200===n.status){e.next=3;break}return t({type:"SET_APP_STORY_LOAD_ERROR",payload:n.status}),e.abrupt("return");case 3:if(!G.isOpen()){e.next=6;break}return e.next=6,G.delete().then((function(){return G.open()}));case 6:n.blob().then(function(){var e=Object(b.a)(j.a.mark((function e(n){return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object(X.b)(G,n,{acceptMissingTables:!1,acceptVersionDiff:!1,acceptNameDiff:!1,acceptChangedPrimaryKey:!1,progressCallback:a});case 2:return e.next=4,G.stories.where("id").equals(1).first();case 4:void 0!==e.sent&&(t({type:"SET_STORY_LOADED",payload:!0}),r());case 6:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}());case 7:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()).catch((function(e){t({type:"SET_APP_STORY_LOAD_ERROR",payload:e}),console.log(e)}))}catch(i){t({type:"SET_APP_STORY_LOAD_ERROR",payload:i}),console.log(i)}case 6:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}()}]),e}(),H="data:image/png;base64,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",$=(n(302),u.a.Sider),ee=function(){var e=Object(a.useContext)(B),t=Object(o.a)(e,2),n=t[0],r=t[1],c=Object(a.useState)(!1),i=Object(o.a)(c,2),s=i[0],l=i[1],u=Object(a.useState)(!0),d=Object(o.a)(u,2),R=d[0],P=d[1],I=Object(a.useState)(!1),N=Object(o.a)(I,2),D=N[0],L=N[1];Object(a.useEffect)((function(){document.getElementById("load-story-selector").addEventListener("change",Q,!1)}),[]),Object(a.useEffect)((function(){P(!1),setTimeout((function(){P(!0)}),5)}),[n.storyLoaded]);var F=function(){document.getElementById("load-story-selector").click()},V=function(){z.devStartOver(r)},Q=function(){var e=Object(b.a)(j.a.mark((function e(t){var n;return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=t.target.files[0]){e.next=3;break}return e.abrupt("return");case 3:W.loadStoryFromFile(r,n,q,G);case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),q=function(e){e.totalRows,e.completedRows},G=function(){h.b.success("Story imported successfully!")},U=function(){l(!s)},K=function(e){switch(e.key){case"1":r({type:"SET_APP_PAGE",payload:"CONFIG"});break;case"2":r({type:"SET_APP_PAGE",payload:"STORY"});break;case"3":Y.verifyStoryRunnable(r),setTimeout((function(){r({type:"SET_APP_PAGE",payload:"PLAYMODE"})}),50)}},X=function(e){W.loadStoryFromUrl(r,e,J,Z)},J=function(){},Z=function(){h.b.success("Sample story imported successfully!")};return Object(_.jsxs)(_.Fragment,{children:[Object(_.jsxs)($,{className:"app-nav",collapsible:!0,collapsed:s,onCollapse:U,children:[Object(_.jsx)("div",{className:"logo ".concat(s?"collapsed":""),children:Object(_.jsx)("img",{src:H,alt:"RPG Story Playtesting",onClick:U})}),Object(_.jsx)("div",{className:"menu-wrapper",children:R&&Object(_.jsxs)(f.a,{theme:"dark",mode:"inline",defaultSelectedKeys:n.storyLoaded?["1"]:[],onClick:K,children:[Object(_.jsx)(f.a.Item,{disabled:!n.storyLoaded,icon:Object(_.jsx)(g.a,{}),children:"Configuration"},"1"),Object(_.jsx)(f.a.Item,{disabled:!n.storyLoaded,icon:Object(_.jsx)(v.a,{}),children:"Story"},"2"),Object(_.jsx)(f.a.Item,{disabled:!n.storyLoaded,icon:Object(_.jsx)(w.a,{}),children:"Play"},"3")]})}),!s&&Object(_.jsx)(y.a,{gutter:16,style:{marginLeft:8,marginRight:8,marginTop:32},children:Object(_.jsxs)(x.a,{span:24,children:[!n.storyLoaded&&Object(_.jsx)(m.a,{type:"default",onClick:function(){L(!0)},block:!0,icon:Object(_.jsx)(E.a,{}),style:{marginBottom:12},children:"New story"}),Object(_.jsxs)(_.Fragment,{children:[n.storyLoaded?Object(_.jsx)(p.a,{title:function(){return Object(_.jsxs)("p",{children:["Download current story to avoid losing your changes.",Object(_.jsx)("br",{}),"Continue loading a new story?"]})},onConfirm:F,onCancel:function(){},okText:"Yes",cancelText:"No",placement:"right",children:Object(_.jsx)(m.a,{type:"default",block:!0,icon:Object(_.jsx)(A.a,{}),style:{marginBottom:12},children:"Load story"})}):Object(_.jsx)(m.a,{type:"default",block:!0,icon:Object(_.jsx)(A.a,{}),style:{marginBottom:12},onClick:F,children:"Load story"}),Object(_.jsx)("input",{type:"file",id:"load-story-selector",accept:".json",style:{display:"none"}})]}),n.storyLoaded&&Object(_.jsxs)(_.Fragment,{children:[Object(_.jsx)(m.a,{type:"default",block:!0,icon:Object(_.jsx)(k.a,{}),style:{marginBottom:12},onClick:function(){W.downloadStory(r)},children:"Download story"}),Object(_.jsx)(p.a,{title:"All data will be lost. Are you sure to delete this story?",onConfirm:V,onCancel:function(){},okText:"Yes",cancelText:"No",placement:"right",children:Object(_.jsx)(m.a,{type:"default",block:!0,icon:Object(_.jsx)(C.a,{}),style:{marginBottom:12},children:"Clear story"})})]}),function(){var e=Object(_.jsxs)("div",{children:[Object(_.jsx)(m.a,{type:"default",block:!0,style:{marginBottom:12},onClick:function(){X("https://gcsebas99.github.io/rpgsp/samples/Sample1_en.json")},children:"Sample #1 (english)"}),Object(_.jsx)(m.a,{type:"default",block:!0,style:{marginBottom:12},onClick:function(){X("https://gcsebas99.github.io/rpgsp/samples/Sample1_es.json")},children:"Sample #1 (spanish)"})]});return Object(_.jsx)(O.a,{placement:"right",title:"Select a story",content:e,trigger:"click",children:Object(_.jsx)(m.a,{type:"default",block:!0,icon:Object(_.jsx)(S.a,{}),style:{marginBottom:12},children:"Load samples"})})}(),Object(_.jsx)(m.a,{type:"default",block:!0,icon:Object(_.jsx)(T.a,{}),style:{marginBottom:12},onClick:function(){z.devStartOver(r)},children:"dev:startover"})]})})]}),Object(_.jsx)(M,{isDrawerVisible:D,onDrawerClose:function(){L(!1)}})]})},te=n(32),ne=(n(303),u.a.Header),ae=s.a.Title,re=s.a.Text,ce=function(){var e=Object(te.useLiveQuery)((function(){return G.stories.where("id").equals(1).first()}));return void 0===e?null:Object(_.jsxs)(ne,{className:"story-title",children:[Object(_.jsxs)(ae,{level:4,children:["RPG-SP: ",e.title]}),Object(_.jsxs)(re,{type:"secondary",children:["Version: ",e.version]})]})},ie=n.p+"static/media/jake-reading.fddcdec6.png",oe=(n(305),u.a.Content),se=s.a.Text,le=function(){return Object(_.jsxs)(oe,{className:"empty-project-page",children:[Object(_.jsx)("img",{src:ie,alt:"Start a new story"}),Object(_.jsx)(se,{children:"Create a new story or load an existing one"})]})},ue=n(176),de=(n(306),n(408)),je=n(409),be=function(e){var t=e.isDrawerVisible,n=e.onDrawerClose,r=Object(a.useContext)(B),c=Object(o.a)(r,2)[1],i=R.a.useForm(),s=Object(o.a)(i,1)[0],l=Object(a.useState)(!1),u=Object(o.a)(l,2),d=u[0],j=u[1];Object(a.useEffect)((function(){t&&(s.resetFields(),b())}),[t,s]);var b=function(){j(!0)},f=function(){j(!1),n&&n()};return Object(_.jsx)(P.a,{title:"Add Custom Entity",width:360,onClose:f,visible:d,bodyStyle:{paddingBottom:20},footer:Object(_.jsxs)("div",{style:{textAlign:"right"},children:[Object(_.jsx)(m.a,{onClick:f,style:{marginRight:8},children:"Cancel"}),Object(_.jsx)(m.a,{type:"primary",htmlType:"submit",form:"create-custom-entity-id",children:"Add"})]}),children:Object(_.jsxs)(R.a,{layout:"vertical",name:"create-custom-entity",id:"create-custom-entity-id",form:s,onFinish:function(e){var t=e.name.trim(),n=e.key.trim(),a=e.singular.trim();if(""===t||""===a)return f(),void h.b.error("Do not leave empty fields, sorry :(");var r={name:t,key:n,singular:a};z.createNewCustomEntityDef(c,r).then((function(e){f(),h.b.success("New entity created!")})).catch((function(e){f(),h.b.error("Something went wrong, sorry :(")}))},requiredMark:!1,children:[Object(_.jsx)(y.a,{gutter:16,children:Object(_.jsx)(x.a,{span:24,children:Object(_.jsx)(R.a.Item,{name:"name",label:"Name (use plural)",rules:[{required:!0,message:"Please enter a name"}],children:Object(_.jsx)(I.a,{placeholder:"Please enter a name",onChange:function(e){var t=e.target.value.toLowerCase().replace(/\s/g,"");s.setFieldsValue({key:t})}})})})}),Object(_.jsx)(y.a,{gutter:16,children:Object(_.jsx)(x.a,{span:24,children:Object(_.jsx)(R.a.Item,{name:"key",label:"Key",children:Object(_.jsx)(I.a,{readOnly:!0,placeholder:""})})})}),Object(_.jsx)(y.a,{gutter:16,children:Object(_.jsx)(x.a,{span:24,children:Object(_.jsx)(R.a.Item,{name:"singular",label:"Singular",rules:[{required:!0,message:"Please enter singular entity name"}],children:Object(_.jsx)(I.a,{placeholder:"Please enter singular entity name"})})})})]})})},he=n(388),fe=n(385),pe=n(175),me=n.n(pe),Oe=(n(361),function(e){var t=e.isDrawerVisible,n=e.onDrawerClose,r=Object(a.useContext)(B),c=Object(o.a)(r,2)[1],i=Object(a.useState)(!1),s=Object(o.a)(i,2),l=s[0],u=s[1],d=Object(a.useState)({}),j=Object(o.a)(d,2),b=j[0],f=j[1],p=Object(a.useState)({}),O=Object(o.a)(p,2),g=O[0],v=O[1],w=Object(a.useState)(!0),A=Object(o.a)(w,2),C=A[0],S=A[1],E=Object(te.useLiveQuery)((function(){return G.custom_entity_defs.toArray()})),k=Object(te.useLiveQuery)((function(){return G.default_entity_colors.toArray()}));Object(a.useEffect)((function(){t&&T()}),[t]);var T=function(){f({}),v({}),u(!0)},R=function(){u(!1),n&&n()};return Object(_.jsxs)(P.a,{title:"Edit Colors",width:360,onClose:R,visible:l,bodyStyle:{paddingBottom:20},footer:Object(_.jsxs)("div",{style:{textAlign:"right"},children:[Object(_.jsx)(m.a,{onClick:R,style:{marginRight:8},children:"Cancel"}),Object(_.jsx)(m.a,{type:"primary",onClick:function(){if(S(!0),0!==Object.keys(b).length||0!==Object.keys(g).length){for(var e in b)z.updateDefaultEntityColor(c,parseInt(e),{color:b[e]}).then((function(e){})).catch((function(e){S(!1)}));for(var t in g)z.updateCustomEntityDefColor(c,parseInt(t),{color:g[t]}).then((function(e){})).catch((function(e){S(!1)}));C?(R(),h.b.success("Colors updated!")):(R(),h.b.error("Something went wrong, sorry :("))}else R()},children:"Update"})]}),children:[void 0!==k&&k.length>0&&Object(_.jsx)(he.b,{dataSource:k,renderItem:function(e){return Object(_.jsx)(he.b.Item,{className:"default-ent-color-list-item",children:Object(_.jsxs)(y.a,{style:{width:"100%"},children:[Object(_.jsx)(x.a,{span:18,style:{textTransform:"capitalize"},children:e.name}),Object(_.jsx)(x.a,{span:6,style:{textAlign:"right"},children:Object(_.jsx)(me.a,{animation:"slide-up",placement:"bottomRight",enableAlpha:!1,color:e.color,onChange:function(t){!function(e,t){var n=b;n[e]=t,f(n)}(e.id,t.color)}})})]})})}}),void 0!==E&&E.length>0&&Object(_.jsxs)(_.Fragment,{children:[Object(_.jsx)(fe.a,{style:{margin:"0"}}),Object(_.jsx)(he.b,{dataSource:E,renderItem:function(e){return Object(_.jsx)(he.b.Item,{className:"custom-ent-color-list-item",children:Object(_.jsxs)(y.a,{style:{width:"100%"},children:[Object(_.jsx)(x.a,{span:18,children:e.name}),Object(_.jsx)(x.a,{span:6,style:{textAlign:"right"},children:Object(_.jsx)(me.a,{animation:"slide-up",placement:"bottomRight",enableAlpha:!1,color:e.color,onChange:function(t){!function(e,t){var n=g;n[e]=t,v(n)}(e.id,t.color)}})})]})})}})]})]})}),ye=(n(367),function(e){var t,n=e.gameState,a=e.onEditGameStateProp,r=void 0===a?function(){}:a,c=e.onRemoveGameStateProp,i=void 0===c?function(){}:c;return t=n.type.endsWith("arr")?"[ "+n.default+" ]":"boolean"===n.type?n.default?"true":"false":n.default,Object(_.jsx)(he.b.Item,{className:"game-state-list-item",children:Object(_.jsxs)(y.a,{children:[Object(_.jsx)(x.a,{span:6,children:n.name}),Object(_.jsx)(x.a,{span:6,children:n.type}),Object(_.jsx)(x.a,{span:8,children:t}),Object(_.jsxs)(x.a,{span:4,style:{textAlign:"right"},children:["none"!==n.edit_mode&&Object(_.jsx)(m.a,{type:"link",size:"small",onClick:function(){r()},children:"Edit"}),n.removable&&Object(_.jsx)(p.a,{title:"Are you sure you want to remove this game state prop?",onConfirm:function(){i()},onCancel:function(){},okText:"Yes",cancelText:"No",placement:"bottomRight",children:Object(_.jsx)(m.a,{type:"link",size:"small",children:"Remove"})})]})]})})}),xe=n(122),ge=n(389),ve=n(397),we=I.a.TextArea,Ae=xe.a.Option,Ce=function(e){var t=e.gameStateProp,n=void 0===t?null:t,r=e.isDrawerVisible,c=e.onDrawerClose,i=Object(a.useContext)(B),s=Object(o.a)(i,2)[1],l=R.a.useForm(),u=Object(o.a)(l,1)[0],d=Object(a.useState)(!1),j=Object(o.a)(d,2),b=j[0],f=j[1],p=Object(a.useState)(""),O=Object(o.a)(p,2),g=O[0],v=O[1],w=Object(a.useState)(""),A=Object(o.a)(w,2),C=A[0],S=A[1],E=Object(a.useState)(0),k=Object(o.a)(E,2),T=k[0],N=k[1],D=Object(a.useState)(!0),L=Object(o.a)(D,2),F=L[0],V=L[1],Q=Object(a.useState)(""),q=Object(o.a)(Q,2),U=q[0],M=q[1],X=Object(a.useState)(!0),J=Object(o.a)(X,2),Z=J[0],W=J[1],H=Object(te.useLiveQuery)((function(){return G.custom_entity_defs.toArray()}));Object(a.useEffect)((function(){r&&(u.resetFields(),S(""),n&&(u.setFieldsValue({name:n.name,type:n.type}),S(n.type),function(e){if(C.endsWith("arr")){if(0===e.length)return;var t=e.split(",");switch(C){case"intarr":case"booleanarr":u.setFieldsValue({defaultValueArray:t.join("\n")});break;case"stringarr":case"locationarr":case"areaarr":case"characterarr":default:var n,a=[],r=Object(K.a)(t);try{for(r.s();!(n=r.n()).done;){var c=n.value;a.push(c.slice(1,-1))}}catch(i){r.e(i)}finally{r.f()}u.setFieldsValue({defaultValueArray:a.join("\n")})}}else switch(C){case"int":u.setFieldsValue({defaultValueInt:e});break;case"boolean":u.setFieldsValue({defaultValueBool:e}),V(e);break;case"string":case"location":case"area":case"character":default:u.setFieldsValue({defaultValueString:e})}}(n.default)),$())}),[r,u,n]);var $=function(){f(!0)},ee=function(){f(!1),c&&c()},ne=function(){return""!==C&&"int"!==C&&"boolean"!==C&&!C.endsWith("arr")},ae=function(){var e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];switch(C){case"intarr":return e?"int[]":"Place one integer per line";case"booleanarr":return e?"boolean[]":"Place one boolean per line";case"stringarr":return e?"string[]":"Place one string per line";case"locationarr":return e?"location[]":"Place one location per line";case"areaarr":return e?"area[]":"Place one area per line";case"characterarr":return e?"character[]":"Place one character per line";default:if(C.endsWith("arr")){var t=C.slice(0,-3);return e?t+"[]":"Place one "+t+" per line"}return e?"[]":"Place one item per line"}},re=function(e){var t=e.defaultValueArray;if(0===t.length)ce(e);else{var n=t.split("\n");switch(C){case"intarr":var a,r=Object(K.a)(n);try{for(r.s();!(a=r.n()).done;){var c=a.value;if(!Number.isInteger(parseInt(c)))return void h.b.error("All values in array must be integers")}}catch(b){r.e(b)}finally{r.f()}ce(e);break;case"booleanarr":var i,o=Object(K.a)(n);try{for(o.s();!(i=o.n()).done;){var s=i.value;if("true"!==s&&"false"!==s)return void h.b.error('All values in array must be "true" or "false"')}}catch(b){o.e(b)}finally{o.f()}ce(e);break;case"stringarr":var l,u=Object(K.a)(n);try{for(u.s();!(l=u.n()).done;){if(""===l.value.trim())return void h.b.error("Do not leave empty strings (just spaces are considered empty)")}}catch(b){u.e(b)}finally{u.f()}ce(e);break;case"locationarr":Y.validateEntityNames(n,G.locations).then((function(){ce(e)})).catch((function(e){h.b.error("Invalid values: "+e.join(", "))}));break;case"areaarr":Y.validateEntityNames(n,G.areas).then((function(){ce(e)})).catch((function(e){h.b.error("Invalid values: "+e.join(", "))}));break;case"characterarr":Y.validateEntityNames(n,G.characters).then((function(){ce(e)})).catch((function(e){h.b.error("Invalid values: "+e.join(", "))}));break;default:var d=C.slice(0,-3),j=H.find((function(e){return e.singular_name===d}));j&&Y.validateCustomEntityNames(n,j.id).then((function(){ce(e)})).catch((function(e){h.b.error("Invalid values: "+e.join(", "))}))}}},ce=function(e){if(null===n){var t=e.name.trim(),a=ie(e),r={name:t,type:C,defaultValue:a,editMode:"name|default",removable:!0};z.createNewGameStateProp(s,r).then((function(e){ee(),h.b.success("New game state prop created!")})).catch((function(e){ee(),h.b.error("Something went wrong, sorry :(")}))}else{var c=e.name.trim(),i=ie(e),o=n.edit_mode,l=n.removable,u={name:c,type:C,defaultValue:i,editMode:o,removable:l};z.updateGameStateProp(s,n.id,u).then((function(e){ee(),h.b.success("Game state prop edited!")})).catch((function(e){ee(),h.b.error("Something went wrong, sorry :(")}))}},ie=function(e){if(C.endsWith("arr")){var t=e.defaultValueArray;if(0===t.length)return"";var n=t.split("\n");switch(C){case"intarr":case"booleanarr":return n.join(",");case"stringarr":case"locationarr":case"areaarr":case"characterarr":default:var a,r=[],c=Object(K.a)(n);try{for(c.s();!(a=c.n()).done;){var i=a.value;r.push('"'+i+'"')}}catch(o){c.e(o)}finally{c.f()}return r.join(",")}}else switch(C){case"int":return parseInt(e.defaultValueInt);case"boolean":return e.defaultValueBool;case"string":case"location":case"area":case"character":default:return e.defaultValueString}},oe=function(){if(null===n)return!1;var e=n.edit_mode.split("|");return e.indexOf("all")<0&&e.indexOf("default")<0};return Object(_.jsx)(P.a,{title:null===n?"New prop":"Edit prop",width:360,onClose:ee,visible:b,bodyStyle:{paddingBottom:20},footer:Object(_.jsxs)("div",{style:{textAlign:"right"},children:[Object(_.jsx)(m.a,{onClick:ee,style:{marginRight:8},children:"Cancel"}),Object(_.jsx)(m.a,{type:"primary",htmlType:"submit",form:"add-edit-game-state-prop-id",children:null===n?"Create":"Update"})]}),children:Object(_.jsxs)(R.a,{layout:"vertical",name:"add-edit-game-state-prop",id:"add-edit-game-state-prop-id",form:u,onFinish:function(e){if(""!==e.name.trim())switch(C){case"int":Number.isInteger(parseInt(e.defaultValueInt))?ce(e):h.b.error("Default is not an integer");break;case"boolean":case"string":ce(e);break;case"location":var t=e.defaultValueString.trim();Y.validateEntityNames([t],G.locations).then((function(){ce(e)})).catch((function(e){h.b.error("Invalid values: "+e.join(", "))}));break;case"area":var n=e.defaultValueString.trim();Y.validateEntityNames([n],G.areas).then((function(){ce(e)})).catch((function(e){h.b.error("Invalid values: "+e.join(", "))}));break;case"character":var a=e.defaultValueString.trim();Y.validateEntityNames([a],G.characters).then((function(){ce(e)})).catch((function(e){h.b.error("Invalid values: "+e.join(", "))}));break;default:if(C.endsWith("arr"))re(e);else if("boolean"!==C&&"string"!==C){var r=H.find((function(e){return e.singular_name===C}));if(r){var c=e.defaultValueString.trim();Y.validateCustomEntityNames([c],r.id).then((function(){ce(e)})).catch((function(e){h.b.error("Invalid values: "+e.join(", "))}))}}}else h.b.error("Do not leave name empty")},requiredMark:!1,children:[Object(_.jsx)(y.a,{gutter:16,children:Object(_.jsx)(x.a,{span:24,children:Object(_.jsx)(R.a.Item,{name:"name",label:"Name",rules:[{required:!0,message:"Please enter a name"}],children:Object(_.jsx)(I.a,{placeholder:"Please enter a name",value:g,onChange:function(e){v(e.target.value)},disabled:function(){if(null===n)return!1;var e=n.edit_mode.split("|");return e.indexOf("all")<0&&e.indexOf("name")<0}()})})})}),Object(_.jsx)(y.a,{gutter:16,children:Object(_.jsx)(x.a,{span:24,children:Object(_.jsx)(R.a.Item,{name:"type",label:"Type",rules:[{required:!0,message:"Please select a type"}],children:Object(_.jsxs)(xe.a,{value:C,onChange:function(e){var t;"int"===(t=e)&&u.setFieldsValue({defaultValueInt:""}),"boolean"===t&&u.setFieldsValue({defaultValueBool:F}),t.endsWith("arr")&&u.setFieldsValue({defaultValueArray:""}),""===t||"int"===t||"boolean"===t||t.endsWith("arr")||u.setFieldsValue({defaultValueString:""}),S(t)},disabled:function(){if(null===n)return!1;var e=n.edit_mode.split("|");return e.indexOf("all")<0&&e.indexOf("type")<0}(),children:[Object(_.jsx)(Ae,{value:"int",children:"int"}),Object(_.jsx)(Ae,{value:"intarr",children:"int[]"}),Object(_.jsx)(Ae,{value:"boolean",children:"boolean"}),Object(_.jsx)(Ae,{value:"booleanarr",children:"boolean[]"}),Object(_.jsx)(Ae,{value:"string",children:"string"}),Object(_.jsx)(Ae,{value:"stringarr",children:"string[]"}),Object(_.jsx)(Ae,{value:"location",children:"location"}),Object(_.jsx)(Ae,{value:"locationarr",children:"location[]"}),Object(_.jsx)(Ae,{value:"area",children:"area"}),Object(_.jsx)(Ae,{value:"areaarr",children:"area[]"}),Object(_.jsx)(Ae,{value:"character",children:"character"}),Object(_.jsx)(Ae,{value:"characterarr",children:"character[]"}),void 0!==H&&H.map((function(e){return Object(_.jsxs)(a.Fragment,{children:[Object(_.jsx)(Ae,{value:e.singular_name,children:e.singular_name}),Object(_.jsxs)(Ae,{value:e.singular_name+"arr",children:[e.singular_name,"[]"]})]},e.singular_name)}))]})})})}),Object(_.jsx)(y.a,{gutter:16,style:{display:"int"===C?"block":"none"},children:Object(_.jsx)(x.a,{span:24,children:Object(_.jsx)(R.a.Item,{name:"defaultValueInt",label:"Default value (int)",rules:[{required:"int"===C,message:"Please enter an integer"}],children:Object(_.jsx)(ge.a,{disabled:oe(),placeholder:"Please enter an integer",value:T,onChange:function(e){N(e)},style:{width:"100%"}})})})}),Object(_.jsx)(y.a,{gutter:16,style:{display:"boolean"===C?"block":"none"},children:Object(_.jsx)(x.a,{span:24,children:Object(_.jsx)(R.a.Item,{name:"defaultValueBool",label:"Default value (boolean)",children:Object(_.jsx)(ve.a,{disabled:oe(),checkedChildren:"true",unCheckedChildren:"false",checked:F,defaultChecked:!0,onChange:function(e){V(e)}})})})}),Object(_.jsx)(y.a,{gutter:16,style:{display:ne()?"block":"none"},children:Object(_.jsx)(x.a,{span:24,children:Object(_.jsx)(R.a.Item,{name:"defaultValueString",label:"Default value (string)",rules:[{required:ne()&&"string"!==C,message:"Please enter a default value"}],children:Object(_.jsx)(I.a,{disabled:oe(),placeholder:"Please enter a default value",value:U,onChange:function(e){M(e.target.value)}})})})}),Object(_.jsx)(y.a,{gutter:16,style:{display:C.endsWith("arr")?"block":"none"},children:Object(_.jsx)(x.a,{span:24,children:Object(_.jsx)(R.a.Item,{name:"defaultValueArray",label:"Default value ("+ae()+")",children:Object(_.jsx)(we,{disabled:oe(),rows:10,placeholder:ae(!1)+" Leave empty for empty array.",value:Z,onChange:function(e){W(e.target.value)}})})})})]})})},Se=s.a.Text,Ee=function(){var e=Object(a.useContext)(B),t=Object(o.a)(e,2)[1],n=Object(a.useState)(!1),r=Object(o.a)(n,2),c=r[0],i=r[1],s=Object(a.useState)(null),l=Object(o.a)(s,2),u=l[0],d=l[1],j=Object(te.useLiveQuery)((function(){return G.game_state_props.toArray()})),b=Object(_.jsxs)(y.a,{children:[Object(_.jsx)(x.a,{span:6,children:Object(_.jsx)(Se,{strong:!0,children:"Name"})}),Object(_.jsx)(x.a,{span:6,children:Object(_.jsx)(Se,{strong:!0,children:"Type"})}),Object(_.jsx)(x.a,{span:8,children:Object(_.jsx)(Se,{strong:!0,children:"Default"})}),Object(_.jsx)(x.a,{span:4})]});return Object(_.jsxs)("div",{children:[void 0!==j&&j.length>0&&Object(_.jsx)(he.b,{style:{marginBottom:"20px",maxWidth:"94%"},header:b,dataSource:j,renderItem:function(e){return Object(_.jsx)(ye,{gameState:e,onEditGameStateProp:function(){d(e),i(!0)},onRemoveGameStateProp:function(){var n;n=e,z.deleteGameStateProp(t,n.id).then((function(e){h.b.success("Game state prop removed!")})).catch((function(e){h.b.error("Something went wrong, sorry :(")}))}})}}),Object(_.jsx)(m.a,{type:"primary",onClick:function(){d(null),i(!0)},children:"Add Game State Prop"}),Object(_.jsx)(Ce,{gameStateProp:u,isDrawerVisible:c,onDrawerClose:function(){i(!1)}})]})},ke=n(395),Te=(n(368),s.a.Text),Re=function(e){var t=e.location,n=e.canEdit,a=void 0===n||n,r=e.canRemove,c=void 0===r||r,i=e.onRemove,o=void 0===i?function(){}:i,s=e.onEdit,l=void 0===s?function(){}:s,u=e.onAddArea,d=void 0===u?function(){}:u,j=e.onEditArea,b=void 0===j?function(){}:j,h=e.onRemoveArea,f=void 0===h?function(){}:h,O=Object(te.useLiveQuery)((function(){return G.areas.where("location_id").equals(t.id).toArray()})),g=[];a&&g.push(Object(_.jsx)(m.a,{type:"link",size:"small",onClick:l,children:"Edit"},"edit-location")),c&&g.push(Object(_.jsx)(p.a,{title:"Are you sure you want to remove this location and all its areas?",onConfirm:o,onCancel:function(){},okText:"Yes",cancelText:"No",placement:"bottomRight",children:Object(_.jsx)(m.a,{type:"link",size:"small",children:"Remove"})},"remove-location"));var v=Object(_.jsxs)(y.a,{children:[Object(_.jsx)(x.a,{span:6,children:Object(_.jsx)(Te,{strong:!0,children:"Area Name"})}),Object(_.jsx)(x.a,{span:12,children:Object(_.jsx)(Te,{strong:!0,children:"Description"})}),Object(_.jsx)(x.a,{span:6})]});return Object(_.jsxs)(ke.a,{className:"location-view",size:"small",title:t.name,extra:g,headStyle:{background:"#f5f5f5"},children:[Object(_.jsx)(Te,{children:t.description}),Object(_.jsx)(fe.a,{}),void 0!==O&&O.length>0&&Object(_.jsx)(he.b,{header:v,dataSource:O,renderItem:function(e){return Object(_.jsx)(he.b.Item,{className:"area-list-item",children:Object(_.jsxs)(y.a,{children:[Object(_.jsx)(x.a,{span:6,children:e.name}),Object(_.jsx)(x.a,{span:12,children:e.description}),Object(_.jsxs)(x.a,{span:6,style:{textAlign:"right"},children:[Object(_.jsx)(m.a,{type:"link",size:"small",onClick:function(){b(e)},children:"Edit"}),Object(_.jsx)(p.a,{title:"Are you sure you want to remove this area?",onConfirm:function(){f(e)},onCancel:function(){},okText:"Yes",cancelText:"No",placement:"bottomRight",children:Object(_.jsx)(m.a,{type:"link",size:"small",children:"Remove"})})]})]})})}}),Object(_.jsx)(m.a,{type:"default",size:"small",onClick:d,children:"Add Area"})]})},Pe=I.a.TextArea,Ie=function(e){var t=e.location,n=void 0===t?null:t,r=e.isDrawerVisible,c=e.onDrawerClose,i=Object(a.useContext)(B),s=Object(o.a)(i,2)[1],l=R.a.useForm(),u=Object(o.a)(l,1)[0],d=Object(a.useState)(!1),j=Object(o.a)(d,2),b=j[0],f=j[1],p=Object(a.useState)(""),O=Object(o.a)(p,2),g=O[0],v=O[1],w=Object(a.useState)(""),A=Object(o.a)(w,2),C=A[0],S=A[1];Object(a.useEffect)((function(){r&&(u.resetFields(),n&&u.setFieldsValue({name:n.name,description:n.description}),E())}),[r,u,n]);var E=function(){f(!0)},k=function(){f(!1),c&&c()};return Object(_.jsx)(P.a,{title:null===n?"New location":"Edit location",width:360,onClose:k,visible:b,bodyStyle:{paddingBottom:20},footer:Object(_.jsxs)("div",{style:{textAlign:"right"},children:[Object(_.jsx)(m.a,{onClick:k,style:{marginRight:8},children:"Cancel"}),Object(_.jsx)(m.a,{type:"primary",htmlType:"submit",form:"add-edit-location-id",children:null===n?"Create":"Update"})]}),children:Object(_.jsxs)(R.a,{layout:"vertical",name:"add-edit-location",id:"add-edit-location-id",form:u,onFinish:function(e){var t=e.name.trim(),a=e.description.trim();if(""===t||""===a)return k(),void h.b.error("Do not leave empty fields, sorry :(");var r={name:t,description:a};null===n?z.createNewLocation(s,r).then((function(e){k(),h.b.success("New location created!")})).catch((function(e){k(),h.b.error("Something went wrong, sorry :(")})):z.updateLocation(s,n.id,r).then((function(e){k(),h.b.success("Location edited!")})).catch((function(e){k(),h.b.error("Something went wrong, sorry :(")}))},requiredMark:!1,children:[Object(_.jsx)(y.a,{gutter:16,children:Object(_.jsx)(x.a,{span:24,children:Object(_.jsx)(R.a.Item,{name:"name",label:"Name",rules:[{required:!0,message:"Please enter a name"}],children:Object(_.jsx)(I.a,{placeholder:"Please enter a name",value:g,onChange:function(e){v(e.target.value)}})})})}),Object(_.jsx)(y.a,{gutter:16,children:Object(_.jsx)(x.a,{span:24,children:Object(_.jsx)(R.a.Item,{name:"description",label:"Description",rules:[{required:!0,message:"Please enter a description"}],children:Object(_.jsx)(Pe,{rows:10,placeholder:"Please enter a description",value:C,onChange:function(e){S(e.target.value)}})})})})]})})},Ne=I.a.TextArea,De=function(e){var t=e.area,n=void 0===t?null:t,r=e.location,c=e.isDrawerVisible,i=e.onDrawerClose,s=Object(a.useContext)(B),l=Object(o.a)(s,2)[1],u=R.a.useForm(),d=Object(o.a)(u,1)[0],j=Object(a.useState)(!1),b=Object(o.a)(j,2),f=b[0],p=b[1],O=Object(a.useState)(""),g=Object(o.a)(O,2),v=g[0],w=g[1],A=Object(a.useState)(""),C=Object(o.a)(A,2),S=C[0],E=C[1];Object(a.useEffect)((function(){c&&(d.resetFields(),n&&d.setFieldsValue({name:n.name,description:n.description}),k())}),[c,d,n]);var k=function(){p(!0)},T=function(){p(!1),i&&i()};return Object(_.jsx)(P.a,{title:(null===n?"New area":"Edit area")+" in "+(r&&r.name),width:360,onClose:T,visible:f,bodyStyle:{paddingBottom:20},footer:Object(_.jsxs)("div",{style:{textAlign:"right"},children:[Object(_.jsx)(m.a,{onClick:T,style:{marginRight:8},children:"Cancel"}),Object(_.jsx)(m.a,{type:"primary",htmlType:"submit",form:"add-edit-area-id",children:null===n?"Create":"Update"})]}),children:Object(_.jsxs)(R.a,{layout:"vertical",name:"add-edit-area",id:"add-edit-area-id",form:d,onFinish:function(e){var t=e.name.trim(),a=e.description.trim();if(""===t||""===a)return T(),void h.b.error("Do not leave empty fields, sorry :(");var c={name:t,description:a};null===n?(c.location_id=r.id,z.createNewArea(l,c).then((function(e){T(),h.b.success("New area created!")})).catch((function(e){T(),h.b.error("Something went wrong, sorry :(")}))):z.updateArea(l,n.id,c).then((function(e){T(),h.b.success("Area edited!")})).catch((function(e){T(),h.b.error("Something went wrong, sorry :(")}))},requiredMark:!1,children:[Object(_.jsx)(y.a,{gutter:16,children:Object(_.jsx)(x.a,{span:24,children:Object(_.jsx)(R.a.Item,{name:"name",label:"Name",rules:[{required:!0,message:"Please enter a name"}],children:Object(_.jsx)(I.a,{placeholder:"Please enter a name",value:v,onChange:function(e){w(e.target.value)}})})})}),Object(_.jsx)(y.a,{gutter:16,children:Object(_.jsx)(x.a,{span:24,children:Object(_.jsx)(R.a.Item,{name:"description",label:"Description",rules:[{required:!0,message:"Please enter a description"}],children:Object(_.jsx)(Ne,{rows:10,placeholder:"Please enter a description",value:S,onChange:function(e){E(e.target.value)}})})})})]})})},_e=function(){var e=Object(a.useContext)(B),t=Object(o.a)(e,2)[1],n=Object(a.useState)(!1),r=Object(o.a)(n,2),c=r[0],i=r[1],s=Object(a.useState)(!1),l=Object(o.a)(s,2),u=l[0],d=l[1],j=Object(a.useState)(null),b=Object(o.a)(j,2),f=b[0],p=b[1],O=Object(a.useState)(null),y=Object(o.a)(O,2),x=y[0],g=y[1],v=Object(te.useLiveQuery)((function(){return G.locations.toArray()}));return Object(_.jsxs)("div",{children:[void 0!==v&&v.map((function(e){return Object(_.jsx)(Re,{location:e,onRemove:function(){!function(e){z.deleteLocation(t,e.id).then((function(e){h.b.success("Location removed!")})).catch((function(e){h.b.error("Something went wrong, sorry :(")}))}(e)},onEdit:function(){!function(e){p(e),i(!0)}(e)},onAddArea:function(){!function(e){g(null),p(e),d(!0)}(e)},onEditArea:function(t){!function(e,t){p(t),g(e),d(!0)}(t,e)},onRemoveArea:function(e){!function(e){z.deleteArea(t,e.id).then((function(e){h.b.success("Area removed!")})).catch((function(e){h.b.error("Something went wrong, sorry :(")}))}(e)}},e.id)})),Object(_.jsx)(m.a,{type:"primary",onClick:function(){p(null),i(!0)},children:"Add Location"}),Object(_.jsx)(Ie,{location:f,isDrawerVisible:c,onDrawerClose:function(){i(!1)}}),Object(_.jsx)(De,{area:x,location:f,isDrawerVisible:u,onDrawerClose:function(){d(!1)}})]})},Le=(n(369),s.a.Text),Be=function(e){var t=e.entity,n=e.entityName,a=void 0===n?"entity":n,r=e.canEdit,c=void 0===r||r,i=e.canRemove,o=void 0===i||i,s=e.onRemove,l=void 0===s?function(){}:s,u=e.onEdit,d=void 0===u?function(){}:u,j=[];return c&&j.push(Object(_.jsx)(m.a,{type:"link",size:"small",onClick:d,children:"Edit"},"edit-entity")),o&&j.push(Object(_.jsx)(p.a,{title:"Are you sure you want to remove this ".concat(a,"?"),onConfirm:l,onCancel:function(){},okText:"Yes",cancelText:"No",placement:"bottomRight",children:Object(_.jsx)(m.a,{type:"link",size:"small",children:"Remove"})},"remove-entity")),Object(_.jsx)(ke.a,{className:"simple-entity-view",size:"small",title:t.name,extra:j,headStyle:{background:"#f5f5f5"},children:Object(_.jsx)(Le,{children:t.description})})},Fe=I.a.TextArea,Ve=function(e){var t=e.character,n=void 0===t?null:t,r=e.isDrawerVisible,c=e.onDrawerClose,i=Object(a.useContext)(B),s=Object(o.a)(i,2)[1],l=R.a.useForm(),u=Object(o.a)(l,1)[0],d=Object(a.useState)(!1),j=Object(o.a)(d,2),b=j[0],f=j[1],p=Object(a.useState)(""),O=Object(o.a)(p,2),g=O[0],v=O[1],w=Object(a.useState)(""),A=Object(o.a)(w,2),C=A[0],S=A[1];Object(a.useEffect)((function(){r&&(u.resetFields(),n&&u.setFieldsValue({name:n.name,description:n.description}),E())}),[r,u,n]);var E=function(){f(!0)},k=function(){f(!1),c&&c()};return Object(_.jsx)(P.a,{title:null===n?"New character":"Edit character",width:360,onClose:k,visible:b,bodyStyle:{paddingBottom:20},footer:Object(_.jsxs)("div",{style:{textAlign:"right"},children:[Object(_.jsx)(m.a,{onClick:k,style:{marginRight:8},children:"Cancel"}),Object(_.jsx)(m.a,{type:"primary",htmlType:"submit",form:"add-edit-character-id",children:null===n?"Create":"Update"})]}),children:Object(_.jsxs)(R.a,{layout:"vertical",name:"add-edit-character",id:"add-edit-character-id",form:u,onFinish:function(e){var t=e.name.trim(),a=e.description.trim();if(""===t||""===a)return k(),void h.b.error("Do not leave empty fields, sorry :(");var r={name:t,description:a};null===n?z.createNewCharacter(s,r).then((function(e){k(),h.b.success("New character created!")})).catch((function(e){k(),h.b.error("Something went wrong, sorry :(")})):z.updateCharacter(s,n.id,r).then((function(e){k(),h.b.success("Character edited!")})).catch((function(e){k(),h.b.error("Something went wrong, sorry :(")}))},requiredMark:!1,children:[Object(_.jsx)(y.a,{gutter:16,children:Object(_.jsx)(x.a,{span:24,children:Object(_.jsx)(R.a.Item,{name:"name",label:"Name",rules:[{required:!0,message:"Please enter a name"}],children:Object(_.jsx)(I.a,{placeholder:"Please enter a name",value:g,onChange:function(e){v(e.target.value)}})})})}),Object(_.jsx)(y.a,{gutter:16,children:Object(_.jsx)(x.a,{span:24,children:Object(_.jsx)(R.a.Item,{name:"description",label:"Description",rules:[{required:!0,message:"Please enter a description"}],children:Object(_.jsx)(Fe,{rows:10,placeholder:"Please enter a description",value:C,onChange:function(e){S(e.target.value)}})})})})]})})},Qe=function(){var e=Object(a.useContext)(B),t=Object(o.a)(e,2)[1],n=Object(a.useState)(!1),r=Object(o.a)(n,2),c=r[0],i=r[1],s=Object(a.useState)(null),l=Object(o.a)(s,2),u=l[0],d=l[1],j=Object(te.useLiveQuery)((function(){return G.characters.toArray()}));return Object(_.jsxs)("div",{children:[void 0!==j&&j.map((function(e){return Object(_.jsx)(Be,{entity:e,entityName:"character",onRemove:function(){!function(e){z.deleteCharacter(t,e.id).then((function(e){h.b.success("Character removed!")})).catch((function(e){h.b.error("Something went wrong, sorry :(")}))}(e)},onEdit:function(){!function(e){d(e),i(!0)}(e)}},e.id)})),Object(_.jsx)(m.a,{type:"primary",onClick:function(){d(null),i(!0)},children:"Add Character"}),Object(_.jsx)(Ve,{character:u,isDrawerVisible:c,onDrawerClose:function(){i(!1)}})]})},qe=I.a.TextArea,Ge=function(e){var t=e.entity,n=void 0===t?null:t,r=e.entityDef,c=e.isDrawerVisible,i=e.onDrawerClose,s=Object(a.useContext)(B),l=Object(o.a)(s,2)[1],u=R.a.useForm(),d=Object(o.a)(u,1)[0],j=Object(a.useState)(!1),b=Object(o.a)(j,2),f=b[0],p=b[1],O=Object(a.useState)(""),g=Object(o.a)(O,2),v=g[0],w=g[1],A=Object(a.useState)(""),C=Object(o.a)(A,2),S=C[0],E=C[1],k=r.singular_name.toLowerCase().charAt(0).toUpperCase()+r.singular_name.toLowerCase().slice(1);Object(a.useEffect)((function(){c&&(d.resetFields(),n&&d.setFieldsValue({name:n.name,description:n.description}),T())}),[c,d,n]);var T=function(){p(!0)},N=function(){p(!1),i&&i()};return Object(_.jsx)(P.a,{title:(null===n?"New":"Edit")+" "+r.singular_name.toLowerCase(),width:360,onClose:N,visible:f,bodyStyle:{paddingBottom:20},footer:Object(_.jsxs)("div",{style:{textAlign:"right"},children:[Object(_.jsx)(m.a,{onClick:N,style:{marginRight:8},children:"Cancel"}),Object(_.jsx)(m.a,{type:"primary",htmlType:"submit",form:"add-edit-custom-entity-id-"+r.key,children:null===n?"Create":"Update"})]}),children:Object(_.jsxs)(R.a,{layout:"vertical",name:"add-edit-custom-entity-"+r.key,id:"add-edit-custom-entity-id-"+r.key,form:d,onFinish:function(e){!function(e){var t=e.name.trim(),a=e.description.trim();if(""===t||""===a)return N(),void h.b.error("Do not leave empty fields, sorry :(");var c={name:t,description:a};null===n?(c.custom_entity_def_id=r.id,z.createNewCustomEntity(l,c).then((function(e){N(),h.b.success("New "+r.singular_name.toLowerCase()+" created!")})).catch((function(e){N(),h.b.error("Something went wrong, sorry :(")}))):z.updateCustomEntity(l,n.id,c).then((function(e){N(),h.b.success(k+" edited!")})).catch((function(e){N(),h.b.error("Something went wrong, sorry :(")}))}(e)},requiredMark:!1,children:[Object(_.jsx)(y.a,{gutter:16,children:Object(_.jsx)(x.a,{span:24,children:Object(_.jsx)(R.a.Item,{name:"name",label:"Name",rules:[{required:!0,message:"Please enter a name"}],children:Object(_.jsx)(I.a,{placeholder:"Please enter a name",value:v,onChange:function(e){w(e.target.value)}})})})}),Object(_.jsx)(y.a,{gutter:16,children:Object(_.jsx)(x.a,{span:24,children:Object(_.jsx)(R.a.Item,{name:"description",label:"Description",rules:[{required:!0,message:"Please enter a description"}],children:Object(_.jsx)(qe,{rows:10,placeholder:"Please enter a description",value:S,onChange:function(e){E(e.target.value)}})})})})]})})},Ue=function(e){var t=e.entityDef,n=Object(a.useContext)(B),r=Object(o.a)(n,2)[1],c=t.singular_name.toLowerCase().charAt(0).toUpperCase()+t.singular_name.toLowerCase().slice(1),i=Object(a.useState)(!1),s=Object(o.a)(i,2),l=s[0],u=s[1],d=Object(a.useState)(null),j=Object(o.a)(d,2),b=j[0],f=j[1],O=Object(te.useLiveQuery)((function(){return G.custom_entities.where("custom_entity_def_id").equals(t.id).toArray()}));return Object(_.jsxs)("div",{children:[Object(_.jsx)("div",{style:{textAlign:"right",marginBottom:"20px"},children:Object(_.jsx)(p.a,{title:"This section and all its content will be removed!! Are you sure you want to remove this entity?",onConfirm:function(){z.deleteCustomEntityDef(r,t.id).then((function(e){h.b.success(t.name+" removed!")})).catch((function(e){h.b.error("Something went wrong, sorry :(")}))},onCancel:function(){},okText:"Yes",cancelText:"No",placement:"bottomRight",children:Object(_.jsx)(m.a,{type:"default",danger:!0,children:"Remove entity"})},"remove-entity-def")}),void 0!==O&&O.map((function(e){return Object(_.jsx)(Be,{entity:e,entityName:t.singular_name.toLowerCase(),onRemove:function(){!function(e){z.deleteCustomEntity(r,e.id).then((function(e){h.b.success(c+" removed!")})).catch((function(e){h.b.error("Something went wrong, sorry :(")}))}(e)},onEdit:function(){!function(e){f(e),u(!0)}(e)}},e.id)})),Object(_.jsxs)(m.a,{type:"primary",onClick:function(){f(null),u(!0)},children:["Add ",c]}),Object(_.jsx)(Ge,{entity:b,entityDef:t,isDrawerVisible:l,onDrawerClose:function(){u(!1)}})]})},ze=u.a.Content,Me=ue.a.TabPane,Ke=function(){var e=Object(a.useState)(!1),t=Object(o.a)(e,2),n=t[0],r=t[1],c=Object(a.useState)(!1),i=Object(o.a)(c,2),s=i[0],l=i[1],u=Object(te.useLiveQuery)((function(){return G.custom_entity_defs.toArray()})),d=Object(_.jsx)(m.a,{size:"small",icon:Object(_.jsx)(de.a,{}),onClick:function(){r(!0)},children:"Add entity"},"add-custom"),j=[Object(_.jsx)(m.a,{size:"small",icon:Object(_.jsx)(je.a,{}),style:{marginRight:"4px"},onClick:function(){l(!0)},children:"Colors"},"edit-colors"),d];return Object(_.jsxs)(_.Fragment,{children:[Object(_.jsx)(ze,{className:"config-page",children:Object(_.jsxs)(ue.a,{type:"card",size:"small",tabBarExtraContent:j,children:[Object(_.jsx)(Me,{tab:"Game State",children:Object(_.jsx)(Ee,{})},"1"),Object(_.jsx)(Me,{tab:"Locations",children:Object(_.jsx)(_e,{})},"2"),Object(_.jsx)(Me,{tab:"Characters",children:Object(_.jsx)(Qe,{})},"3"),void 0!==u&&u.map((function(e,t){return Object(_.jsx)(Me,{tab:e.name,children:Object(_.jsx)(Ue,{entityDef:e})},t+4)}))]})}),Object(_.jsx)(be,{isDrawerVisible:n,onDrawerClose:function(){r(!1)}}),Object(_.jsx)(Oe,{isDrawerVisible:s,onDrawerClose:function(){l(!1)}})]})},Ye=(n(370),n(391)),Xe=n(410),Je=n(411),Ze=(n(371),s.a.Text),We=function(e){var t=e.act,n=e.actIndex,a=void 0===n?null:n,r=e.totalActs,c=void 0===r?0:r,i=e.canEdit,o=void 0===i||i,s=e.canRemove,l=void 0===s||s,u=e.onRemove,d=void 0===u?function(){}:u,j=e.onEdit,b=void 0===j?function(){}:j,h=e.onMoveOrderUp,f=void 0===h?function(){}:h,O=e.onMoveOrderDown,y=void 0===O?function(){}:O,x=[];x.push(Object(_.jsx)(Ze,{type:"success",style:{marginRight:"24px"},children:"interactive"===t.type?"Interactive":"Sequence"},"act-type")),x.push(Object(_.jsx)(m.a,{type:"default",icon:Object(_.jsx)(Xe.a,{}),size:"small",style:{marginRight:"4px"},disabled:0===a,onClick:f},"move-up")),x.push(Object(_.jsx)(m.a,{type:"default",icon:Object(_.jsx)(Je.a,{}),size:"small",style:{marginRight:"24px"},disabled:a===c-1,onClick:y},"move-down")),o&&x.push(Object(_.jsx)(m.a,{type:"link",size:"small",onClick:b,children:"Edit"},"edit-act")),l&&x.push(Object(_.jsx)(p.a,{title:function(){return Object(_.jsxs)("p",{children:["Are you sure you want to remove this act?",Object(_.jsx)("br",{}),"All sequence actions and end conditions associated will be removed."]})},onConfirm:d,onCancel:function(){},okText:"Yes",cancelText:"No",placement:"bottomRight",children:Object(_.jsx)(m.a,{type:"link",size:"small",children:"Remove"})},"remove-act"));var g="Act "+t.order+": "+t.name;return Object(_.jsxs)(ke.a,{className:"act-view",size:"small",title:g,extra:x,headStyle:{background:"#d9d9d9"},children:[Object(_.jsx)(Ze,{children:t.description}),Object(_.jsx)(fe.a,{}),"interactive"===t.type?Object(_.jsx)(Ze,{strong:!0,children:"This act ends when:"}):Object(_.jsx)(Ze,{strong:!0,children:"This act contains ## steps"})]})},He=(n(372),s.a.Text),$e=Ye.a.Panel,et=function(e){var t=e.chapter,n=e.chapterIndex,r=void 0===n?null:n,c=e.totalChapters,i=void 0===c?0:c,s=e.canEdit,l=void 0===s||s,u=e.canRemove,d=void 0===u||u,j=e.onRemove,b=void 0===j?function(){}:j,f=e.onEdit,O=void 0===f?function(){}:f,y=e.onMoveOrderUp,x=void 0===y?function(){}:y,g=e.onMoveOrderDown,v=void 0===g?function(){}:g,w=e.onAddAct,A=void 0===w?function(){}:w,C=e.onEditAct,S=void 0===C?function(){}:C,E=e.onRemoveAct,k=void 0===E?function(){}:E,T=Object(a.useContext)(B),R=Object(o.a)(T,2)[1],P=Object(te.useLiveQuery)((function(){return G.acts.where("chapter_id").equals(t.id).toArray()})),I=[];I.push(Object(_.jsx)(m.a,{type:"default",icon:Object(_.jsx)(Xe.a,{}),size:"small",style:{marginRight:"4px"},disabled:0===r,onClick:x},"move-up")),I.push(Object(_.jsx)(m.a,{type:"default",icon:Object(_.jsx)(Je.a,{}),size:"small",style:{marginRight:"24px"},disabled:r===i-1,onClick:v},"move-down")),l&&I.push(Object(_.jsx)(m.a,{type:"link",size:"small",onClick:O,children:"Edit"},"edit-chapter")),d&&I.push(Object(_.jsx)(p.a,{title:function(){return Object(_.jsxs)("p",{children:["Are you sure you want to remove this chapter?",Object(_.jsx)("br",{}),"All acts, sequence actions and end conditions associated will be removed."]})},onConfirm:b,onCancel:function(){},okText:"Yes",cancelText:"No",placement:"bottomRight",children:Object(_.jsx)(m.a,{type:"link",size:"small",children:"Remove"})},"remove-chapter"));var N="Chapter "+t.order+": "+t.name,D=void 0!==P?P.length:0,L=0===D?"No acts":1===D?"1 act":D+" acts";return Object(_.jsxs)(ke.a,{className:"chapter-view",size:"small",title:N,extra:I,headStyle:{background:"#f5f5f5"},children:[Object(_.jsx)(He,{children:t.description}),Object(_.jsx)(Ye.a,{defaultActiveKey:["1"],ghost:!0,children:Object(_.jsxs)($e,{header:L,children:[void 0!==P&&P.sort((function(e,t){return e.order-t.order})).map((function(e,n){return Object(_.jsx)(We,{act:e,actIndex:n,totalActs:D,onRemove:function(){k(e)},onEdit:function(){S(e)},onMoveOrderUp:function(){!function(e){var n={oldOrder:e.order,order:e.order-1,chapter_id:t.id};z.updateActOrder(R,e.id,n).then((function(e){})).catch((function(e){h.b.error("Something went wrong, sorry :(")}))}(e)},onMoveOrderDown:function(){!function(e){var n={oldOrder:e.order,order:e.order+1,chapter_id:t.id};z.updateActOrder(R,e.id,n).then((function(e){})).catch((function(e){h.b.error("Something went wrong, sorry :(")}))}(e)}},e.id)})),Object(_.jsx)(m.a,{type:"default",size:"small",onClick:function(){A(D)},children:"Add Act"})]},"1")})]})},tt=I.a.TextArea,nt=function(e){var t=e.chapter,n=void 0===t?null:t,r=e.totalChapters,c=void 0===r?0:r,i=e.isDrawerVisible,s=e.onDrawerClose,l=Object(a.useContext)(B),u=Object(o.a)(l,2)[1],d=R.a.useForm(),j=Object(o.a)(d,1)[0],b=Object(a.useState)(!1),f=Object(o.a)(b,2),p=f[0],O=f[1],g=Object(a.useState)(0),v=Object(o.a)(g,2),w=v[0],A=v[1],C=Object(a.useState)(""),S=Object(o.a)(C,2),E=S[0],k=S[1],T=Object(a.useState)(""),N=Object(o.a)(T,2),D=N[0],L=N[1];Object(a.useEffect)((function(){if(i){if(j.resetFields(),n)j.setFieldsValue({name:n.name,description:n.description,chapterIndex:n.order}),A(n.order);else{var e=c+1;j.setFieldsValue({chapterIndex:e}),A(e)}F()}}),[i,j,n,c]);var F=function(){O(!0)},V=function(){O(!1),s&&s()};return Object(_.jsx)(P.a,{title:null===n?"New chapter":"Edit chapter",width:360,onClose:V,visible:p,bodyStyle:{paddingBottom:20},footer:Object(_.jsxs)("div",{style:{textAlign:"right"},children:[Object(_.jsx)(m.a,{onClick:V,style:{marginRight:8},children:"Cancel"}),Object(_.jsx)(m.a,{type:"primary",htmlType:"submit",form:"add-edit-chapter-id",children:null===n?"Create":"Update"})]}),children:Object(_.jsxs)(R.a,{layout:"vertical",name:"add-edit-chapter",id:"add-edit-chapter-id",form:j,onFinish:function(e){var t=e.name.trim(),a=e.description.trim();if(""===t||""===a)return V(),void h.b.error("Do not leave empty fields, sorry :(");var r={name:t,description:a,order:w};null===n?z.createNewChapter(u,r).then((function(e){V(),h.b.success("New chapter created!")})).catch((function(e){V(),h.b.error("Something went wrong, sorry :(")})):z.updateChapter(u,n.id,r).then((function(e){V(),h.b.success("Chapter edited!")})).catch((function(e){V(),h.b.error("Something went wrong, sorry :(")}))},requiredMark:!1,children:[Object(_.jsx)(y.a,{gutter:16,children:Object(_.jsx)(x.a,{span:24,children:Object(_.jsx)(R.a.Item,{name:"chapterIndex",label:"Chapter",children:Object(_.jsx)(I.a,{placeholder:"#",value:w,disabled:!0})})})}),Object(_.jsx)(y.a,{gutter:16,children:Object(_.jsx)(x.a,{span:24,children:Object(_.jsx)(R.a.Item,{name:"name",label:"Name",rules:[{required:!0,message:"Please enter a name"}],children:Object(_.jsx)(I.a,{placeholder:"Please enter a name",value:E,onChange:function(e){k(e.target.value)}})})})}),Object(_.jsx)(y.a,{gutter:16,children:Object(_.jsx)(x.a,{span:24,children:Object(_.jsx)(R.a.Item,{name:"description",label:"Description",rules:[{required:!0,message:"Please enter a description"}],children:Object(_.jsx)(tt,{rows:10,placeholder:"Please enter a description",value:D,onChange:function(e){L(e.target.value)}})})})})]})})},at=n(392),rt=I.a.TextArea,ct=s.a.Text,it=function(e){var t=e.act,n=void 0===t?null:t,r=e.chapter,c=void 0===r?null:r,i=e.totalActs,s=void 0===i?0:i,l=e.isDrawerVisible,u=e.onDrawerClose,d=Object(a.useContext)(B),j=Object(o.a)(d,2)[1],b=R.a.useForm(),f=Object(o.a)(b,1)[0],p=Object(a.useState)(!1),O=Object(o.a)(p,2),g=O[0],v=O[1],w=Object(a.useState)(0),A=Object(o.a)(w,2),C=A[0],S=A[1],E=Object(a.useState)("interactive"),k=Object(o.a)(E,2),T=k[0],N=k[1],D=Object(a.useState)(""),L=Object(o.a)(D,2),F=L[0],V=L[1],Q=Object(a.useState)(""),q=Object(o.a)(Q,2),G=q[0],U=q[1];Object(a.useEffect)((function(){if(l){if(f.resetFields(),n)f.setFieldsValue({name:n.name,description:n.description,actIndex:n.order,actType:n.type}),S(n.order);else{var e=s+1;f.setFieldsValue({actIndex:e}),S(e)}N("interactive"),M()}}),[l,f,n,s]);var M=function(){v(!0)},K=function(){v(!1),u&&u()};return Object(_.jsx)(P.a,{title:null===n?"New act":"Edit act",width:360,onClose:K,visible:g,bodyStyle:{paddingBottom:20},footer:Object(_.jsxs)("div",{style:{textAlign:"right"},children:[Object(_.jsx)(m.a,{onClick:K,style:{marginRight:8},children:"Cancel"}),Object(_.jsx)(m.a,{type:"primary",htmlType:"submit",form:"add-edit-act-id",children:null===n?"Create":"Update"})]}),children:Object(_.jsxs)(R.a,{layout:"vertical",name:"add-edit-act",id:"add-edit-act-id",form:f,onFinish:function(e){var t=e.name.trim(),a=e.description.trim();if(""===t||""===a)return K(),void h.b.error("Do not leave empty fields, sorry :(");var r={name:t,description:a,order:C,chapter_id:c.id,type:T};null===n?z.createNewAct(j,r).then((function(e){K(),h.b.success("New act created!")})).catch((function(e){K(),h.b.error("Something went wrong, sorry :(")})):z.updateAct(j,n.id,r).then((function(e){K(),h.b.success("Act edited!")})).catch((function(e){K(),h.b.error("Something went wrong, sorry :(")}))},requiredMark:!1,children:[Object(_.jsx)(y.a,{gutter:16,children:Object(_.jsx)(x.a,{span:24,children:Object(_.jsx)(R.a.Item,{name:"actIndex",label:"Act",children:Object(_.jsx)(I.a,{placeholder:"#",value:C,disabled:!0})})})}),Object(_.jsx)(y.a,{gutter:16,children:Object(_.jsx)(x.a,{span:24,children:Object(_.jsx)(R.a.Item,{name:"name",label:"Name",rules:[{required:!0,message:"Please enter a name"}],children:Object(_.jsx)(I.a,{placeholder:"Please enter a name",value:F,onChange:function(e){V(e.target.value)}})})})}),Object(_.jsx)(y.a,{gutter:16,children:Object(_.jsx)(x.a,{span:24,children:Object(_.jsx)(R.a.Item,{name:"description",label:"Description",rules:[{required:!0,message:"Please enter a description"}],children:Object(_.jsx)(rt,{rows:10,placeholder:"Please enter a description",value:G,onChange:function(e){U(e.target.value)}})})})}),Object(_.jsx)(y.a,{gutter:16,style:{display:null===n?"block":"none"},children:Object(_.jsx)(x.a,{span:24,children:Object(_.jsxs)(R.a.Item,{name:"actType",label:"Act type",initialValue:"interactive",children:[Object(_.jsxs)(at.a.Group,{value:T,onChange:function(e){N(e.target.value)},buttonStyle:"solid",children:[Object(_.jsx)(at.a.Button,{value:"interactive",children:"Interactive"}),Object(_.jsx)(at.a.Button,{value:"sequence",children:"Sequence"})]}),Object(_.jsx)(ct,{type:"secondary",style:{display:"block"},children:"interactive"===T?"Interactive act allows player to choose different actions while act's finished condition has not been accomplished":"Sequence act is used for predefined dialogs or fixed sequences (i.e. cinematics)"})]})})})]})})},ot=function(e){var t=e.onAddCondition,n=Object(a.useContext)(B),r=Object(o.a)(n,2)[1],c=Object(a.useState)(!1),i=Object(o.a)(c,2),s=i[0],l=i[1],u=Object(a.useState)(!1),d=Object(o.a)(u,2),j=d[0],b=d[1],f=Object(a.useState)(null),p=Object(o.a)(f,2),O=p[0],y=p[1],x=Object(a.useState)(null),g=Object(o.a)(x,2),v=g[0],w=g[1],A=Object(a.useState)(0),C=Object(o.a)(A,2),S=C[0],E=C[1],k=Object(te.useLiveQuery)((function(){return G.chapters.orderBy("order").toArray()})),T=void 0!==k?k.length:0;return Object(_.jsxs)("div",{children:[void 0!==k&&k.map((function(e,t){return Object(_.jsx)(et,{chapter:e,chapterIndex:t,totalChapters:T,onRemove:function(){!function(e){z.deleteChapter(r,e.id).then((function(e){h.b.success("Chapter removed!")})).catch((function(e){h.b.error("Something went wrong, sorry :(")}))}(e)},onEdit:function(){!function(e){y(e),l(!0)}(e)},onMoveOrderUp:function(){!function(e){var t={oldOrder:e.order,order:e.order-1};z.updateChapterOrder(r,e.id,t).then((function(e){})).catch((function(e){h.b.error("Something went wrong, sorry :(")}))}(e)},onMoveOrderDown:function(){!function(e){var t={oldOrder:e.order,order:e.order+1};z.updateChapterOrder(r,e.id,t).then((function(e){})).catch((function(e){h.b.error("Something went wrong, sorry :(")}))}(e)},onAddAct:function(t){!function(e,t){w(null),y(e),E(t),b(!0)}(e,t)},onEditAct:function(t){!function(e,t){y(t),w(e),b(!0)}(t,e)},onRemoveAct:function(t){!function(e,t){z.deleteAct(r,e.id,t.id).then((function(e){h.b.success("Act removed!")})).catch((function(e){h.b.error("Something went wrong, sorry :(")}))}(t,e)}},e.id)})),Object(_.jsx)(m.a,{type:"primary",onClick:function(){y(null),l(!0)},children:"Add Chapter"}),Object(_.jsx)(m.a,{type:"primary",onClick:t,style:{marginLeft:20},children:"dev:ConditionEditor"}),Object(_.jsx)(nt,{chapter:O,totalChapters:T,isDrawerVisible:s,onDrawerClose:function(){l(!1)}}),Object(_.jsx)(it,{act:v,chapter:O,totalActs:S,isDrawerVisible:j,onDrawerClose:function(){b(!1)}})]})},st=n(124),lt=n(398),ut=n(399),dt=n(412),jt=function(){function e(){Object(V.a)(this,e)}return Object(Q.a)(e,null,[{key:"getComparatorsForPropType",value:function(e){if(e.endsWith("arr"))return[{id:"IS_EMPTY",name:"Is empty"},{id:"CONTAINS",name:"Contains"},{id:"NOT_CONTAINS",name:"Not contains"},{id:"SIZE_EQUALS",name:"Size equals"},{id:"SIZE_LOWER",name:"Size lower than"},{id:"SIZE_GREATER",name:"Size greater than"}];switch(e){case"int":return[{id:"EQUALS",name:"Equals"},{id:"NOT_EQUALS",name:"Not equals"},{id:"LOWER",name:"Lower than"},{id:"GREATER",name:"Greater than"}];case"boolean":return[{id:"EQUALS",name:"Equals"},{id:"NOT_EQUALS",name:"Not equals"}];case"string":case"location":case"area":case"character":default:return[{id:"IS_EMPTY",name:"Is empty"},{id:"EQUALS",name:"Equals"},{id:"NOT_EQUALS",name:"Not equals"}]}}},{key:"getInputTypeForExpression",value:function(e,t){if(e.endsWith("arr"))switch(t){case"CONTAINS":case"NOT_CONTAINS":switch(e){case"intarr":return"TEXT_INT";case"booleanarr":return"BOOLEAN";case"stringarr":return"TEXT_STRING";case"locationarr":case"areaarr":case"characterarr":default:return"SELECTOR"}case"SIZE_EQUALS":case"SIZE_LOWER":case"SIZE_GREATER":return"TEXT_INT";case"IS_EMPTY":default:return"NONE"}else switch(e){case"int":return"TEXT_INT";case"boolean":return"BOOLEAN";case"string":return"IS_EMPTY"!==t?"TEXT_STRING":"NONE";case"location":case"area":case"character":default:return"IS_EMPTY"!==t?"SELECTOR":"NONE"}}},{key:"getEmptyExpression",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,t={gsProp:null,gsPropType:null,comp:null,compId:null,valueInputType:null,value:null};return e&&(t.name=e),t}}]),e}(),bt=function(){function e(){Object(V.a)(this,e)}return Object(Q.a)(e,null,[{key:"fetchGameStateProps",value:function(){var e=Object(b.a)(j.a.mark((function e(){return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",G.game_state_props.toArray());case 1:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}()},{key:"fetchStoryEntities",value:function(){var e=Object(b.a)(j.a.mark((function e(t){var n;return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if("location"!==t&&"area"!==t&&"character"!==t){e.next=9;break}if(n=t+"s","location"!==t&&"character"!==t){e.next=6;break}return e.abrupt("return",G[n].toArray());case 6:return e.abrupt("return",G.transaction("r",n,"locations",Object(b.a)(j.a.mark((function e(){var t,a;return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,G.locations.toArray();case 2:return t=e.sent,e.next=5,G[n].toArray();case 5:return a=e.sent,e.abrupt("return",a.map((function(e){return e.name=e.name+" ("+t.find((function(t){return t.id===e.location_id})).name+")",e})));case 7:case"end":return e.stop()}}),e)})))));case 7:e.next=10;break;case 9:return e.abrupt("return",G.transaction("r","custom_entity_defs","custom_entities",Object(b.a)(j.a.mark((function e(){var n;return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,G.custom_entity_defs.where({singular_name:t}).first();case 2:return n=e.sent,e.abrupt("return",G.custom_entities.where({custom_entity_def_id:n.id}).toArray());case 4:case"end":return e.stop()}}),e)})))));case 10:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()}]),e}(),ht=xe.a.Option,ft=function(e){var t=e.entityType,n=void 0===t?"location":t,r=e.value,c=e.onChangeCallback,i=Object(a.useState)([]),s=Object(o.a)(i,2),l=s[0],u=s[1];return Object(a.useEffect)((function(){bt.fetchStoryEntities(n).then((function(e){u(e)})).catch((function(e){console.log("||--FAIL",e)}))}),[]),Object(a.useEffect)((function(){bt.fetchStoryEntities(n).then((function(e){u(e)})).catch((function(e){console.log("||--FAIL",e)}))}),[n]),Object(_.jsx)(xe.a,{value:r,onChange:function(e){c(e)},style:{width:"100%"},children:l&&l.length>0&&l.map((function(e){return Object(_.jsx)(ht,{value:e.id,children:e.name},e.id)}))})},pt=xe.a.Option,mt=function(){function e(){Object(V.a)(this,e)}return Object(Q.a)(e,null,[{key:"renderGameStatePropsSelector",value:function(e,t,n){return Object(_.jsx)(xe.a,{value:e,onChange:function(e){t(e)},style:{width:"100%"},children:void 0!==n&&n.map((function(e,t){return Object(_.jsx)(pt,{value:t,children:e.name},t)}))})}},{key:"renderComparatorSelector",value:function(e,t,n){return Object(_.jsx)(xe.a,{value:t,onChange:function(e){n(e)},style:{width:"100%"},children:e&&jt.getComparatorsForPropType(e).map((function(e){return Object(_.jsx)(pt,{value:e.id,children:e.name},e.id)}))})}},{key:"renderValueSelector",value:function(e,t,n,a){switch(t){case"BOOLEAN":return Object(_.jsx)(ve.a,{checkedChildren:"true",unCheckedChildren:"false",checked:n,onChange:function(e){a(e)}});case"TEXT_STRING":return Object(_.jsx)(I.a,{value:n,onChange:function(e){a(e.target.value)}});case"TEXT_INT":return Object(_.jsx)(ge.a,{value:n,onChange:function(e){a(e)},style:{width:"100%"}});case"SELECTOR":var r=e.endsWith("arr")?e.substring(0,e.length-3):e;return Object(_.jsx)(ft,{entityType:r,value:n,onChangeCallback:a});case"NONE":default:return null}}}]),e}(),Ot=function(e){var t=e.expression,n=e.gameStates,a=e.onChange;return Object(_.jsx)(he.b.Item,{className:"complex-condition-expression-list-item",children:Object(_.jsxs)(y.a,{gutter:[24,8],style:{width:"100%"},children:[Object(_.jsx)(x.a,{span:4,children:t.name}),Object(_.jsx)(x.a,{span:7,children:mt.renderGameStatePropsSelector(t.gsProp,(function(e){var r=t,c=n[e];r.gsProp=c.name,r.gsPropType=c.type,r.comp=null,r.compId=null,r.valueInputType=null,r.value=null,a(r)}),n)}),Object(_.jsx)(x.a,{span:6,style:{display:null!==t.gsProp?"block":"none"},children:mt.renderComparatorSelector(t.gsPropType,t.compId,(function(e){var n=t;n.compId=e,n.valueInputType=jt.getInputTypeForExpression(n.gsPropType,n.compId),a(n)}))}),Object(_.jsx)(x.a,{span:7,style:{display:null!==t.compId&&"IS_EMPTY"!==t.compId?"block":"none"},children:mt.renderValueSelector(t.gsPropType,t.valueInputType,t.value,(function(e){var n=t;n.value=e,a(n)}))})]})})},yt=(n(373),ue.a.TabPane),xt=s.a.Text,gt=Object(_.jsx)(dt.a,{style:{color:"#fa541c"}},"caret"),vt=function(e){var t=e.condition,n=void 0===t?null:t,r=e.isDrawerVisible,c=e.onDrawerClose,i=R.a.useForm(),s=Object(o.a)(i,1)[0],l=Object(a.useState)(!1),u=Object(o.a)(l,2),d=u[0],j=u[1],b=Object(a.useState)("1"),h=Object(o.a)(b,2),f=h[0],p=h[1],O=Object(a.useState)(jt.getEmptyExpression()),g=Object(o.a)(O,2),v=g[0],w=g[1],A=Object(a.useState)([]),C=Object(o.a)(A,2),S=C[0],E=C[1],k=Object(a.useState)([]),T=Object(o.a)(k,2),I=T[0],D=T[1],L=Object(a.useState)(void 0),B=Object(o.a)(L,2),F=B[0],V=B[1];Object(a.useEffect)((function(){bt.fetchGameStateProps().then((function(e){V(e)})).catch((function(e){console.log("||--FAIL",e)}))}),[]),Object(a.useEffect)((function(){r&&(s.resetFields(),n||p("1"),Q())}),[r,s,n]);var Q=function(){j(!0)},q=function(){j(!1),c&&c()},G=function(e){var t=Object(st.a)(I),n=t.findIndex((function(t){return t.name===e.name}));t[n]=e,D(t)},U=function(e){var t=Object(st.a)(S);switch(e){case"ADD_EXP":var n="EXP"+(I.length+1),a=jt.getEmptyExpression(n),r=Object(st.a)(I);r.push(a),t.push({type:"exp",name:n,displayName:n}),D(r);break;case"AND":t.push({type:"logic",name:"AND",displayName:"AND"});break;case"OR":t.push({type:"logic",name:"OR",displayName:"OR"});break;case"NEG":t.push({type:"logic",name:"NEG",displayName:"NEG"});break;case"OPEN_GR":t.push({type:"grouping",name:"OPEN",displayName:"("});break;case"CLOSE_GR":t.push({type:"grouping",name:"CLOSE",displayName:")"});break;case"DELETE":var c=t.pop();if(c&&"exp"===c.type){var i=Object(st.a)(I);i.pop(),D(i)}break;case"CLEAR":t=[],D([])}E(t)},z=Object(_.jsxs)(y.a,{children:[Object(_.jsx)(x.a,{span:4,children:Object(_.jsx)(xt,{strong:!0,children:"Expression"})}),Object(_.jsx)(x.a,{span:7,children:Object(_.jsx)(xt,{strong:!0,children:"Game State Prop"})}),Object(_.jsx)(x.a,{span:6,children:Object(_.jsx)(xt,{strong:!0,children:"Comparator"})}),Object(_.jsx)(x.a,{span:7,children:Object(_.jsx)(xt,{strong:!0,children:"Value"})})]});return Object(_.jsx)(P.a,{title:null===n?"New condition":"Edit condition",className:"condition-editor",placement:"bottom",height:360,onClose:q,visible:d,bodyStyle:{paddingBottom:20},footer:Object(_.jsxs)("div",{style:{textAlign:"right"},children:[Object(_.jsx)(m.a,{onClick:q,style:{marginRight:8},children:"Cancel"}),Object(_.jsx)(m.a,{type:"primary",style:{marginRight:8},children:"Validate"}),Object(_.jsx)(m.a,{type:"primary",htmlType:"submit",form:"add-edit-condition-id",disabled:!0,children:null===n?"Create":"Update"})]}),children:Object(_.jsx)(R.a,{layout:"vertical",name:"add-edit-condition",id:"add-edit-condition-id",form:s,onFinish:function(e){},requiredMark:!1,children:Object(_.jsxs)(ue.a,{tabPosition:"left",activeKey:f,onChange:function(e){p(e)},children:[Object(_.jsx)(yt,{tab:"Single",children:Object(_.jsxs)(y.a,{gutter:[24,16],children:[Object(_.jsx)(x.a,{span:8,children:Object(_.jsx)(R.a.Item,{name:"singleCondGSProp",label:"Game State Prop",rules:[{required:"1"===f,message:"Please select a prop"}],children:mt.renderGameStatePropsSelector(v.gsProp,(function(e){var t=v,n=F[e];t.gsProp=n.name,t.gsPropType=n.type,t.comp=null,t.compId=null,t.valueInputType=null,t.value=null,w(Object(N.a)({},t)),s.setFieldsValue({singleCondComparator:""})}),F)})}),Object(_.jsx)(x.a,{span:8,style:{display:null!==v.gsProp?"block":"none"},children:Object(_.jsx)(R.a.Item,{name:"singleCondComparator",label:"Comparator",rules:[{required:"1"===f,message:"Please select a comparator"}],children:mt.renderComparatorSelector(v.gsPropType,v.compId,(function(e){var t=v;t.compId=e,t.valueInputType=jt.getInputTypeForExpression(t.gsPropType,t.compId),w(Object(N.a)({},t))}))})}),Object(_.jsx)(x.a,{span:8,style:{display:null!==v.compId&&"IS_EMPTY"!==v.compId?"block":"none"},children:Object(_.jsx)(R.a.Item,{label:"Value",children:mt.renderValueSelector(v.gsPropType,v.valueInputType,v.value,(function(e){var t=v;t.value=e,w(Object(N.a)({},t))}))})})]})},"1"),Object(_.jsxs)(yt,{tab:"Complex",children:[Object(_.jsx)(y.a,{style:{marginBottom:8},children:Object(_.jsx)(x.a,{span:24,children:Object(_.jsxs)(lt.b,{children:[Object(_.jsx)(m.a,{type:"default",size:"small",onClick:function(){U("ADD_EXP")},children:"Expression"}),Object(_.jsx)(m.a,{type:"default",size:"small",onClick:function(){U("AND")},children:"AND"}),Object(_.jsx)(m.a,{type:"default",size:"small",onClick:function(){U("OR")},children:"OR"}),Object(_.jsx)(m.a,{type:"default",size:"small",onClick:function(){U("NEG")},children:"NEG"}),Object(_.jsx)(m.a,{type:"default",size:"small",onClick:function(){U("OPEN_GR")},children:"("}),Object(_.jsx)(m.a,{type:"default",size:"small",onClick:function(){U("CLOSE_GR")},children:")"}),Object(_.jsx)(m.a,{type:"default",size:"small",onClick:function(){U("DELETE")},children:"Delete"}),Object(_.jsx)(m.a,{type:"default",size:"small",onClick:function(){U("CLEAR")},children:"Clear"})]})})}),Object(_.jsx)(y.a,{style:{marginBottom:16},children:Object(_.jsx)(x.a,{span:24,children:Object(_.jsx)("div",{className:"condition-viewer",children:function(){var e=S&&S.map((function(e,t){var n="logic"===e.type?"#52c41a":"grouping"===e.type?"#eb2f96":"#1890ff";return Object(_.jsx)(ut.a,{color:n,children:e.displayName||e.name},t)}));return e.push(gt),e}()})})}),Object(_.jsx)(y.a,{children:Object(_.jsx)(x.a,{span:24,children:I.length>0&&Object(_.jsx)(he.b,{style:{marginBottom:16,maxWidth:"94%"},header:z,dataSource:I,renderItem:function(e){return Object(_.jsx)(Ot,{expression:e,gameStates:F,onChange:G})}})})})]},"2")]})})})},wt=u.a.Content,At=ue.a.TabPane,Ct=function(){var e=Object(a.useState)(!1),t=Object(o.a)(e,2),n=t[0],r=t[1];return Object(_.jsxs)(_.Fragment,{children:[Object(_.jsx)(wt,{className:"story-page",children:Object(_.jsxs)(ue.a,{type:"card",size:"small",children:[Object(_.jsx)(At,{tab:"Storyline (Plot)",children:Object(_.jsx)(ot,{onAddCondition:function(){r(!0)}})},"1"),Object(_.jsx)(At,{tab:"Sequence Actions",children:Object(_.jsx)("p",{children:"Sequence Actions"})},"2")]})}),Object(_.jsx)(vt,{isDrawerVisible:n,onDrawerClose:function(){r(!1)}})]})},St=n(55),Et=n(223),kt=n(224),Tt=n(396),Rt=(n(374),function(){var e=Object(a.useContext)(B),t=Object(o.a)(e,1)[0],n=Object(a.useState)(!0),r=Object(o.a)(n,2),c=r[0],i=r[1];Object(a.useEffect)((function(){i(!1),setTimeout((function(){i(!0)}),5)}),[t.storyVerifyingRunnable]);return Object(_.jsx)(Tt.a,{children:Object(_.jsxs)("div",{className:"play-actions",children:[c&&function(){var e;return e=t.storyVerifyingRunnable?Object(_.jsx)(St.a,{}):t.storyRunnable?Object(_.jsx)("span",{children:"You're all set!! Play your story."}):Object(_.jsx)("span",{children:'Please check "Story validation" tab.'}),Object(_.jsx)("p",{style:{marginBottom:0,marginRight:8},children:e})}(),Object(_.jsx)(m.a,{type:"primary",disabled:!t.storyRunnable,children:"RUN PLAYTEST"})]})})}),Pt=(n(375),s.a.Title),It=s.a.Paragraph,Nt=s.a.Text,Dt=function(){var e=Object(a.useState)(!1),t=Object(o.a)(e,2),n=t[0],r=t[1],c=Object(a.useState)(!1),i=Object(o.a)(c,2),s=i[0],l=i[1];return Object(_.jsx)("div",{className:"playtest-configuration-section",children:Object(_.jsxs)(y.a,{gutter:[24,24],style:{paddingBottom:24},children:[Object(_.jsx)(x.a,{span:24,children:Object(_.jsxs)(ke.a,{className:"run-configuration ".concat(n?"enabled-state":""),children:[Object(_.jsxs)("div",{style:{flex:1},children:[Object(_.jsx)(Pt,{level:5,children:"Group player inventory"}),Object(_.jsx)(It,{children:Object(_.jsx)(Nt,{type:"secondary",children:"Show inventory props in separate group"})})]}),Object(_.jsx)(ve.a,{onChange:function(e){r(e)}})]})}),Object(_.jsx)(x.a,{span:24,children:Object(_.jsxs)(ke.a,{className:"run-configuration ".concat(s?"enabled-state":""),children:[Object(_.jsxs)("div",{style:{flex:1},children:[Object(_.jsx)(Pt,{level:5,children:"Show player achievements"}),Object(_.jsx)(It,{children:Object(_.jsx)(Nt,{type:"secondary",children:"Display notifications when player accomplish objectives, obtain items, etc"})})]}),Object(_.jsx)(ve.a,{onChange:function(e){l(e)}})]})}),Object(_.jsx)(x.a,{span:24,children:Object(_.jsxs)(ke.a,{className:"run-configuration",children:[Object(_.jsxs)("div",{style:{flex:1},children:[Object(_.jsx)(Pt,{level:5,children:"Focus Game state props"}),Object(_.jsx)(It,{children:Object(_.jsx)(Nt,{type:"secondary",children:"Analyze specific properties in play mode"})})]}),Object(_.jsx)(Nt,{children:"TBD"})]})})]})})},_t=function(){return Object(_.jsx)("div",{className:"story-validation-section",style:{width:"80%",margin:"0 auto"},children:Object(_.jsxs)(y.a,{gutter:[24,24],style:{paddingBottom:24},children:[Object(_.jsx)(x.a,{span:24,children:Object(_.jsxs)(ke.a,{children:[Object(_.jsx)("p",{children:"Card content"}),Object(_.jsx)("p",{children:"Card content"}),Object(_.jsx)("p",{children:"Card content"})]})}),Object(_.jsx)(x.a,{span:24,children:Object(_.jsxs)(ke.a,{children:[Object(_.jsx)("p",{children:"Card content"}),Object(_.jsx)("p",{children:"Card content"}),Object(_.jsx)("p",{children:"Card content"})]})}),Object(_.jsx)(x.a,{span:24,children:Object(_.jsxs)(ke.a,{children:[Object(_.jsx)("p",{children:"Card content"}),Object(_.jsx)("p",{children:"Card content"}),Object(_.jsx)("p",{children:"Card content"})]})})]})})},Lt=(n(376),u.a.Content),Bt=ue.a.TabPane,Ft=function(){var e=Object(a.useContext)(B),t=Object(o.a)(e,1)[0],n=Object(a.useState)(!0),r=Object(o.a)(n,2),c=r[0],i=r[1];Object(a.useEffect)((function(){i(!1),setTimeout((function(){i(!0)}),5)}),[t.storyVerifyingRunnable]);return Object(_.jsxs)(_.Fragment,{children:[Object(_.jsx)(Rt,{}),Object(_.jsx)(Lt,{className:"play-mode-page",children:Object(_.jsxs)(ue.a,{type:"card",size:"small",children:[Object(_.jsx)(Bt,{tab:"Playtest configuration",children:Object(_.jsx)(Dt,{})},"1"),Object(_.jsx)(Bt,{tab:c&&function(){var e;return e=t.storyVerifyingRunnable?Object(_.jsx)(St.a,{style:{marginLeft:8}}):t.storyRunnable?Object(_.jsx)(Et.a,{style:{color:"#389e0d",marginLeft:8}}):Object(_.jsx)(kt.a,{style:{color:"#cf1322",marginLeft:8}}),Object(_.jsxs)("span",{children:["Story validation ",e]})}(),children:Object(_.jsx)(_t,{})},"2")]})})]})},Vt=s.a.Text,Qt=function(){var e=Object(a.useContext)(B),t=Object(o.a)(e,2),n=t[0],c=t[1];if(Object(a.useEffect)((function(){z.checkDatabaseOk(c),z.checkStoryLoaded(c)}),[]),!n.initialCheckDone||n.globalLoading)return Object(_.jsxs)("div",{className:"app loading",children:[Object(_.jsx)("img",{src:H,alt:"RPG Story Playtesting"}),Object(_.jsx)(l.a,{size:"large"})]});if(n.databaseLoadError)return Object(_.jsx)(Vt,{style:{display:"block",textAlign:"center",paddingTop:50},children:"This application requires IndexedDB. Please use a browser that supports this feature."});if(n.storyLoadError)return Object(_.jsxs)(Vt,{style:{display:"block",textAlign:"center",paddingTop:50},children:["We were unable to load your story, please reload and make sure your file/url contains a RPG-SP story.",Object(_.jsx)("br",{}),null!==n.storyErrorMessage&&"Error info: "+n.storyErrorMessage]});var i=null;if(n.storyLoaded)switch(n.page){case"PLAYMODE":i=Ft;break;case"STORY":i=Ct;break;case"CONFIG":default:i=Ke}return Object(_.jsx)("div",{className:"app",children:Object(_.jsxs)(u.a,{children:[Object(_.jsx)(ee,{}),Object(_.jsx)(u.a,{className:"app-layout",children:n.storyLoaded?Object(_.jsxs)(_.Fragment,{children:[Object(_.jsx)(ce,{}),r.a.createElement(i)]}):Object(_.jsx)(le,{})})]})})},qt=(n(377),n(378),function(){return Object(_.jsx)(F,{children:Object(_.jsx)(Qt,{})})}),Gt=function(e){e&&e instanceof Function&&n.e(3).then(n.bind(null,413)).then((function(t){var n=t.getCLS,a=t.getFID,r=t.getFCP,c=t.getLCP,i=t.getTTFB;n(e),a(e),r(e),c(e),i(e)}))};i.a.render(Object(_.jsx)(r.a.StrictMode,{children:Object(_.jsx)(qt,{})}),document.getElementById("root")),Gt()}},[[379,1,2]]]);
//# sourceMappingURL=main.6e4d91b1.chunk.js.map