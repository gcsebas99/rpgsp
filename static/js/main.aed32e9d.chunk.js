(this.webpackJsonprpgsp=this.webpackJsonprpgsp||[]).push([[0],{225:function(e,t,n){},297:function(e,t,n){},298:function(e,t,n){},300:function(e,t,n){},301:function(e,t,n){},362:function(e,t,n){},363:function(e,t,n){},364:function(e,t,n){},365:function(e,t,n){},366:function(e,t,n){},367:function(e,t,n){},368:function(e,t,n){},369:function(e,t,n){},370:function(e,t,n){},371:function(e,t,n){"use strict";n.r(t);var r=n(0),a=n.n(r),c=n(20),i=n.n(c),o=(n(225),n(8)),s=n(379),l=n(212),u=n(374),d=n(24),j=n.n(d),b=n(32),h=n(216),f=n(386),m=n(375),p=n(115),O=n(376),x=n(102),y=n(55),v=n(389),g=n(390),w=n(391),A=n(392),C=n(393),S=n(394),k=n(220),D=n(395),E=n(396),P=n(378),R=n(385),B=n(382),T=n(56),I=function(e,t){switch(t.type){case"SET_APP_INITIAL_CHECK_DONE":return Object(T.a)(Object(T.a)({},e),{},{initialCheckDone:!0});case"SET_APP_DATABASE_LOAD_ERROR":return Object(T.a)(Object(T.a)({},e),{},{databaseLoadError:!0,initialCheckDone:!0});case"SET_APP_STORY_LOAD_ERROR":return Object(T.a)(Object(T.a)({},e),{},{storyLoadError:!0,storyErrorMessage:t.payload||null});case"SET_APP_PAGE":return Object(T.a)(Object(T.a)({},e),{},{page:t.payload});case"SET_STORY_LOADED":return Object(T.a)(Object(T.a)({},e),{},{storyLoaded:t.payload,page:t.payload?"CONFIG":"EMPTY"});default:return e}},N=n(1),L={initialCheckDone:!1,databaseLoadError:!1,storyLoadError:!1,storyErrorMessage:null,storyLoaded:!1,page:"EMPTY"},Q=Object(r.createContext)(L),F=function(e){var t=e.children,n=Object(r.useReducer)(I,L),a=Object(o.a)(n,2),c=a[0],i=a[1];return Object(N.jsx)(Q.Provider,{value:[c,i],children:t})},V=n(66),_=n(67),q=new(n(168).default)("RpgspDatabase");q.version(1).stores({stories:"++id",game_state_props:"++id, name",locations:"++id, name",areas:"++id, location_id, name",characters:"++id, name",custom_entity_defs:"++id",custom_entities:"++id, custom_entity_def_id, name",default_entity_colors:"++id",chapters:"++id, order",acts:"++id, order, chapter_id, type"});var z=q,U=function(){function e(){Object(V.a)(this,e)}return Object(_.a)(e,null,[{key:"getNewStoryDefaultGameStateProps",value:function(){return[{name:"currentChapter",type:"integer",default:0,edit_mode:"none",removable:!1},{name:"currentAct",type:"integer",default:0,edit_mode:"none",removable:!1},{name:"currentActSequence",type:"integer",default:0,edit_mode:"none",removable:!1},{name:"currentLocation",type:"location",default:null,edit_mode:"default",removable:!1},{name:"currentArea",type:"area",default:null,edit_mode:"default",removable:!1}]}},{key:"getNewStoryDefaultCharacters",value:function(){return[{name:"[Playable character]",description:"[Add description]"}]}},{key:"getNewStoryDefaultEntityColors",value:function(){return[{name:"locations",color:e.getEntitiesDefaultColors("locations")},{name:"areas",color:e.getEntitiesDefaultColors("areas")},{name:"characters",color:e.getEntitiesDefaultColors("characters")}]}},{key:"getEntitiesDefaultColors",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"locations";switch(e){case"characters":return"#1890ff";case"areas":return"#a0d911";case"locations":default:return"#3f6600"}}},{key:"getCustomEntityRandomColor",value:function(){return["#ffa940","#73d13d","#10239e","#36cfc9","#9e1068","#9254de","#85a5ff","#fadb14","#ffa940","#391085"][Math.floor(10*Math.random())]}}]),e}(),M=function(){function e(){Object(V.a)(this,e)}return Object(_.a)(e,null,[{key:"checkDatabaseOk",value:function(e){q.open().catch((function(t){console.error("Failed to open db: "+(t.stack||t)),e({type:"SET_APP_DATABASE_LOAD_ERROR"})}))}},{key:"checkStoryLoaded",value:function(){var e=Object(b.a)(j.a.mark((function e(t){return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,z.stories.where("id").equals(1).first();case 2:void 0!==e.sent&&t({type:"SET_STORY_LOADED",payload:!0}),t({type:"SET_APP_INITIAL_CHECK_DONE"});case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()},{key:"createNewStory",value:function(e,t){return z.transaction("rw",z.stories,z.game_state_props,z.characters,z.default_entity_colors,Object(b.a)(j.a.mark((function e(){return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,z.stories.add({title:t.title,version:t.version});case 2:return e.next=4,z.game_state_props.bulkAdd(U.getNewStoryDefaultGameStateProps());case 4:return e.next=6,z.characters.bulkAdd(U.getNewStoryDefaultCharacters());case 6:return e.next=8,z.default_entity_colors.bulkAdd(U.getNewStoryDefaultEntityColors());case 8:case"end":return e.stop()}}),e)})))).then((function(t){e({type:"SET_STORY_LOADED",payload:!0})})).catch((function(e){return console.log("||--FAIL",e),Promise.reject(e)}))}},{key:"createNewGameStateProp",value:function(e,t){return z.game_state_props.add({name:t.name,type:t.type,default:t.defaultValue,edit_mode:t.editMode,removable:t.removable}).then((function(){})).catch((function(e){return console.log("||--FAIL",e),Promise.reject(e)}))}},{key:"updateGameStateProp",value:function(e,t,n){return z.game_state_props.update(t,{name:n.name,type:n.type,default:n.defaultValue,edit_mode:n.editMode,removable:n.removable}).then((function(){})).catch((function(e){return console.log("||--FAIL",e),Promise.reject(e)}))}},{key:"deleteGameStateProp",value:function(e,t){return z.game_state_props.delete(t).then((function(){})).catch((function(e){return console.log("||--FAIL",e),Promise.reject(e)}))}},{key:"createNewLocation",value:function(e,t){return z.locations.add({name:t.name,description:t.description}).then((function(){})).catch((function(e){return console.log("||--FAIL",e),Promise.reject(e)}))}},{key:"updateLocation",value:function(e,t,n){return z.locations.update(t,{name:n.name,description:n.description}).then((function(){})).catch((function(e){return console.log("||--FAIL",e),Promise.reject(e)}))}},{key:"deleteLocation",value:function(e,t){return z.transaction("rw",z.locations,z.areas,Object(b.a)(j.a.mark((function e(){return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,z.areas.where("location_id").equals(t).delete();case 2:return e.next=4,z.locations.delete(t);case 4:case"end":return e.stop()}}),e)})))).then((function(e){})).catch((function(e){return console.log("||--FAIL",e),Promise.reject(e)}))}},{key:"createNewArea",value:function(e,t){return z.areas.add({location_id:t.location_id,name:t.name,description:t.description}).then((function(){})).catch((function(e){return console.log("||--FAIL",e),Promise.reject(e)}))}},{key:"updateArea",value:function(e,t,n){return z.areas.update(t,{name:n.name,description:n.description}).then((function(){})).catch((function(e){return console.log("||--FAIL",e),Promise.reject(e)}))}},{key:"deleteArea",value:function(e,t){return z.areas.delete(t).then((function(){})).catch((function(e){return console.log("||--FAIL",e),Promise.reject(e)}))}},{key:"createNewCharacter",value:function(e,t){return z.characters.add({name:t.name,description:t.description}).then((function(){})).catch((function(e){return console.log("||--FAIL",e),Promise.reject(e)}))}},{key:"updateCharacter",value:function(e,t,n){return z.characters.update(t,{name:n.name,description:n.description}).then((function(){})).catch((function(e){return console.log("||--FAIL",e),Promise.reject(e)}))}},{key:"deleteCharacter",value:function(e,t){return z.characters.delete(t).then((function(){})).catch((function(e){return console.log("||--FAIL",e),Promise.reject(e)}))}},{key:"createNewCustomEntityDef",value:function(e,t){return z.custom_entity_defs.add({name:t.name,key:t.key,singular_name:t.singular,color:U.getCustomEntityRandomColor()}).then((function(){})).catch((function(e){return console.log("||--FAIL",e),Promise.reject(e)}))}},{key:"deleteCustomEntityDef",value:function(e,t){return z.transaction("rw",z.custom_entity_defs,z.custom_entities,Object(b.a)(j.a.mark((function e(){return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,z.custom_entities.where("custom_entity_def_id").equals(t).delete();case 2:return e.next=4,z.custom_entity_defs.delete(t);case 4:case"end":return e.stop()}}),e)})))).then((function(e){})).catch((function(e){return console.log("||--FAIL",e),Promise.reject(e)}))}},{key:"createNewCustomEntity",value:function(e,t){return z.custom_entities.add({custom_entity_def_id:t.custom_entity_def_id,name:t.name,description:t.description}).then((function(){})).catch((function(e){return console.log("||--FAIL",e),Promise.reject(e)}))}},{key:"updateCustomEntity",value:function(e,t,n){return z.custom_entities.update(t,{name:n.name,description:n.description}).then((function(){})).catch((function(e){return console.log("||--FAIL",e),Promise.reject(e)}))}},{key:"deleteCustomEntity",value:function(e,t){return z.custom_entities.delete(t).then((function(){})).catch((function(e){return console.log("||--FAIL",e),Promise.reject(e)}))}},{key:"updateDefaultEntityColor",value:function(e,t,n){return z.default_entity_colors.update(t,{color:n.color}).then((function(){})).catch((function(e){return console.log("||--FAIL",e),Promise.reject(e)}))}},{key:"updateCustomEntityDefColor",value:function(e,t,n){return z.custom_entity_defs.update(t,{color:n.color}).then((function(){})).catch((function(e){return console.log("||--FAIL",e),Promise.reject(e)}))}},{key:"createNewChapter",value:function(e,t){return z.chapters.add({name:t.name,description:t.description,order:t.order}).then((function(){})).catch((function(e){return console.log("||--FAIL",e),Promise.reject(e)}))}},{key:"updateChapter",value:function(e,t,n){return z.chapters.update(t,{name:n.name,description:n.description}).then((function(){})).catch((function(e){return console.log("||--FAIL",e),Promise.reject(e)}))}},{key:"updateChapterOrder",value:function(e,t,n){return z.transaction("rw",z.chapters,Object(b.a)(j.a.mark((function e(){var r;return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,z.chapters.where("order").equals(n.order).first();case 2:return r=e.sent,e.next=5,z.chapters.update(t,{order:n.order});case 5:return e.next=7,z.chapters.update(r.id,{order:n.oldOrder});case 7:case"end":return e.stop()}}),e)})))).then((function(e){})).catch((function(e){return console.log("||--FAIL",e),Promise.reject(e)}))}},{key:"deleteChapter",value:function(e,t){return z.transaction("rw",z.chapters,Object(b.a)(j.a.mark((function e(){var n,r,a;return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=null,r=[],a=z.chapters.orderBy("order"),e.next=5,a.each((function(e){null!==n&&r.push({key:e.id,order:n+r.length}),e.id===t&&(n=e.order)}));case 5:return e.next=7,z.chapters.delete(t);case 7:r.forEach(function(){var e=Object(b.a)(j.a.mark((function e(t){return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,z.chapters.update(t.key,{order:t.order});case 2:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}());case 8:case"end":return e.stop()}}),e)})))).then((function(e){})).catch((function(e){return console.log("||--FAIL",e),Promise.reject(e)}))}},{key:"createNewAct",value:function(e,t){return z.acts.add({chapter_id:t.chapter_id,name:t.name,description:t.description,order:t.order,type:t.type}).then((function(){})).catch((function(e){return console.log("||--FAIL",e),Promise.reject(e)}))}},{key:"updateAct",value:function(e,t,n){return z.acts.update(t,{name:n.name,description:n.description}).then((function(){})).catch((function(e){return console.log("||--FAIL",e),Promise.reject(e)}))}},{key:"updateActOrder",value:function(e,t,n){return z.transaction("rw",z.acts,Object(b.a)(j.a.mark((function e(){var r;return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,z.acts.where({chapter_id:n.chapter_id,order:n.order}).first();case 2:return r=e.sent,e.next=5,z.acts.update(t,{order:n.order});case 5:return e.next=7,z.acts.update(r.id,{order:n.oldOrder});case 7:case"end":return e.stop()}}),e)})))).then((function(e){})).catch((function(e){return console.log("||--FAIL",e),Promise.reject(e)}))}},{key:"deleteAct",value:function(e,t,n){return z.transaction("rw",z.acts,Object(b.a)(j.a.mark((function e(){var r,a,c,i;return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=null,a=[],e.next=4,z.acts.where("chapter_id").equals(n).toArray();case 4:return c=e.sent,i=c.sort((function(e,t){return e.order-t.order})),e.next=8,i.forEach((function(e){null!==r&&a.push({key:e.id,order:r+a.length}),e.id===t&&(r=e.order)}));case 8:return e.next=10,z.acts.delete(t);case 10:a.forEach(function(){var e=Object(b.a)(j.a.mark((function e(t){return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,z.acts.update(t.key,{order:t.order});case 2:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}());case 11:case"end":return e.stop()}}),e)})))).then((function(e){})).catch((function(e){return console.log("||--FAIL",e),Promise.reject(e)}))}},{key:"devStartOver",value:function(e){return z.delete().then((function(){return window.location.reload()}))}}]),e}(),K=function(e){var t=e.isDrawerVisible,n=e.onDrawerClose,a=Object(r.useContext)(Q),c=Object(o.a)(a,2)[1],i=P.a.useForm(),s=Object(o.a)(i,1)[0],l=Object(r.useState)(!1),u=Object(o.a)(l,2),d=u[0],j=u[1],b=Object(r.useState)(""),f=Object(o.a)(b,2),m=f[0],O=f[1],v=Object(r.useState)(""),g=Object(o.a)(v,2),w=g[0],A=g[1];Object(r.useEffect)((function(){t&&(s.resetFields(),C())}),[t,s]);var C=function(){j(!0)},S=function(){j(!1),n&&n()};return Object(N.jsx)(R.a,{title:"New story",width:360,onClose:S,visible:d,bodyStyle:{paddingBottom:20},footer:Object(N.jsxs)("div",{style:{textAlign:"right"},children:[Object(N.jsx)(p.a,{onClick:S,style:{marginRight:8},children:"Cancel"}),Object(N.jsx)(p.a,{type:"primary",htmlType:"submit",form:"create-story-id",children:"Create"})]}),children:Object(N.jsxs)(P.a,{layout:"vertical",name:"create-story",id:"create-story-id",form:s,onFinish:function(e){var t=e.title.trim(),n=e.version.trim();if(""===t||""===n)return S(),void h.b.error("Something went wrong, sorry :(");var r={title:t,version:n};M.createNewStory(c,r).then((function(e){S(),h.b.success("Story created!")})).catch((function(e){S(),h.b.error("Something went wrong, sorry :(")}))},requiredMark:!1,children:[Object(N.jsx)(x.a,{gutter:16,children:Object(N.jsx)(y.a,{span:24,children:Object(N.jsx)(P.a.Item,{name:"title",label:"Title",rules:[{required:!0,message:"Please enter a title"}],children:Object(N.jsx)(B.a,{placeholder:"Please enter a title",value:m,onChange:function(e){O(e.target.value)}})})})}),Object(N.jsx)(x.a,{gutter:16,children:Object(N.jsx)(y.a,{span:24,children:Object(N.jsx)(P.a.Item,{name:"version",label:"Version",rules:[{required:!0,message:"Please enter a version"}],children:Object(N.jsx)(B.a,{placeholder:"Please enter a version",value:w,onChange:function(e){A(e.target.value)}})})})})]})})},G=n(170),Y=n(204),J=n.n(Y),X=function(){function e(){Object(V.a)(this,e)}return Object(_.a)(e,null,[{key:"downloadStory",value:function(){var e=Object(b.a)(j.a.mark((function e(t){var n,r,a,c,i,o,s,l=arguments;return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=l.length>1&&void 0!==l[1]?l[1]:function(){},r=l.length>2&&void 0!==l[2]?l[2]:function(){},e.prev=2,e.next=5,z.stories.where("id").equals(1).first();case 5:return a=e.sent,c=new Date,i=c.getFullYear().toString()+c.getMonth().toString()+c.getDate().toString()+"-"+c.getHours().toString()+c.getMinutes().toString()+c.getSeconds().toString(),o=a.title.replaceAll(" ","_")+"-"+i+".json",e.next=11,Object(G.a)(z,{prettyJson:!0,progressCallback:n});case 11:s=e.sent,J()(s,o,"application/json"),e.next=18;break;case 15:e.prev=15,e.t0=e.catch(2),r(e.t0);case 18:case"end":return e.stop()}}),e,null,[[2,15]])})));return function(t){return e.apply(this,arguments)}}()},{key:"loadStoryFromFile",value:function(){var e=Object(b.a)(j.a.mark((function e(t,n){var r,a,c=arguments;return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r=c.length>2&&void 0!==c[2]?c[2]:function(){},a=c.length>3&&void 0!==c[3]?c[3]:function(){},e.prev=2,!z.isOpen()){e.next=6;break}return e.next=6,z.delete().then((function(){return z.open()}));case 6:return e.next=8,Object(G.b)(z,n,{acceptMissingTables:!1,acceptVersionDiff:!1,acceptNameDiff:!1,acceptChangedPrimaryKey:!1,progressCallback:r});case 8:return e.next=10,z.stories.where("id").equals(1).first();case 10:void 0!==e.sent&&t({type:"SET_STORY_LOADED",payload:!0}),a(),e.next=19;break;case 15:e.prev=15,e.t0=e.catch(2),t({type:"SET_APP_STORY_LOAD_ERROR",payload:e.t0}),console.log(e.t0);case 19:case"end":return e.stop()}}),e,null,[[2,15]])})));return function(t,n){return e.apply(this,arguments)}}()}]),e}(),H="data:image/png;base64,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",Z=(n(297),u.a.Sider),W=function(){var e=Object(r.useContext)(Q),t=Object(o.a)(e,2),n=t[0],a=t[1],c=Object(r.useState)(!1),i=Object(o.a)(c,2),s=i[0],l=i[1],u=Object(r.useState)(!0),d=Object(o.a)(u,2),P=d[0],R=d[1],B=Object(r.useState)(!1),T=Object(o.a)(B,2),I=T[0],L=T[1];Object(r.useEffect)((function(){document.getElementById("load-story-selector").addEventListener("change",_,!1)}),[]),Object(r.useEffect)((function(){R(!1),setTimeout((function(){R(!0)}),5)}),[n.storyLoaded]);var F=function(){document.getElementById("load-story-selector").click()},V=function(){M.devStartOver(a)},_=function(){var e=Object(b.a)(j.a.mark((function e(t){var n;return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=t.target.files[0]){e.next=3;break}return e.abrupt("return");case 3:X.loadStoryFromFile(a,n,q,z);case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),q=function(e){e.totalRows,e.completedRows},z=function(){h.b.success("Story imported successfully!")},U=function(){l(!s)},G=function(e){switch(e.key){case"1":a({type:"SET_APP_PAGE",payload:"CONFIG"});break;case"2":a({type:"SET_APP_PAGE",payload:"STORY"});break;case"3":a({type:"SET_APP_PAGE",payload:"PLAYMODE"})}};return Object(N.jsxs)(N.Fragment,{children:[Object(N.jsxs)(Z,{className:"app-nav",collapsible:!0,collapsed:s,onCollapse:U,children:[Object(N.jsx)("div",{className:"logo ".concat(s?"collapsed":""),children:Object(N.jsx)("img",{src:H,alt:"RPG Story Playtesting",onClick:U})}),Object(N.jsx)("div",{className:"menu-wrapper",children:P&&Object(N.jsxs)(f.a,{theme:"dark",mode:"inline",defaultSelectedKeys:n.storyLoaded?["1"]:[],onClick:G,children:[Object(N.jsx)(f.a.Item,{disabled:!n.storyLoaded,icon:Object(N.jsx)(v.a,{}),children:"Configuration"},"1"),Object(N.jsx)(f.a.Item,{disabled:!n.storyLoaded,icon:Object(N.jsx)(g.a,{}),children:"Story"},"2"),Object(N.jsx)(f.a.Item,{disabled:!n.storyLoaded,icon:Object(N.jsx)(w.a,{}),children:"Play"},"3")]})}),!s&&Object(N.jsx)(x.a,{gutter:16,style:{marginLeft:8,marginRight:8,marginTop:32},children:Object(N.jsxs)(y.a,{span:24,children:[!n.storyLoaded&&Object(N.jsx)(p.a,{type:"default",onClick:function(){L(!0)},block:!0,icon:Object(N.jsx)(k.a,{}),style:{marginBottom:12},children:"New story"}),Object(N.jsxs)(N.Fragment,{children:[n.storyLoaded?Object(N.jsx)(m.a,{title:function(){return Object(N.jsxs)("p",{children:["Download current story to avoid losing your changes.",Object(N.jsx)("br",{}),"Continue loading a new story?"]})},onConfirm:F,onCancel:function(){},okText:"Yes",cancelText:"No",placement:"right",children:Object(N.jsx)(p.a,{type:"default",block:!0,icon:Object(N.jsx)(A.a,{}),style:{marginBottom:12},children:"Load story"})}):Object(N.jsx)(p.a,{type:"default",block:!0,icon:Object(N.jsx)(A.a,{}),style:{marginBottom:12},onClick:F,children:"Load story"}),Object(N.jsx)("input",{type:"file",id:"load-story-selector",accept:".json",style:{display:"none"}})]}),n.storyLoaded&&Object(N.jsxs)(N.Fragment,{children:[Object(N.jsx)(p.a,{type:"default",block:!0,icon:Object(N.jsx)(D.a,{}),style:{marginBottom:12},onClick:function(){X.downloadStory(a)},children:"Download story"}),Object(N.jsx)(m.a,{title:"All data will be lost. Are you sure to delete this story?",onConfirm:V,onCancel:function(){},okText:"Yes",cancelText:"No",placement:"right",children:Object(N.jsx)(p.a,{type:"default",block:!0,icon:Object(N.jsx)(C.a,{}),style:{marginBottom:12},children:"Clear story"})})]}),function(){var e=Object(N.jsxs)("div",{children:[Object(N.jsx)(p.a,{type:"default",block:!0,style:{marginBottom:12},children:"Sample #1 (english)"}),Object(N.jsx)(p.a,{type:"default",block:!0,style:{marginBottom:12},children:"Sample #1 (spanish)"})]});return Object(N.jsx)(O.a,{placement:"right",title:"Select a story",content:e,trigger:"click",children:Object(N.jsx)(p.a,{type:"default",block:!0,icon:Object(N.jsx)(S.a,{}),style:{marginBottom:12},children:"Load samples"})})}(),Object(N.jsx)(p.a,{type:"default",block:!0,icon:Object(N.jsx)(E.a,{}),style:{marginBottom:12},onClick:function(){M.devStartOver(a)},children:"dev:startover"})]})})]}),Object(N.jsx)(K,{isDrawerVisible:I,onDrawerClose:function(){L(!1)}})]})},$=n(31),ee=(n(298),u.a.Header),te=s.a.Title,ne=s.a.Text,re=function(){var e=Object($.useLiveQuery)((function(){return z.stories.where("id").equals(1).first()}));return void 0===e?null:Object(N.jsxs)(ee,{className:"story-title",children:[Object(N.jsxs)(te,{level:5,children:["RPG-SP: ",e.title]}),Object(N.jsxs)(ne,{type:"secondary",children:["Version: ",e.version]})]})},ae=n.p+"static/media/jake-reading.fddcdec6.png",ce=(n(300),u.a.Content),ie=s.a.Text,oe=function(){return Object(N.jsxs)(ce,{className:"empty-project-page",children:[Object(N.jsx)("img",{src:ae,alt:"Start a new story"}),Object(N.jsx)(ie,{children:"Create a new story or load an existing one"})]})},se=n(173),le=(n(301),n(397)),ue=n(398),de=function(e){var t=e.isDrawerVisible,n=e.onDrawerClose,a=Object(r.useContext)(Q),c=Object(o.a)(a,2)[1],i=P.a.useForm(),s=Object(o.a)(i,1)[0],l=Object(r.useState)(!1),u=Object(o.a)(l,2),d=u[0],j=u[1];Object(r.useEffect)((function(){t&&(s.resetFields(),b())}),[t,s]);var b=function(){j(!0)},f=function(){j(!1),n&&n()};return Object(N.jsx)(R.a,{title:"Add Custom Entity",width:360,onClose:f,visible:d,bodyStyle:{paddingBottom:20},footer:Object(N.jsxs)("div",{style:{textAlign:"right"},children:[Object(N.jsx)(p.a,{onClick:f,style:{marginRight:8},children:"Cancel"}),Object(N.jsx)(p.a,{type:"primary",htmlType:"submit",form:"create-custom-entity-id",children:"Add"})]}),children:Object(N.jsxs)(P.a,{layout:"vertical",name:"create-custom-entity",id:"create-custom-entity-id",form:s,onFinish:function(e){var t=e.name.trim(),n=e.key.trim(),r=e.singular.trim();if(""===t||""===r)return f(),void h.b.error("Do not leave empty fields, sorry :(");var a={name:t,key:n,singular:r};M.createNewCustomEntityDef(c,a).then((function(e){f(),h.b.success("New entity created!")})).catch((function(e){f(),h.b.error("Something went wrong, sorry :(")}))},requiredMark:!1,children:[Object(N.jsx)(x.a,{gutter:16,children:Object(N.jsx)(y.a,{span:24,children:Object(N.jsx)(P.a.Item,{name:"name",label:"Name (use plural)",rules:[{required:!0,message:"Please enter a name"}],children:Object(N.jsx)(B.a,{placeholder:"Please enter a name",onChange:function(e){var t=e.target.value.toLowerCase().replace(/\s/g,"");s.setFieldsValue({key:t})}})})})}),Object(N.jsx)(x.a,{gutter:16,children:Object(N.jsx)(y.a,{span:24,children:Object(N.jsx)(P.a.Item,{name:"key",label:"Key",children:Object(N.jsx)(B.a,{readOnly:!0,placeholder:""})})})}),Object(N.jsx)(x.a,{gutter:16,children:Object(N.jsx)(y.a,{span:24,children:Object(N.jsx)(P.a.Item,{name:"singular",label:"Singular",rules:[{required:!0,message:"Please enter singular entity name"}],children:Object(N.jsx)(B.a,{placeholder:"Please enter singular entity name"})})})})]})})},je=n(380),be=n(377),he=n(172),fe=n.n(he),me=(n(356),function(e){var t=e.isDrawerVisible,n=e.onDrawerClose,a=Object(r.useContext)(Q),c=Object(o.a)(a,2)[1],i=Object(r.useState)(!1),s=Object(o.a)(i,2),l=s[0],u=s[1],d=Object(r.useState)({}),j=Object(o.a)(d,2),b=j[0],f=j[1],m=Object(r.useState)({}),O=Object(o.a)(m,2),v=O[0],g=O[1],w=Object(r.useState)(!0),A=Object(o.a)(w,2),C=A[0],S=A[1],k=Object($.useLiveQuery)((function(){return z.custom_entity_defs.toArray()})),D=Object($.useLiveQuery)((function(){return z.default_entity_colors.toArray()}));Object(r.useEffect)((function(){t&&E()}),[t]);var E=function(){f({}),g({}),u(!0)},P=function(){u(!1),n&&n()};return Object(N.jsxs)(R.a,{title:"Edit Colors",width:360,onClose:P,visible:l,bodyStyle:{paddingBottom:20},footer:Object(N.jsxs)("div",{style:{textAlign:"right"},children:[Object(N.jsx)(p.a,{onClick:P,style:{marginRight:8},children:"Cancel"}),Object(N.jsx)(p.a,{type:"primary",onClick:function(){if(S(!0),0!==Object.keys(b).length||0!==Object.keys(v).length){for(var e in b)M.updateDefaultEntityColor(c,parseInt(e),{color:b[e]}).then((function(e){})).catch((function(e){S(!1)}));for(var t in v)M.updateCustomEntityDefColor(c,parseInt(t),{color:v[t]}).then((function(e){})).catch((function(e){S(!1)}));C?(P(),h.b.success("Colors updated!")):(P(),h.b.error("Something went wrong, sorry :("))}else P()},children:"Update"})]}),children:[void 0!==D&&D.length>0&&Object(N.jsx)(je.b,{dataSource:D,renderItem:function(e){return Object(N.jsx)(je.b.Item,{className:"default-ent-color-list-item",children:Object(N.jsxs)(x.a,{style:{width:"100%"},children:[Object(N.jsx)(y.a,{span:18,style:{textTransform:"capitalize"},children:e.name}),Object(N.jsx)(y.a,{span:6,style:{textAlign:"right"},children:Object(N.jsx)(fe.a,{animation:"slide-up",placement:"bottomRight",enableAlpha:!1,color:e.color,onChange:function(t){!function(e,t){var n=b;n[e]=t,f(n)}(e.id,t.color)}})})]})})}}),void 0!==k&&k.length>0&&Object(N.jsxs)(N.Fragment,{children:[Object(N.jsx)(be.a,{style:{margin:"0"}}),Object(N.jsx)(je.b,{dataSource:k,renderItem:function(e){return Object(N.jsx)(je.b.Item,{className:"custom-ent-color-list-item",children:Object(N.jsxs)(x.a,{style:{width:"100%"},children:[Object(N.jsx)(y.a,{span:18,children:e.name}),Object(N.jsx)(y.a,{span:6,style:{textAlign:"right"},children:Object(N.jsx)(fe.a,{animation:"slide-up",placement:"bottomRight",enableAlpha:!1,color:e.color,onChange:function(t){!function(e,t){var n=v;n[e]=t,g(n)}(e.id,t.color)}})})]})})}})]})]})}),pe=(n(362),function(e){var t,n=e.gameState,r=e.onEditGameStateProp,a=void 0===r?function(){}:r,c=e.onRemoveGameStateProp,i=void 0===c?function(){}:c;return t=n.type.endsWith("arr")?"[ "+n.default+" ]":n.default,Object(N.jsx)(je.b.Item,{className:"game-state-list-item",children:Object(N.jsxs)(x.a,{children:[Object(N.jsx)(y.a,{span:6,children:n.name}),Object(N.jsx)(y.a,{span:6,children:n.type}),Object(N.jsx)(y.a,{span:8,children:t}),Object(N.jsxs)(y.a,{span:4,style:{textAlign:"right"},children:["none"!==n.edit_mode&&Object(N.jsx)(p.a,{type:"link",size:"small",onClick:function(){a()},children:"Edit"}),n.removable&&Object(N.jsx)(m.a,{title:"Are you sure you want to remove this game state prop?",onConfirm:function(){i()},onCancel:function(){},okText:"Yes",cancelText:"No",placement:"bottomRight",children:Object(N.jsx)(p.a,{type:"link",size:"small",children:"Remove"})})]})]})})}),Oe=n(62),xe=n(117),ye=n(381),ve=n(388),ge=function(){function e(){Object(V.a)(this,e)}return Object(_.a)(e,null,[{key:"validateEntityNames",value:function(){var e=Object(b.a)(j.a.mark((function e(t,n){var r;return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=[],e.abrupt("return",z.transaction("r",n,Object(b.a)(j.a.mark((function e(){var a,c,i;return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:a=Object(Oe.a)(t),e.prev=1,a.s();case 3:if((c=a.n()).done){e.next=11;break}return i=c.value,e.next=7,n.where({name:i}).first();case 7:void 0===e.sent&&r.push(i);case 9:e.next=3;break;case 11:e.next=16;break;case 13:e.prev=13,e.t0=e.catch(1),a.e(e.t0);case 16:return e.prev=16,a.f(),e.finish(16);case 19:if(0!==r.length){e.next=23;break}return e.abrupt("return",Promise.resolve());case 23:return e.abrupt("return",Promise.reject(r));case 24:case"end":return e.stop()}}),e,null,[[1,13,16,19]])})))));case 2:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}()},{key:"validateCustomEntityNames",value:function(){var e=Object(b.a)(j.a.mark((function e(t,n){var r;return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=[],e.abrupt("return",z.transaction("r",z.custom_entities,Object(b.a)(j.a.mark((function e(){var a,c,i;return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:a=Object(Oe.a)(t),e.prev=1,a.s();case 3:if((c=a.n()).done){e.next=11;break}return i=c.value,e.next=7,z.custom_entities.where({name:i,custom_entity_def_id:n}).first();case 7:void 0===e.sent&&r.push(i);case 9:e.next=3;break;case 11:e.next=16;break;case 13:e.prev=13,e.t0=e.catch(1),a.e(e.t0);case 16:return e.prev=16,a.f(),e.finish(16);case 19:if(0!==r.length){e.next=23;break}return e.abrupt("return",Promise.resolve());case 23:return e.abrupt("return",Promise.reject(r));case 24:case"end":return e.stop()}}),e,null,[[1,13,16,19]])})))));case 2:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}()}]),e}(),we=B.a.TextArea,Ae=xe.a.Option,Ce=function(e){var t=e.gameStateProp,n=void 0===t?null:t,a=e.isDrawerVisible,c=e.onDrawerClose,i=Object(r.useContext)(Q),s=Object(o.a)(i,2)[1],l=P.a.useForm(),u=Object(o.a)(l,1)[0],d=Object(r.useState)(!1),j=Object(o.a)(d,2),b=j[0],f=j[1],m=Object(r.useState)(""),O=Object(o.a)(m,2),v=O[0],g=O[1],w=Object(r.useState)(""),A=Object(o.a)(w,2),C=A[0],S=A[1],k=Object(r.useState)(0),D=Object(o.a)(k,2),E=D[0],T=D[1],I=Object(r.useState)(!0),L=Object(o.a)(I,2),F=L[0],V=L[1],_=Object(r.useState)(""),q=Object(o.a)(_,2),U=q[0],K=q[1],G=Object(r.useState)(!0),Y=Object(o.a)(G,2),J=Y[0],X=Y[1],H=Object($.useLiveQuery)((function(){return z.custom_entity_defs.toArray()}));Object(r.useEffect)((function(){a&&(u.resetFields(),S(""),n&&(u.setFieldsValue({name:n.name,type:n.type}),S(n.type),function(e){if(C.endsWith("arr")){if(0===e.length)return;var t=e.split(",");switch(C){case"intarr":case"booleanarr":u.setFieldsValue({defaultValueArray:t.join("\n")});break;case"stringarr":case"locationarr":case"areaarr":case"characterarr":default:var n,r=[],a=Object(Oe.a)(t);try{for(a.s();!(n=a.n()).done;){var c=n.value;r.push(c.slice(1,-1))}}catch(i){a.e(i)}finally{a.f()}u.setFieldsValue({defaultValueArray:r.join("\n")})}}else switch(C){case"int":u.setFieldsValue({defaultValueInt:e});break;case"boolean":u.setFieldsValue({defaultValueBool:e}),V(e);break;case"string":case"location":case"area":case"character":default:u.setFieldsValue({defaultValueString:e})}}(n.default)),Z())}),[a,u,n]);var Z=function(){f(!0)},W=function(){f(!1),c&&c()},ee=function(){return""!==C&&"int"!==C&&"boolean"!==C&&!C.endsWith("arr")},te=function(){var e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];switch(C){case"intarr":return e?"int[]":"Place one integer per line";case"booleanarr":return e?"boolean[]":"Place one boolean per line";case"stringarr":return e?"string[]":"Place one string per line";case"locationarr":return e?"location[]":"Place one location per line";case"areaarr":return e?"area[]":"Place one area per line";case"characterarr":return e?"character[]":"Place one character per line";default:if(C.endsWith("arr")){var t=C.slice(0,-3);return e?t+"[]":"Place one "+t+" per line"}return e?"[]":"Place one item per line"}},ne=function(e){var t=e.defaultValueArray;if(0===t.length)re(e);else{var n=t.split("\n");switch(C){case"intarr":var r,a=Object(Oe.a)(n);try{for(a.s();!(r=a.n()).done;){var c=r.value;if(!Number.isInteger(parseInt(c)))return void h.b.error("All values in array must be integers")}}catch(b){a.e(b)}finally{a.f()}re(e);break;case"booleanarr":var i,o=Object(Oe.a)(n);try{for(o.s();!(i=o.n()).done;){var s=i.value;if("true"!==s&&"false"!==s)return void h.b.error('All values in array must be "true" or "false"')}}catch(b){o.e(b)}finally{o.f()}re(e);break;case"stringarr":var l,u=Object(Oe.a)(n);try{for(u.s();!(l=u.n()).done;){if(""===l.value.trim())return void h.b.error("Do not leave empty strings (just spaces are considered empty)")}}catch(b){u.e(b)}finally{u.f()}re(e);break;case"locationarr":ge.validateEntityNames(n,z.locations).then((function(){re(e)})).catch((function(e){h.b.error("Invalid values: "+e.join(", "))}));break;case"areaarr":ge.validateEntityNames(n,z.areas).then((function(){re(e)})).catch((function(e){h.b.error("Invalid values: "+e.join(", "))}));break;case"characterarr":ge.validateEntityNames(n,z.characters).then((function(){re(e)})).catch((function(e){h.b.error("Invalid values: "+e.join(", "))}));break;default:var d=C.slice(0,-3),j=H.find((function(e){return e.singular_name===d}));j&&ge.validateCustomEntityNames(n,j.id).then((function(){re(e)})).catch((function(e){h.b.error("Invalid values: "+e.join(", "))}))}}},re=function(e){if(null===n){var t=e.name.trim(),r=ae(e),a={name:t,type:C,defaultValue:r,editMode:"name|default",removable:!0};M.createNewGameStateProp(s,a).then((function(e){W(),h.b.success("New game state prop created!")})).catch((function(e){W(),h.b.error("Something went wrong, sorry :(")}))}else{var c=e.name.trim(),i=ae(e),o=n.edit_mode,l=n.removable,u={name:c,type:C,defaultValue:i,editMode:o,removable:l};M.updateGameStateProp(s,n.id,u).then((function(e){W(),h.b.success("Game state prop edited!")})).catch((function(e){W(),h.b.error("Something went wrong, sorry :(")}))}},ae=function(e){if(C.endsWith("arr")){var t=e.defaultValueArray;if(0===t.length)return"";var n=t.split("\n");switch(C){case"intarr":case"booleanarr":return n.join(",");case"stringarr":case"locationarr":case"areaarr":case"characterarr":default:var r,a=[],c=Object(Oe.a)(n);try{for(c.s();!(r=c.n()).done;){var i=r.value;a.push('"'+i+'"')}}catch(o){c.e(o)}finally{c.f()}return a.join(",")}}else switch(C){case"int":return parseInt(e.defaultValueInt);case"boolean":return e.defaultValueBool;case"string":case"location":case"area":case"character":default:return e.defaultValueString}},ce=function(){if(null===n)return!1;var e=n.edit_mode.split("|");return e.indexOf("all")<0&&e.indexOf("default")<0};return Object(N.jsx)(R.a,{title:null===n?"New prop":"Edit prop",width:360,onClose:W,visible:b,bodyStyle:{paddingBottom:20},footer:Object(N.jsxs)("div",{style:{textAlign:"right"},children:[Object(N.jsx)(p.a,{onClick:W,style:{marginRight:8},children:"Cancel"}),Object(N.jsx)(p.a,{type:"primary",htmlType:"submit",form:"add-edit-game-state-prop-id",children:null===n?"Create":"Update"})]}),children:Object(N.jsxs)(P.a,{layout:"vertical",name:"add-edit-game-state-prop",id:"add-edit-game-state-prop-id",form:u,onFinish:function(e){if(""!==e.name.trim())switch(C){case"int":Number.isInteger(parseInt(e.defaultValueInt))?re(e):h.b.error("Default is not an integer");break;case"boolean":case"string":re(e);break;case"location":var t=e.defaultValueString.trim();ge.validateEntityNames([t],z.locations).then((function(){re(e)})).catch((function(e){h.b.error("Invalid values: "+e.join(", "))}));break;case"area":var n=e.defaultValueString.trim();ge.validateEntityNames([n],z.areas).then((function(){re(e)})).catch((function(e){h.b.error("Invalid values: "+e.join(", "))}));break;case"character":var r=e.defaultValueString.trim();ge.validateEntityNames([r],z.characters).then((function(){re(e)})).catch((function(e){h.b.error("Invalid values: "+e.join(", "))}));break;default:if(C.endsWith("arr"))ne(e);else if("boolean"!==C&&"string"!==C){var a=H.find((function(e){return e.singular_name===C}));if(a){var c=e.defaultValueString.trim();ge.validateCustomEntityNames([c],a.id).then((function(){re(e)})).catch((function(e){h.b.error("Invalid values: "+e.join(", "))}))}}}else h.b.error("Do not leave name empty")},requiredMark:!1,children:[Object(N.jsx)(x.a,{gutter:16,children:Object(N.jsx)(y.a,{span:24,children:Object(N.jsx)(P.a.Item,{name:"name",label:"Name",rules:[{required:!0,message:"Please enter a name"}],children:Object(N.jsx)(B.a,{placeholder:"Please enter a name",value:v,onChange:function(e){g(e.target.value)},disabled:function(){if(null===n)return!1;var e=n.edit_mode.split("|");return e.indexOf("all")<0&&e.indexOf("name")<0}()})})})}),Object(N.jsx)(x.a,{gutter:16,children:Object(N.jsx)(y.a,{span:24,children:Object(N.jsx)(P.a.Item,{name:"type",label:"Type",rules:[{required:!0,message:"Please select a type"}],children:Object(N.jsxs)(xe.a,{value:C,onChange:function(e){var t;"int"===(t=e)&&u.setFieldsValue({defaultValueInt:""}),"boolean"===t&&u.setFieldsValue({defaultValueBool:F}),t.endsWith("arr")&&u.setFieldsValue({defaultValueArray:""}),""===t||"int"===t||"boolean"===t||t.endsWith("arr")||u.setFieldsValue({defaultValueString:""}),S(t)},disabled:function(){if(null===n)return!1;var e=n.edit_mode.split("|");return e.indexOf("all")<0&&e.indexOf("type")<0}(),children:[Object(N.jsx)(Ae,{value:"int",children:"int"}),Object(N.jsx)(Ae,{value:"intarr",children:"int[]"}),Object(N.jsx)(Ae,{value:"boolean",children:"boolean"}),Object(N.jsx)(Ae,{value:"booleanarr",children:"boolean[]"}),Object(N.jsx)(Ae,{value:"string",children:"string"}),Object(N.jsx)(Ae,{value:"stringarr",children:"string[]"}),Object(N.jsx)(Ae,{value:"location",children:"location"}),Object(N.jsx)(Ae,{value:"locationarr",children:"location[]"}),Object(N.jsx)(Ae,{value:"area",children:"area"}),Object(N.jsx)(Ae,{value:"areaarr",children:"area[]"}),Object(N.jsx)(Ae,{value:"character",children:"character"}),Object(N.jsx)(Ae,{value:"characterarr",children:"character[]"}),void 0!==H&&H.map((function(e){return Object(N.jsxs)(N.Fragment,{children:[Object(N.jsx)(Ae,{value:e.singular_name,children:e.singular_name}),Object(N.jsxs)(Ae,{value:e.singular_name+"arr",children:[e.singular_name,"[]"]})]})}))]})})})}),Object(N.jsx)(x.a,{gutter:16,style:{display:"int"===C?"block":"none"},children:Object(N.jsx)(y.a,{span:24,children:Object(N.jsx)(P.a.Item,{name:"defaultValueInt",label:"Default value (int)",rules:[{required:"int"===C,message:"Please enter an integer"}],children:Object(N.jsx)(ye.a,{disabled:ce(),placeholder:"Please enter an integer",value:E,onChange:function(e){T(e)},style:{width:"100%"}})})})}),Object(N.jsx)(x.a,{gutter:16,style:{display:"boolean"===C?"block":"none"},children:Object(N.jsx)(y.a,{span:24,children:Object(N.jsx)(P.a.Item,{name:"defaultValueBool",label:"Default value (boolean)",children:Object(N.jsx)(ve.a,{disabled:ce(),checkedChildren:"true",unCheckedChildren:"false",checked:F,defaultChecked:!0,onChange:function(e){V(e)}})})})}),Object(N.jsx)(x.a,{gutter:16,style:{display:ee()?"block":"none"},children:Object(N.jsx)(y.a,{span:24,children:Object(N.jsx)(P.a.Item,{name:"defaultValueString",label:"Default value (string)",rules:[{required:ee()&&"string"!==C,message:"Please enter a default value"}],children:Object(N.jsx)(B.a,{disabled:ce(),placeholder:"Please enter a default value",value:U,onChange:function(e){K(e.target.value)}})})})}),Object(N.jsx)(x.a,{gutter:16,style:{display:C.endsWith("arr")?"block":"none"},children:Object(N.jsx)(y.a,{span:24,children:Object(N.jsx)(P.a.Item,{name:"defaultValueArray",label:"Default value ("+te()+")",children:Object(N.jsx)(we,{disabled:ce(),rows:10,placeholder:te(!1)+" Leave empty for empty array.",value:J,onChange:function(e){X(e.target.value)}})})})})]})})},Se=s.a.Text,ke=function(){var e=Object(r.useContext)(Q),t=Object(o.a)(e,2)[1],n=Object(r.useState)(!1),a=Object(o.a)(n,2),c=a[0],i=a[1],s=Object(r.useState)(null),l=Object(o.a)(s,2),u=l[0],d=l[1],j=Object($.useLiveQuery)((function(){return z.game_state_props.toArray()})),b=Object(N.jsxs)(x.a,{children:[Object(N.jsx)(y.a,{span:6,children:Object(N.jsx)(Se,{strong:!0,children:"Name"})}),Object(N.jsx)(y.a,{span:6,children:Object(N.jsx)(Se,{strong:!0,children:"Type"})}),Object(N.jsx)(y.a,{span:8,children:Object(N.jsx)(Se,{strong:!0,children:"Default"})}),Object(N.jsx)(y.a,{span:4})]});return Object(N.jsxs)("div",{children:[void 0!==j&&j.length>0&&Object(N.jsx)(je.b,{style:{marginBottom:"20px",maxWidth:"94%"},header:b,dataSource:j,renderItem:function(e){return Object(N.jsx)(pe,{gameState:e,onEditGameStateProp:function(){d(e),i(!0)},onRemoveGameStateProp:function(){var n;n=e,M.deleteGameStateProp(t,n.id).then((function(e){h.b.success("Game state prop removed!")})).catch((function(e){h.b.error("Something went wrong, sorry :(")}))}})}}),Object(N.jsx)(p.a,{type:"primary",onClick:function(){d(null),i(!0)},children:"Add Game State Prop"}),Object(N.jsx)(Ce,{gameStateProp:u,isDrawerVisible:c,onDrawerClose:function(){i(!1)}})]})},De=n(387),Ee=(n(363),s.a.Text),Pe=function(e){var t=e.location,n=e.canEdit,r=void 0===n||n,a=e.canRemove,c=void 0===a||a,i=e.onRemove,o=void 0===i?function(){}:i,s=e.onEdit,l=void 0===s?function(){}:s,u=e.onAddArea,d=void 0===u?function(){}:u,j=e.onEditArea,b=void 0===j?function(){}:j,h=e.onRemoveArea,f=void 0===h?function(){}:h,O=Object($.useLiveQuery)((function(){return z.areas.where("location_id").equals(t.id).toArray()})),v=[];r&&v.push(Object(N.jsx)(p.a,{type:"link",size:"small",onClick:l,children:"Edit"},"edit-location")),c&&v.push(Object(N.jsx)(m.a,{title:"Are you sure you want to remove this location and all its areas?",onConfirm:o,onCancel:function(){},okText:"Yes",cancelText:"No",placement:"bottomRight",children:Object(N.jsx)(p.a,{type:"link",size:"small",children:"Remove"})},"remove-location"));var g=Object(N.jsxs)(x.a,{children:[Object(N.jsx)(y.a,{span:6,children:Object(N.jsx)(Ee,{strong:!0,children:"Area Name"})}),Object(N.jsx)(y.a,{span:12,children:Object(N.jsx)(Ee,{strong:!0,children:"Description"})}),Object(N.jsx)(y.a,{span:6})]});return Object(N.jsxs)(De.a,{className:"location-view",size:"small",title:t.name,extra:v,headStyle:{background:"#f5f5f5"},children:[Object(N.jsx)(Ee,{children:t.description}),Object(N.jsx)(be.a,{}),void 0!==O&&O.length>0&&Object(N.jsx)(je.b,{header:g,dataSource:O,renderItem:function(e){return Object(N.jsx)(je.b.Item,{className:"area-list-item",children:Object(N.jsxs)(x.a,{children:[Object(N.jsx)(y.a,{span:6,children:e.name}),Object(N.jsx)(y.a,{span:12,children:e.description}),Object(N.jsxs)(y.a,{span:6,style:{textAlign:"right"},children:[Object(N.jsx)(p.a,{type:"link",size:"small",onClick:function(){b(e)},children:"Edit"}),Object(N.jsx)(m.a,{title:"Are you sure you want to remove this area?",onConfirm:function(){f(e)},onCancel:function(){},okText:"Yes",cancelText:"No",placement:"bottomRight",children:Object(N.jsx)(p.a,{type:"link",size:"small",children:"Remove"})})]})]})})}}),Object(N.jsx)(p.a,{type:"default",size:"small",onClick:d,children:"Add Area"})]})},Re=B.a.TextArea,Be=function(e){var t=e.location,n=void 0===t?null:t,a=e.isDrawerVisible,c=e.onDrawerClose,i=Object(r.useContext)(Q),s=Object(o.a)(i,2)[1],l=P.a.useForm(),u=Object(o.a)(l,1)[0],d=Object(r.useState)(!1),j=Object(o.a)(d,2),b=j[0],f=j[1],m=Object(r.useState)(""),O=Object(o.a)(m,2),v=O[0],g=O[1],w=Object(r.useState)(""),A=Object(o.a)(w,2),C=A[0],S=A[1];Object(r.useEffect)((function(){a&&(u.resetFields(),n&&u.setFieldsValue({name:n.name,description:n.description}),k())}),[a,u,n]);var k=function(){f(!0)},D=function(){f(!1),c&&c()};return Object(N.jsx)(R.a,{title:null===n?"New location":"Edit location",width:360,onClose:D,visible:b,bodyStyle:{paddingBottom:20},footer:Object(N.jsxs)("div",{style:{textAlign:"right"},children:[Object(N.jsx)(p.a,{onClick:D,style:{marginRight:8},children:"Cancel"}),Object(N.jsx)(p.a,{type:"primary",htmlType:"submit",form:"add-edit-location-id",children:null===n?"Create":"Update"})]}),children:Object(N.jsxs)(P.a,{layout:"vertical",name:"add-edit-location",id:"add-edit-location-id",form:u,onFinish:function(e){var t=e.name.trim(),r=e.description.trim();if(""===t||""===r)return D(),void h.b.error("Do not leave empty fields, sorry :(");var a={name:t,description:r};null===n?M.createNewLocation(s,a).then((function(e){D(),h.b.success("New location created!")})).catch((function(e){D(),h.b.error("Something went wrong, sorry :(")})):M.updateLocation(s,n.id,a).then((function(e){D(),h.b.success("Location edited!")})).catch((function(e){D(),h.b.error("Something went wrong, sorry :(")}))},requiredMark:!1,children:[Object(N.jsx)(x.a,{gutter:16,children:Object(N.jsx)(y.a,{span:24,children:Object(N.jsx)(P.a.Item,{name:"name",label:"Name",rules:[{required:!0,message:"Please enter a name"}],children:Object(N.jsx)(B.a,{placeholder:"Please enter a name",value:v,onChange:function(e){g(e.target.value)}})})})}),Object(N.jsx)(x.a,{gutter:16,children:Object(N.jsx)(y.a,{span:24,children:Object(N.jsx)(P.a.Item,{name:"description",label:"Description",rules:[{required:!0,message:"Please enter a description"}],children:Object(N.jsx)(Re,{rows:10,placeholder:"Please enter a description",value:C,onChange:function(e){S(e.target.value)}})})})})]})})},Te=B.a.TextArea,Ie=function(e){var t=e.area,n=void 0===t?null:t,a=e.location,c=e.isDrawerVisible,i=e.onDrawerClose,s=Object(r.useContext)(Q),l=Object(o.a)(s,2)[1],u=P.a.useForm(),d=Object(o.a)(u,1)[0],j=Object(r.useState)(!1),b=Object(o.a)(j,2),f=b[0],m=b[1],O=Object(r.useState)(""),v=Object(o.a)(O,2),g=v[0],w=v[1],A=Object(r.useState)(""),C=Object(o.a)(A,2),S=C[0],k=C[1];Object(r.useEffect)((function(){c&&(d.resetFields(),n&&d.setFieldsValue({name:n.name,description:n.description}),D())}),[c,d,n]);var D=function(){m(!0)},E=function(){m(!1),i&&i()};return Object(N.jsx)(R.a,{title:(null===n?"New area":"Edit area")+" in "+(a&&a.name),width:360,onClose:E,visible:f,bodyStyle:{paddingBottom:20},footer:Object(N.jsxs)("div",{style:{textAlign:"right"},children:[Object(N.jsx)(p.a,{onClick:E,style:{marginRight:8},children:"Cancel"}),Object(N.jsx)(p.a,{type:"primary",htmlType:"submit",form:"add-edit-area-id",children:null===n?"Create":"Update"})]}),children:Object(N.jsxs)(P.a,{layout:"vertical",name:"add-edit-area",id:"add-edit-area-id",form:d,onFinish:function(e){var t=e.name.trim(),r=e.description.trim();if(""===t||""===r)return E(),void h.b.error("Do not leave empty fields, sorry :(");var c={name:t,description:r};null===n?(c.location_id=a.id,M.createNewArea(l,c).then((function(e){E(),h.b.success("New area created!")})).catch((function(e){E(),h.b.error("Something went wrong, sorry :(")}))):M.updateArea(l,n.id,c).then((function(e){E(),h.b.success("Area edited!")})).catch((function(e){E(),h.b.error("Something went wrong, sorry :(")}))},requiredMark:!1,children:[Object(N.jsx)(x.a,{gutter:16,children:Object(N.jsx)(y.a,{span:24,children:Object(N.jsx)(P.a.Item,{name:"name",label:"Name",rules:[{required:!0,message:"Please enter a name"}],children:Object(N.jsx)(B.a,{placeholder:"Please enter a name",value:g,onChange:function(e){w(e.target.value)}})})})}),Object(N.jsx)(x.a,{gutter:16,children:Object(N.jsx)(y.a,{span:24,children:Object(N.jsx)(P.a.Item,{name:"description",label:"Description",rules:[{required:!0,message:"Please enter a description"}],children:Object(N.jsx)(Te,{rows:10,placeholder:"Please enter a description",value:S,onChange:function(e){k(e.target.value)}})})})})]})})},Ne=function(){var e=Object(r.useContext)(Q),t=Object(o.a)(e,2)[1],n=Object(r.useState)(!1),a=Object(o.a)(n,2),c=a[0],i=a[1],s=Object(r.useState)(!1),l=Object(o.a)(s,2),u=l[0],d=l[1],j=Object(r.useState)(null),b=Object(o.a)(j,2),f=b[0],m=b[1],O=Object(r.useState)(null),x=Object(o.a)(O,2),y=x[0],v=x[1],g=Object($.useLiveQuery)((function(){return z.locations.toArray()}));return Object(N.jsxs)("div",{children:[void 0!==g&&g.map((function(e){return Object(N.jsx)(Pe,{location:e,onRemove:function(){!function(e){M.deleteLocation(t,e.id).then((function(e){h.b.success("Location removed!")})).catch((function(e){h.b.error("Something went wrong, sorry :(")}))}(e)},onEdit:function(){!function(e){m(e),i(!0)}(e)},onAddArea:function(){!function(e){v(null),m(e),d(!0)}(e)},onEditArea:function(t){!function(e,t){m(t),v(e),d(!0)}(t,e)},onRemoveArea:function(e){!function(e){M.deleteArea(t,e.id).then((function(e){h.b.success("Area removed!")})).catch((function(e){h.b.error("Something went wrong, sorry :(")}))}(e)}},e.id)})),Object(N.jsx)(p.a,{type:"primary",onClick:function(){m(null),i(!0)},children:"Add Location"}),Object(N.jsx)(Be,{location:f,isDrawerVisible:c,onDrawerClose:function(){i(!1)}}),Object(N.jsx)(Ie,{area:y,location:f,isDrawerVisible:u,onDrawerClose:function(){d(!1)}})]})},Le=(n(364),s.a.Text),Qe=function(e){var t=e.entity,n=e.entityName,r=void 0===n?"entity":n,a=e.canEdit,c=void 0===a||a,i=e.canRemove,o=void 0===i||i,s=e.onRemove,l=void 0===s?function(){}:s,u=e.onEdit,d=void 0===u?function(){}:u,j=[];return c&&j.push(Object(N.jsx)(p.a,{type:"link",size:"small",onClick:d,children:"Edit"},"edit-entity")),o&&j.push(Object(N.jsx)(m.a,{title:"Are you sure you want to remove this ".concat(r,"?"),onConfirm:l,onCancel:function(){},okText:"Yes",cancelText:"No",placement:"bottomRight",children:Object(N.jsx)(p.a,{type:"link",size:"small",children:"Remove"})},"remove-entity")),Object(N.jsx)(De.a,{className:"simple-entity-view",size:"small",title:t.name,extra:j,headStyle:{background:"#f5f5f5"},children:Object(N.jsx)(Le,{children:t.description})})},Fe=B.a.TextArea,Ve=function(e){var t=e.character,n=void 0===t?null:t,a=e.isDrawerVisible,c=e.onDrawerClose,i=Object(r.useContext)(Q),s=Object(o.a)(i,2)[1],l=P.a.useForm(),u=Object(o.a)(l,1)[0],d=Object(r.useState)(!1),j=Object(o.a)(d,2),b=j[0],f=j[1],m=Object(r.useState)(""),O=Object(o.a)(m,2),v=O[0],g=O[1],w=Object(r.useState)(""),A=Object(o.a)(w,2),C=A[0],S=A[1];Object(r.useEffect)((function(){a&&(u.resetFields(),n&&u.setFieldsValue({name:n.name,description:n.description}),k())}),[a,u,n]);var k=function(){f(!0)},D=function(){f(!1),c&&c()};return Object(N.jsx)(R.a,{title:null===n?"New character":"Edit character",width:360,onClose:D,visible:b,bodyStyle:{paddingBottom:20},footer:Object(N.jsxs)("div",{style:{textAlign:"right"},children:[Object(N.jsx)(p.a,{onClick:D,style:{marginRight:8},children:"Cancel"}),Object(N.jsx)(p.a,{type:"primary",htmlType:"submit",form:"add-edit-character-id",children:null===n?"Create":"Update"})]}),children:Object(N.jsxs)(P.a,{layout:"vertical",name:"add-edit-character",id:"add-edit-character-id",form:u,onFinish:function(e){var t=e.name.trim(),r=e.description.trim();if(""===t||""===r)return D(),void h.b.error("Do not leave empty fields, sorry :(");var a={name:t,description:r};null===n?M.createNewCharacter(s,a).then((function(e){D(),h.b.success("New character created!")})).catch((function(e){D(),h.b.error("Something went wrong, sorry :(")})):M.updateCharacter(s,n.id,a).then((function(e){D(),h.b.success("Character edited!")})).catch((function(e){D(),h.b.error("Something went wrong, sorry :(")}))},requiredMark:!1,children:[Object(N.jsx)(x.a,{gutter:16,children:Object(N.jsx)(y.a,{span:24,children:Object(N.jsx)(P.a.Item,{name:"name",label:"Name",rules:[{required:!0,message:"Please enter a name"}],children:Object(N.jsx)(B.a,{placeholder:"Please enter a name",value:v,onChange:function(e){g(e.target.value)}})})})}),Object(N.jsx)(x.a,{gutter:16,children:Object(N.jsx)(y.a,{span:24,children:Object(N.jsx)(P.a.Item,{name:"description",label:"Description",rules:[{required:!0,message:"Please enter a description"}],children:Object(N.jsx)(Fe,{rows:10,placeholder:"Please enter a description",value:C,onChange:function(e){S(e.target.value)}})})})})]})})},_e=function(){var e=Object(r.useContext)(Q),t=Object(o.a)(e,2)[1],n=Object(r.useState)(!1),a=Object(o.a)(n,2),c=a[0],i=a[1],s=Object(r.useState)(null),l=Object(o.a)(s,2),u=l[0],d=l[1],j=Object($.useLiveQuery)((function(){return z.characters.toArray()}));return Object(N.jsxs)("div",{children:[void 0!==j&&j.map((function(e){return Object(N.jsx)(Qe,{entity:e,entityName:"character",onRemove:function(){!function(e){M.deleteCharacter(t,e.id).then((function(e){h.b.success("Character removed!")})).catch((function(e){h.b.error("Something went wrong, sorry :(")}))}(e)},onEdit:function(){!function(e){d(e),i(!0)}(e)}},e.id)})),Object(N.jsx)(p.a,{type:"primary",onClick:function(){d(null),i(!0)},children:"Add Character"}),Object(N.jsx)(Ve,{character:u,isDrawerVisible:c,onDrawerClose:function(){i(!1)}})]})},qe=B.a.TextArea,ze=function(e){var t=e.entity,n=void 0===t?null:t,a=e.entityDef,c=e.isDrawerVisible,i=e.onDrawerClose,s=Object(r.useContext)(Q),l=Object(o.a)(s,2)[1],u=P.a.useForm(),d=Object(o.a)(u,1)[0],j=Object(r.useState)(!1),b=Object(o.a)(j,2),f=b[0],m=b[1],O=Object(r.useState)(""),v=Object(o.a)(O,2),g=v[0],w=v[1],A=Object(r.useState)(""),C=Object(o.a)(A,2),S=C[0],k=C[1],D=a.singular_name.toLowerCase().charAt(0).toUpperCase()+a.singular_name.toLowerCase().slice(1);Object(r.useEffect)((function(){c&&(d.resetFields(),n&&d.setFieldsValue({name:n.name,description:n.description}),E())}),[c,d,n]);var E=function(){m(!0)},T=function(){m(!1),i&&i()};return Object(N.jsx)(R.a,{title:(null===n?"New":"Edit")+" "+a.singular_name.toLowerCase(),width:360,onClose:T,visible:f,bodyStyle:{paddingBottom:20},footer:Object(N.jsxs)("div",{style:{textAlign:"right"},children:[Object(N.jsx)(p.a,{onClick:T,style:{marginRight:8},children:"Cancel"}),Object(N.jsx)(p.a,{type:"primary",htmlType:"submit",form:"add-edit-custom-entity-id-"+a.key,children:null===n?"Create":"Update"})]}),children:Object(N.jsxs)(P.a,{layout:"vertical",name:"add-edit-custom-entity-"+a.key,id:"add-edit-custom-entity-id-"+a.key,form:d,onFinish:function(e){!function(e){var t=e.name.trim(),r=e.description.trim();if(""===t||""===r)return T(),void h.b.error("Do not leave empty fields, sorry :(");var c={name:t,description:r};null===n?(c.custom_entity_def_id=a.id,M.createNewCustomEntity(l,c).then((function(e){T(),h.b.success("New "+a.singular_name.toLowerCase()+" created!")})).catch((function(e){T(),h.b.error("Something went wrong, sorry :(")}))):M.updateCustomEntity(l,n.id,c).then((function(e){T(),h.b.success(D+" edited!")})).catch((function(e){T(),h.b.error("Something went wrong, sorry :(")}))}(e)},requiredMark:!1,children:[Object(N.jsx)(x.a,{gutter:16,children:Object(N.jsx)(y.a,{span:24,children:Object(N.jsx)(P.a.Item,{name:"name",label:"Name",rules:[{required:!0,message:"Please enter a name"}],children:Object(N.jsx)(B.a,{placeholder:"Please enter a name",value:g,onChange:function(e){w(e.target.value)}})})})}),Object(N.jsx)(x.a,{gutter:16,children:Object(N.jsx)(y.a,{span:24,children:Object(N.jsx)(P.a.Item,{name:"description",label:"Description",rules:[{required:!0,message:"Please enter a description"}],children:Object(N.jsx)(qe,{rows:10,placeholder:"Please enter a description",value:S,onChange:function(e){k(e.target.value)}})})})})]})})},Ue=function(e){var t=e.entityDef,n=Object(r.useContext)(Q),a=Object(o.a)(n,2)[1],c=t.singular_name.toLowerCase().charAt(0).toUpperCase()+t.singular_name.toLowerCase().slice(1),i=Object(r.useState)(!1),s=Object(o.a)(i,2),l=s[0],u=s[1],d=Object(r.useState)(null),j=Object(o.a)(d,2),b=j[0],f=j[1],O=Object($.useLiveQuery)((function(){return z.custom_entities.where("custom_entity_def_id").equals(t.id).toArray()}));return Object(N.jsxs)("div",{children:[Object(N.jsx)("div",{style:{textAlign:"right",marginBottom:"20px"},children:Object(N.jsx)(m.a,{title:"This section and all its content will be removed!! Are you sure you want to remove this entity?",onConfirm:function(){M.deleteCustomEntityDef(a,t.id).then((function(e){h.b.success(t.name+" removed!")})).catch((function(e){h.b.error("Something went wrong, sorry :(")}))},onCancel:function(){},okText:"Yes",cancelText:"No",placement:"bottomRight",children:Object(N.jsx)(p.a,{type:"default",danger:!0,children:"Remove entity"})},"remove-entity-def")}),void 0!==O&&O.map((function(e){return Object(N.jsx)(Qe,{entity:e,entityName:t.singular_name.toLowerCase(),onRemove:function(){!function(e){M.deleteCustomEntity(a,e.id).then((function(e){h.b.success(c+" removed!")})).catch((function(e){h.b.error("Something went wrong, sorry :(")}))}(e)},onEdit:function(){!function(e){f(e),u(!0)}(e)}},e.id)})),Object(N.jsxs)(p.a,{type:"primary",onClick:function(){f(null),u(!0)},children:["Add ",c]}),Object(N.jsx)(ze,{entity:b,entityDef:t,isDrawerVisible:l,onDrawerClose:function(){u(!1)}})]})},Me=u.a.Content,Ke=se.a.TabPane,Ge=function(){var e=Object(r.useState)(!1),t=Object(o.a)(e,2),n=t[0],a=t[1],c=Object(r.useState)(!1),i=Object(o.a)(c,2),s=i[0],l=i[1],u=Object($.useLiveQuery)((function(){return z.custom_entity_defs.toArray()})),d=Object(N.jsx)(p.a,{size:"small",icon:Object(N.jsx)(le.a,{}),onClick:function(){a(!0)},children:"Add entity"},"add-custom"),j=[Object(N.jsx)(p.a,{size:"small",icon:Object(N.jsx)(ue.a,{}),style:{marginRight:"4px"},onClick:function(){l(!0)},children:"Colors"},"edit-colors"),d];return Object(N.jsxs)(N.Fragment,{children:[Object(N.jsx)(Me,{className:"config-page",children:Object(N.jsxs)(se.a,{type:"card",size:"small",tabBarExtraContent:j,children:[Object(N.jsx)(Ke,{tab:"Game State",children:Object(N.jsx)(ke,{})},"1"),Object(N.jsx)(Ke,{tab:"Locations",children:Object(N.jsx)(Ne,{})},"2"),Object(N.jsx)(Ke,{tab:"Characters",children:Object(N.jsx)(_e,{})},"3"),void 0!==u&&u.map((function(e,t){return Object(N.jsx)(Ke,{tab:e.name,children:Object(N.jsx)(Ue,{entityDef:e})},t+4)}))]})}),Object(N.jsx)(de,{isDrawerVisible:n,onDrawerClose:function(){a(!1)}}),Object(N.jsx)(me,{isDrawerVisible:s,onDrawerClose:function(){l(!1)}})]})},Ye=(n(365),n(383)),Je=n(399),Xe=n(400),He=(n(366),s.a.Text),Ze=function(e){var t=e.act,n=e.actIndex,r=void 0===n?null:n,a=e.totalActs,c=void 0===a?0:a,i=e.canEdit,o=void 0===i||i,s=e.canRemove,l=void 0===s||s,u=e.onRemove,d=void 0===u?function(){}:u,j=e.onEdit,b=void 0===j?function(){}:j,h=e.onMoveOrderUp,f=void 0===h?function(){}:h,O=e.onMoveOrderDown,x=void 0===O?function(){}:O,y=[];y.push(Object(N.jsx)(He,{type:"success",style:{marginRight:"24px"},children:"interactive"===t.type?"Interactive":"Sequence"},"act-type")),y.push(Object(N.jsx)(p.a,{type:"default",icon:Object(N.jsx)(Je.a,{}),size:"small",style:{marginRight:"4px"},disabled:0===r,onClick:f},"move-up")),y.push(Object(N.jsx)(p.a,{type:"default",icon:Object(N.jsx)(Xe.a,{}),size:"small",style:{marginRight:"24px"},disabled:r===c-1,onClick:x},"move-down")),o&&y.push(Object(N.jsx)(p.a,{type:"link",size:"small",onClick:b,children:"Edit"},"edit-act")),l&&y.push(Object(N.jsx)(m.a,{title:function(){return Object(N.jsxs)("p",{children:["Are you sure you want to remove this act?",Object(N.jsx)("br",{}),"All sequence actions and end conditions associated will be removed."]})},onConfirm:d,onCancel:function(){},okText:"Yes",cancelText:"No",placement:"bottomRight",children:Object(N.jsx)(p.a,{type:"link",size:"small",children:"Remove"})},"remove-act"));var v="Act "+t.order+": "+t.name;return Object(N.jsx)(De.a,{className:"act-view",size:"small",title:v,extra:y,headStyle:{background:"#d9d9d9"},children:Object(N.jsx)(He,{children:t.description})})},We=(n(367),s.a.Text),$e=Ye.a.Panel,et=function(e){var t=e.chapter,n=e.chapterIndex,a=void 0===n?null:n,c=e.totalChapters,i=void 0===c?0:c,s=e.canEdit,l=void 0===s||s,u=e.canRemove,d=void 0===u||u,j=e.onRemove,b=void 0===j?function(){}:j,f=e.onEdit,O=void 0===f?function(){}:f,x=e.onMoveOrderUp,y=void 0===x?function(){}:x,v=e.onMoveOrderDown,g=void 0===v?function(){}:v,w=e.onAddAct,A=void 0===w?function(){}:w,C=e.onEditAct,S=void 0===C?function(){}:C,k=e.onRemoveAct,D=void 0===k?function(){}:k,E=Object(r.useContext)(Q),P=Object(o.a)(E,2)[1],R=Object($.useLiveQuery)((function(){return z.acts.where("chapter_id").equals(t.id).toArray()})),B=[];B.push(Object(N.jsx)(p.a,{type:"default",icon:Object(N.jsx)(Je.a,{}),size:"small",style:{marginRight:"4px"},disabled:0===a,onClick:y},"move-up")),B.push(Object(N.jsx)(p.a,{type:"default",icon:Object(N.jsx)(Xe.a,{}),size:"small",style:{marginRight:"24px"},disabled:a===i-1,onClick:g},"move-down")),l&&B.push(Object(N.jsx)(p.a,{type:"link",size:"small",onClick:O,children:"Edit"},"edit-chapter")),d&&B.push(Object(N.jsx)(m.a,{title:function(){return Object(N.jsxs)("p",{children:["Are you sure you want to remove this chapter?",Object(N.jsx)("br",{}),"All acts, sequence actions and end conditions associated will be removed."]})},onConfirm:b,onCancel:function(){},okText:"Yes",cancelText:"No",placement:"bottomRight",children:Object(N.jsx)(p.a,{type:"link",size:"small",children:"Remove"})},"remove-chapter"));var T="Chapter "+t.order+": "+t.name,I=void 0!==R?R.length:0,L=0===I?"No acts":1===I?"1 act":I+" acts";return Object(N.jsxs)(De.a,{className:"chapter-view",size:"small",title:T,extra:B,headStyle:{background:"#f5f5f5"},children:[Object(N.jsx)(We,{children:t.description}),Object(N.jsx)(Ye.a,{defaultActiveKey:["1"],ghost:!0,children:Object(N.jsxs)($e,{header:L,children:[void 0!==R&&R.sort((function(e,t){return e.order-t.order})).map((function(e,n){return Object(N.jsx)(Ze,{act:e,actIndex:n,totalActs:I,onRemove:function(){D(e)},onEdit:function(){S(e)},onMoveOrderUp:function(){!function(e){var n={oldOrder:e.order,order:e.order-1,chapter_id:t.id};M.updateActOrder(P,e.id,n).then((function(e){})).catch((function(e){h.b.error("Something went wrong, sorry :(")}))}(e)},onMoveOrderDown:function(){!function(e){var n={oldOrder:e.order,order:e.order+1,chapter_id:t.id};M.updateActOrder(P,e.id,n).then((function(e){})).catch((function(e){h.b.error("Something went wrong, sorry :(")}))}(e)}},e.id)})),Object(N.jsx)(p.a,{type:"default",size:"small",onClick:function(){A(I)},children:"Add Act"})]},"1")})]})},tt=B.a.TextArea,nt=function(e){var t=e.chapter,n=void 0===t?null:t,a=e.totalChapters,c=void 0===a?0:a,i=e.isDrawerVisible,s=e.onDrawerClose,l=Object(r.useContext)(Q),u=Object(o.a)(l,2)[1],d=P.a.useForm(),j=Object(o.a)(d,1)[0],b=Object(r.useState)(!1),f=Object(o.a)(b,2),m=f[0],O=f[1],v=Object(r.useState)(0),g=Object(o.a)(v,2),w=g[0],A=g[1],C=Object(r.useState)(""),S=Object(o.a)(C,2),k=S[0],D=S[1],E=Object(r.useState)(""),T=Object(o.a)(E,2),I=T[0],L=T[1];Object(r.useEffect)((function(){if(i){if(j.resetFields(),n)j.setFieldsValue({name:n.name,description:n.description,chapterIndex:n.order}),A(n.order);else{var e=c+1;j.setFieldsValue({chapterIndex:e}),A(e)}F()}}),[i,j,n,c]);var F=function(){O(!0)},V=function(){O(!1),s&&s()};return Object(N.jsx)(R.a,{title:null===n?"New chapter":"Edit chapter",width:360,onClose:V,visible:m,bodyStyle:{paddingBottom:20},footer:Object(N.jsxs)("div",{style:{textAlign:"right"},children:[Object(N.jsx)(p.a,{onClick:V,style:{marginRight:8},children:"Cancel"}),Object(N.jsx)(p.a,{type:"primary",htmlType:"submit",form:"add-edit-chapter-id",children:null===n?"Create":"Update"})]}),children:Object(N.jsxs)(P.a,{layout:"vertical",name:"add-edit-chapter",id:"add-edit-chapter-id",form:j,onFinish:function(e){var t=e.name.trim(),r=e.description.trim();if(""===t||""===r)return V(),void h.b.error("Do not leave empty fields, sorry :(");var a={name:t,description:r,order:w};null===n?M.createNewChapter(u,a).then((function(e){V(),h.b.success("New chapter created!")})).catch((function(e){V(),h.b.error("Something went wrong, sorry :(")})):M.updateChapter(u,n.id,a).then((function(e){V(),h.b.success("Chapter edited!")})).catch((function(e){V(),h.b.error("Something went wrong, sorry :(")}))},requiredMark:!1,children:[Object(N.jsx)(x.a,{gutter:16,children:Object(N.jsx)(y.a,{span:24,children:Object(N.jsx)(P.a.Item,{name:"chapterIndex",label:"Chapter",children:Object(N.jsx)(B.a,{placeholder:"#",value:w,disabled:!0})})})}),Object(N.jsx)(x.a,{gutter:16,children:Object(N.jsx)(y.a,{span:24,children:Object(N.jsx)(P.a.Item,{name:"name",label:"Name",rules:[{required:!0,message:"Please enter a name"}],children:Object(N.jsx)(B.a,{placeholder:"Please enter a name",value:k,onChange:function(e){D(e.target.value)}})})})}),Object(N.jsx)(x.a,{gutter:16,children:Object(N.jsx)(y.a,{span:24,children:Object(N.jsx)(P.a.Item,{name:"description",label:"Description",rules:[{required:!0,message:"Please enter a description"}],children:Object(N.jsx)(tt,{rows:10,placeholder:"Please enter a description",value:I,onChange:function(e){L(e.target.value)}})})})})]})})},rt=n(384),at=B.a.TextArea,ct=s.a.Text,it=function(e){var t=e.act,n=void 0===t?null:t,a=e.chapter,c=void 0===a?null:a,i=e.totalActs,s=void 0===i?0:i,l=e.isDrawerVisible,u=e.onDrawerClose,d=Object(r.useContext)(Q),j=Object(o.a)(d,2)[1],b=P.a.useForm(),f=Object(o.a)(b,1)[0],m=Object(r.useState)(!1),O=Object(o.a)(m,2),v=O[0],g=O[1],w=Object(r.useState)(0),A=Object(o.a)(w,2),C=A[0],S=A[1],k=Object(r.useState)("interactive"),D=Object(o.a)(k,2),E=D[0],T=D[1],I=Object(r.useState)(""),L=Object(o.a)(I,2),F=L[0],V=L[1],_=Object(r.useState)(""),q=Object(o.a)(_,2),z=q[0],U=q[1];Object(r.useEffect)((function(){if(l){if(f.resetFields(),n)f.setFieldsValue({name:n.name,description:n.description,actIndex:n.order,actType:n.type}),S(n.order);else{var e=s+1;f.setFieldsValue({actIndex:e}),S(e)}T("interactive"),K()}}),[l,f,n,s]);var K=function(){g(!0)},G=function(){g(!1),u&&u()};return Object(N.jsx)(R.a,{title:null===n?"New act":"Edit act",width:360,onClose:G,visible:v,bodyStyle:{paddingBottom:20},footer:Object(N.jsxs)("div",{style:{textAlign:"right"},children:[Object(N.jsx)(p.a,{onClick:G,style:{marginRight:8},children:"Cancel"}),Object(N.jsx)(p.a,{type:"primary",htmlType:"submit",form:"add-edit-act-id",children:null===n?"Create":"Update"})]}),children:Object(N.jsxs)(P.a,{layout:"vertical",name:"add-edit-act",id:"add-edit-act-id",form:f,onFinish:function(e){var t=e.name.trim(),r=e.description.trim();if(""===t||""===r)return G(),void h.b.error("Do not leave empty fields, sorry :(");var a={name:t,description:r,order:C,chapter_id:c.id,type:E};null===n?M.createNewAct(j,a).then((function(e){G(),h.b.success("New act created!")})).catch((function(e){G(),h.b.error("Something went wrong, sorry :(")})):M.updateAct(j,n.id,a).then((function(e){G(),h.b.success("Act edited!")})).catch((function(e){G(),h.b.error("Something went wrong, sorry :(")}))},requiredMark:!1,children:[Object(N.jsx)(x.a,{gutter:16,children:Object(N.jsx)(y.a,{span:24,children:Object(N.jsx)(P.a.Item,{name:"actIndex",label:"Act",children:Object(N.jsx)(B.a,{placeholder:"#",value:C,disabled:!0})})})}),Object(N.jsx)(x.a,{gutter:16,children:Object(N.jsx)(y.a,{span:24,children:Object(N.jsx)(P.a.Item,{name:"name",label:"Name",rules:[{required:!0,message:"Please enter a name"}],children:Object(N.jsx)(B.a,{placeholder:"Please enter a name",value:F,onChange:function(e){V(e.target.value)}})})})}),Object(N.jsx)(x.a,{gutter:16,children:Object(N.jsx)(y.a,{span:24,children:Object(N.jsx)(P.a.Item,{name:"description",label:"Description",rules:[{required:!0,message:"Please enter a description"}],children:Object(N.jsx)(at,{rows:10,placeholder:"Please enter a description",value:z,onChange:function(e){U(e.target.value)}})})})}),Object(N.jsx)(x.a,{gutter:16,style:{display:null===n?"block":"none"},children:Object(N.jsx)(y.a,{span:24,children:Object(N.jsxs)(P.a.Item,{name:"actType",label:"Act type",initialValue:"interactive",children:[Object(N.jsxs)(rt.a.Group,{value:E,onChange:function(e){T(e.target.value)},buttonStyle:"solid",children:[Object(N.jsx)(rt.a.Button,{value:"interactive",children:"Interactive"}),Object(N.jsx)(rt.a.Button,{value:"sequence",children:"Sequence"})]}),Object(N.jsx)(ct,{type:"secondary",style:{display:"block"},children:"interactive"===E?"Interactive act allows player to choose different actions while act's finished condition has not been accomplished":"Sequence act is used for predefined dialogs or fixed sequences (i.e. cinematics)"})]})})})]})})},ot=function(){var e=Object(r.useContext)(Q),t=Object(o.a)(e,2)[1],n=Object(r.useState)(!1),a=Object(o.a)(n,2),c=a[0],i=a[1],s=Object(r.useState)(!1),l=Object(o.a)(s,2),u=l[0],d=l[1],j=Object(r.useState)(null),b=Object(o.a)(j,2),f=b[0],m=b[1],O=Object(r.useState)(null),x=Object(o.a)(O,2),y=x[0],v=x[1],g=Object(r.useState)(0),w=Object(o.a)(g,2),A=w[0],C=w[1],S=Object($.useLiveQuery)((function(){return z.chapters.orderBy("order").toArray()})),k=void 0!==S?S.length:0;return Object(N.jsxs)("div",{children:[void 0!==S&&S.map((function(e,n){return Object(N.jsx)(et,{chapter:e,chapterIndex:n,totalChapters:k,onRemove:function(){!function(e){M.deleteChapter(t,e.id).then((function(e){h.b.success("Chapter removed!")})).catch((function(e){h.b.error("Something went wrong, sorry :(")}))}(e)},onEdit:function(){!function(e){m(e),i(!0)}(e)},onMoveOrderUp:function(){!function(e){var n={oldOrder:e.order,order:e.order-1};M.updateChapterOrder(t,e.id,n).then((function(e){})).catch((function(e){h.b.error("Something went wrong, sorry :(")}))}(e)},onMoveOrderDown:function(){!function(e){var n={oldOrder:e.order,order:e.order+1};M.updateChapterOrder(t,e.id,n).then((function(e){})).catch((function(e){h.b.error("Something went wrong, sorry :(")}))}(e)},onAddAct:function(t){!function(e,t){v(null),m(e),C(t),d(!0)}(e,t)},onEditAct:function(t){!function(e,t){m(t),v(e),d(!0)}(t,e)},onRemoveAct:function(n){!function(e,n){M.deleteAct(t,e.id,n.id).then((function(e){h.b.success("Act removed!")})).catch((function(e){h.b.error("Something went wrong, sorry :(")}))}(n,e)}},e.id)})),Object(N.jsx)(p.a,{type:"primary",onClick:function(){m(null),i(!0)},children:"Add Chapter"}),Object(N.jsx)(nt,{chapter:f,totalChapters:k,isDrawerVisible:c,onDrawerClose:function(){i(!1)}}),Object(N.jsx)(it,{act:y,chapter:f,totalActs:A,isDrawerVisible:u,onDrawerClose:function(){d(!1)}})]})},st=u.a.Content,lt=se.a.TabPane,ut=function(){return Object(N.jsx)(st,{className:"story-page",children:Object(N.jsxs)(se.a,{type:"card",size:"small",children:[Object(N.jsx)(lt,{tab:"Storyline",children:Object(N.jsx)(ot,{})},"1"),Object(N.jsx)(lt,{tab:"Sequence Actions",children:Object(N.jsx)("p",{children:"Sequence Actions"})},"2")]})})},dt=(n(368),u.a.Content),jt=function(){return Object(N.jsx)(dt,{className:"play-mode-page",children:Object(N.jsxs)("ul",{children:[Object(N.jsx)("li",{children:"Required conditions to run"}),Object(N.jsx)("li",{children:"Launch game experience (separate page)"})]})})},bt=s.a.Text,ht=function(){var e=Object(r.useContext)(Q),t=Object(o.a)(e,2),n=t[0],c=t[1];if(Object(r.useEffect)((function(){M.checkDatabaseOk(c),M.checkStoryLoaded(c)}),[]),!n.initialCheckDone)return Object(N.jsxs)("div",{className:"app loading",children:[Object(N.jsx)("img",{src:H,alt:"RPG Story Playtesting"}),Object(N.jsx)(l.a,{size:"large"})]});if(n.databaseLoadError)return Object(N.jsx)(bt,{style:{display:"block",textAlign:"center",paddingTop:50},children:"This application requires IndexedDB. Please use a browser that supports this feature."});if(n.storyLoadError)return Object(N.jsxs)(bt,{style:{display:"block",textAlign:"center",paddingTop:50},children:["We were unable to load your story, please reload and make sure your file contains a RPG-SP story.",Object(N.jsx)("br",{}),null!==n.storyErrorMessage&&"Error info: "+n.storyErrorMessage]});var i=null;if(n.storyLoaded)switch(n.page){case"PLAYMODE":i=jt;break;case"STORY":i=ut;break;case"CONFIG":default:i=Ge}return Object(N.jsx)("div",{className:"app",children:Object(N.jsxs)(u.a,{children:[Object(N.jsx)(W,{}),Object(N.jsx)(u.a,{className:"app-layout",children:n.storyLoaded?Object(N.jsxs)(N.Fragment,{children:[Object(N.jsx)(re,{}),a.a.createElement(i)]}):Object(N.jsx)(oe,{})})]})})},ft=(n(369),n(370),function(){return Object(N.jsx)(F,{children:Object(N.jsx)(ht,{})})}),mt=function(e){e&&e instanceof Function&&n.e(3).then(n.bind(null,401)).then((function(t){var n=t.getCLS,r=t.getFID,a=t.getFCP,c=t.getLCP,i=t.getTTFB;n(e),r(e),a(e),c(e),i(e)}))};i.a.render(Object(N.jsx)(a.a.StrictMode,{children:Object(N.jsx)(ft,{})}),document.getElementById("root")),mt()}},[[371,1,2]]]);
//# sourceMappingURL=main.aed32e9d.chunk.js.map