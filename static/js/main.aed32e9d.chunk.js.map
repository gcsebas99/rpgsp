{"version":3,"sources":["stores/AppReducer.js","stores/AppStore.js","db/AppDatabase.js","utils/AppLogicUtils.js","controllers/AppLogicController.js","components/drawers/NewStory.js","controllers/ImportExportStoryController.js","images/logo192.png","components/AppNav.js","components/StoryTitle.js","images/jake-reading.png","components/pages/EmptyProjectPage.js","components/drawers/AddCustomEntity.js","components/drawers/EditColors.js","components/entity_views/GameStateListItem.js","controllers/AppValidationsController.js","components/drawers/AddEditGameStateProp.js","components/sections/GameStateConfigSection.js","components/entity_views/LocationView.js","components/drawers/AddEditLocation.js","components/drawers/AddEditArea.js","components/sections/LocationConfigSection.js","components/entity_views/SimpleEntityView.js","components/drawers/AddEditCharacter.js","components/sections/CharacterConfigSection.js","components/drawers/AddEditCustomEntity.js","components/sections/CustomEntityConfigSection.js","components/pages/ConfigPage.js","components/entity_views/ActView.js","components/entity_views/ChapterView.js","components/drawers/AddEditChapter.js","components/drawers/AddEditAct.js","components/sections/StorylineSection.js","components/pages/StoryPage.js","components/pages/PlayModePage.js","AppLayout.js","App.js","reportWebVitals.js","index.js"],"names":["AppReducer","state","action","type","initialCheckDone","databaseLoadError","storyLoadError","storyErrorMessage","payload","page","storyLoaded","initialState","AppContext","createContext","AppStore","children","useReducer","dispatch","Provider","value","db","Dexie","version","stores","stories","game_state_props","locations","areas","characters","custom_entity_defs","custom_entities","default_entity_colors","chapters","acts","AppLogicUtils","name","default","edit_mode","removable","description","color","getEntitiesDefaultColors","Math","floor","random","AppLogicController","open","catch","err","console","error","stack","where","equals","first","undefined","data","transaction","a","add","title","bulkAdd","getNewStoryDefaultGameStateProps","getNewStoryDefaultCharacters","getNewStoryDefaultEntityColors","then","result","log","Promise","reject","defaultValue","editMode","key","update","id","delete","location_id","singular","getCustomEntityRandomColor","custom_entity_def_id","order","affectedChapter","oldOrder","newBaseOrder","affectedChapters","orderBy","each","chapter","push","length","forEach","affected","chapter_id","affectedAct","affectedActs","toArray","orderedActs","sort","b","act","window","location","reload","NewStory","isDrawerVisible","onDrawerClose","useContext","Form","useForm","form","useState","visible","setVisible","setTitle","setVersion","useEffect","resetFields","openDrawer","closeDrawer","width","onClose","bodyStyle","paddingBottom","footer","style","textAlign","onClick","marginRight","htmlType","layout","onFinish","values","trim","message","createNewStory","success","requiredMark","gutter","span","Item","label","rules","required","placeholder","onChange","e","target","ImportExportStoryController","progressCallback","errorCallback","story","d","Date","date","getFullYear","toString","getMonth","getDate","getHours","getMinutes","getSeconds","fileName","replaceAll","exportDB","prettyJson","blob","download","file","successCallback","isOpen","importInto","acceptMissingTables","acceptVersionDiff","acceptNameDiff","acceptChangedPrimaryKey","Sider","Layout","AppNav","collapsed","setCollapsed","shouldRenderMenu","setShouldRenderMenu","newStoryVisible","setNewStoryVisible","document","getElementById","addEventListener","readStoryFile","setTimeout","loadStory","click","clearStoryTest","devStartOver","files","loadStoryFromFile","importStoryProgressCallback","importStorySuccessCallback","totalRows","completedRows","toggleNav","handleClick","className","collapsible","onCollapse","src","logo","alt","theme","mode","defaultSelectedKeys","disabled","icon","SettingFilled","BookFilled","CaretRightOutlined","marginLeft","marginTop","block","PlusOutlined","marginBottom","onConfirm","onCancel","okText","cancelText","placement","UploadOutlined","accept","display","DownloadOutlined","downloadStory","DeleteFilled","content","trigger","RocketOutlined","renderLoadSamples","BugOutlined","Header","Title","Typography","Text","StoryTitle","useLiveQuery","level","Content","EmptyProjectPage","jake_reading","AddCustomEntity","createNewCustomEntityDef","toLowerCase","replace","setFieldsValue","readOnly","EditColors","newDefaultColors","setNewDefaultColors","newCustomColors","setNewCustomColors","saveSucceed","setSaveSucceed","customEntityDefs","defaultEntityColors","Object","keys","updateDefaultEntityColor","parseInt","updateCustomEntityDefColor","dataSource","renderItem","item","textTransform","animation","enableAlpha","colors","newColors","setDefaultEntityColor","margin","setCustomEntityColor","GameStateListItem","gameState","onEditGameStateProp","onRemoveGameStateProp","endsWith","size","AppValidationsController","testNames","dbTable","invalidNames","resolve","entityDefId","TextArea","Input","Option","Select","AddEditGameStateProp","gameStateProp","setName","setType","defaultValueInt","setDefaultValueInt","defaultValueBool","setDefaultValueBool","defaultValueString","setDefaultValueString","defaultValueArray","setDefaultValueArray","valuesArray","split","join","unquotedEntries","entry","slice","populateDefault","displaySingleLineDefaultField","arrayFieldLabelAndPlaceholder","singular_name","valudateArrayTypes","defaultValues","saveGameStateProp","integerValue","Number","isInteger","booleanValue","validateEntityNames","invalidLocations","invalidAreas","invalidCharacters","customEntityDef","find","validateCustomEntityNames","invalidEntities","getDefaultValue","newData","createNewGameStateProp","editData","updateGameStateProp","quotesWrappedEntries","isDefaultDisabled","indexOf","defaultLocation","defaultArea","defaultCharacter","defaultEntity","isNameDisabled","isTypeDisabled","map","checkedChildren","unCheckedChildren","checked","defaultChecked","rows","GameStateConfigSection","addEditGameStatePropVisible","setAddEditGameStatePropVisible","currentGameStateProp","setCurrentGameStateProp","gameStates","header","strong","maxWidth","deleteGameStateProp","LocationView","canEdit","canRemove","onRemove","onEdit","onAddArea","onEditArea","onRemoveArea","options","extra","headStyle","background","area","AddEditLocation","setDescription","createNewLocation","updateLocation","AddEditArea","createNewArea","updateArea","LocationConfigSection","addEditLocationVisible","setAddEditLocationVisible","addEditAreaVisible","setAddEditAreaVisible","currentLocation","setCurrentLocation","currentArea","setCurrentArea","deleteLocation","removeLocation","editLocation","addArea","editArea","deleteArea","removeArea","SimpleEntityView","entity","entityName","AddEditCharacter","character","createNewCharacter","updateCharacter","CharacterConfigSection","addEditCharacterVisible","setAddEditCharacterVisible","currentCharacter","setCurrentCharacter","deleteCharacter","removeCharacter","editCharacter","AddEditCustomEntity","entityDef","singularCapitalized","charAt","toUpperCase","createNewCustomEntity","updateCustomEntity","CustomEntityConfigSection","addEditCustomEntityVisible","setAddEditCustomEntityVisible","currentCustomEntity","setCurrentCustomEntity","entities","deleteCustomEntityDef","danger","deleteCustomEntity","removeEntity","editEntity","TabPane","Tabs","ConfigPage","addCustomEntityVisible","setAddCustomEntityVisible","editColorsVisible","setEditColorsVisible","addCustomEntityButton","PlusSquareOutlined","buttons","BgColorsOutlined","tabBarExtraContent","tab","index","ActView","actIndex","totalActs","onMoveOrderUp","onMoveOrderDown","CaretUpOutlined","CaretDownOutlined","Panel","Collapse","ChapterView","chapterIndex","totalChapters","onAddAct","onEditAct","onRemoveAct","actsCollapseHeader","defaultActiveKey","ghost","orderInfo","updateActOrder","moveActUp","moveActDown","AddEditChapter","setChapterIndex","createNewChapter","updateChapter","AddEditAct","setActIndex","actType","setActType","createNewAct","updateAct","initialValue","Group","buttonStyle","Button","StorylineSection","addEditChapterVisible","setAddEditChapterVisible","addEditActVisible","setAddEditActVisible","currentChapter","setCurrentChapter","currentAct","setCurrentAct","currentChapterTotalActs","setCurrentChapterTotalActs","deleteChapter","removeChapter","editCharpter","updateChapterOrder","moveCharpterUp","moveCharpterDown","addAct","editAct","deleteAct","removeAct","StoryPage","PlayModePage","AppLayout","checkDatabaseOk","checkStoryLoaded","paddingTop","currentPage","React","createElement","App","reportWebVitals","onPerfEntry","Function","getCLS","getFID","getFCP","getLCP","getTTFB","ReactDOM","render","StrictMode"],"mappings":"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","file":"static/js/main.aed32e9d.chunk.js","sourcesContent":["const AppReducer = (state, action) => {\n  switch (action.type) {\n    case 'SET_APP_INITIAL_CHECK_DONE':\n      return {\n        ...state,\n        initialCheckDone: true,\n        };\n    case 'SET_APP_DATABASE_LOAD_ERROR':\n      return {\n        ...state,\n        databaseLoadError: true,\n        initialCheckDone: true,\n      };\n    case 'SET_APP_STORY_LOAD_ERROR':\n      return {\n        ...state,\n        storyLoadError: true,\n        storyErrorMessage: action.payload || null,\n      };\n    case 'SET_APP_PAGE':\n      return {\n        ...state,\n        page: action.payload,\n      };\n    case 'SET_STORY_LOADED':\n      return {\n        ...state,\n        storyLoaded: action.payload,\n        page: (action.payload ? 'CONFIG' : 'EMPTY'),\n        };\n\n    // case 'ADD_POST':\n    //     return {\n    //         ...state,\n    //         posts: state.posts.concat(action.payload)\n    //     };\n    // case 'REMOVE_POST':\n    //     return {\n    //         ...state,\n    //         posts: state.posts.filter(post => post.id !== action.payload)\n    //     };\n    // case 'SET_ERROR':\n    //     return {\n    //         ...state,\n    //         error: action.payload\n    //     };\n    default:\n        return state;\n  }\n};\n\nexport default AppReducer;\n","import React, {createContext, useReducer} from \"react\";\nimport AppReducer from './AppReducer'\n\nconst initialState = {\n  initialCheckDone: false,\n  databaseLoadError: false,\n  storyLoadError: false,\n  storyErrorMessage: null,\n  storyLoaded: false,\n  page: 'EMPTY',\n};\n\nconst AppStore = ({children}) => {\n    const [state, dispatch] = useReducer(AppReducer, initialState);\n    return (\n        <AppContext.Provider value={[state, dispatch]}>\n            {children}\n        </AppContext.Provider>\n    )\n};\n\nexport const AppContext = createContext(initialState);\nexport default AppStore;","import Dexie from 'dexie';\n\n\nconst db = new Dexie('RpgspDatabase');\n\ndb.version(1).stores({\n    stories: '++id',                                //title, version\n    game_state_props: '++id, name',                 //type, default, edit_mode, removable\n    locations: '++id, name',                        //description\n    areas: '++id, location_id, name',               //description\n    characters: '++id, name',                       //description\n    custom_entity_defs: '++id',                     //name, key, singular_name, color\n    custom_entities: '++id, custom_entity_def_id, name',  //description\n    default_entity_colors: '++id',                  //name, color\n    //\n    chapters: '++id, order',                        //name, description\n    acts: '++id, order, chapter_id, type',          //name, description\n});\n\n//default_entity_colors for: locations, areas, characters\n\n//game_state_props.edit_mode = (string) \"none|all|name|type|default\"\n\n//act.type = (string) \"sequence|interactive\"\n\n\nexport const testDatabase = () => {\n  return db.open();\n};\n\nexport default db;\n","\nclass AppLogicUtils {\n  static getNewStoryDefaultGameStateProps() {\n    return [\n      {name: 'currentChapter', type: 'integer', default: 0, edit_mode: 'none', removable: false},\n      {name: 'currentAct', type: 'integer', default: 0, edit_mode: 'none', removable: false},\n      {name: 'currentActSequence', type: 'integer', default: 0, edit_mode: 'none', removable: false},\n      {name: 'currentLocation', type: 'location', default: null, edit_mode: 'default', removable: false},\n      {name: 'currentArea', type: 'area', default: null, edit_mode: 'default', removable: false},\n    ];\n  }\n\n  static getNewStoryDefaultCharacters() {\n    return [\n      {name: '[Playable character]', description: '[Add description]'},\n    ];\n  }\n\n  static getNewStoryDefaultEntityColors() {\n    return [\n      {name: 'locations', color: AppLogicUtils.getEntitiesDefaultColors('locations')},\n      {name: 'areas', color: AppLogicUtils.getEntitiesDefaultColors('areas')},\n      {name: 'characters', color: AppLogicUtils.getEntitiesDefaultColors('characters')},\n    ];\n  }\n\n  static getEntitiesDefaultColors(name = 'locations') {\n    switch(name) {\n      case 'characters':\n        return '#1890ff';\n      case 'areas':\n        return '#a0d911';\n      case 'locations':\n      default:\n        return '#3f6600';\n    }\n  }\n\n  static getCustomEntityRandomColor() {\n    const defaultColorList = ['#ffa940', '#73d13d', '#10239e', '#36cfc9', '#9e1068', '#9254de', '#85a5ff', '#fadb14', '#ffa940', '#391085'];\n    return defaultColorList[Math.floor(Math.random() * 10)];\n  }\n\n}\n\nexport default AppLogicUtils;","import db, { testDatabase } from '../db/AppDatabase';\nimport AppLogicUtils from '../utils/AppLogicUtils';\n\nclass AppLogicController {\n\n  static checkDatabaseOk(dispatch) {\n    testDatabase().catch((err) => {\n      console.error('Failed to open db: ' + (err.stack || err));\n      dispatch({type: 'SET_APP_DATABASE_LOAD_ERROR'});\n    });\n  }\n\n  static async checkStoryLoaded(dispatch) {\n    const story = await db.stories.where('id').equals(1).first();\n    if (story !== undefined) {\n      dispatch({type: 'SET_STORY_LOADED', payload: true});\n    }\n    dispatch({type: 'SET_APP_INITIAL_CHECK_DONE'});\n  }\n\n  //-- Story --//\n  static createNewStory(dispatch, data) {\n    return db.transaction('rw', db.stories, db.game_state_props, db.characters, db.default_entity_colors, async () => {\n      await db.stories.add({'title': data.title, 'version': data.version});\n      await db.game_state_props.bulkAdd( AppLogicUtils.getNewStoryDefaultGameStateProps() );\n      await db.characters.bulkAdd( AppLogicUtils.getNewStoryDefaultCharacters() );\n      await db.default_entity_colors.bulkAdd( AppLogicUtils.getNewStoryDefaultEntityColors() );\n    }).then(result => {\n      dispatch({type: 'SET_STORY_LOADED', payload: true});\n    }).catch(error => {\n      console.log('||--FAIL', error);\n      //return reject to allow catch chain\n      return Promise.reject(error);\n    });\n    // db.stories.add({'title': data.title, 'version': data.version}).then(() => {\n    //   dispatch({type: 'SET_STORY_LOADED', payload: true});\n    // });\n  }\n\n  //-- GameStateProps --//\n  static createNewGameStateProp(dispatch, data) {\n    return db.game_state_props.add({'name': data.name, 'type': data.type, 'default': data.defaultValue, 'edit_mode': data.editMode, 'removable': data.removable}).then(() => {\n      //\n    }).catch(error => {\n      console.log('||--FAIL', error);\n      //return reject to allow catch chain\n      return Promise.reject(error);\n    });\n  }\n\n  static updateGameStateProp(dispatch, key, data) {\n    return db.game_state_props.update(key, {'name': data.name, 'type': data.type, 'default': data.defaultValue, 'edit_mode': data.editMode, 'removable': data.removable}).then(() => {\n      //\n    }).catch(error => {\n      console.log('||--FAIL', error);\n      //return reject to allow catch chain\n      return Promise.reject(error);\n    });\n  }\n\n  static deleteGameStateProp(dispatch, id) {\n    return db.game_state_props.delete(id).then(() => {\n      //\n    }).catch(error => {\n      console.log('||--FAIL', error);\n      //return reject to allow catch chain\n      return Promise.reject(error);\n    });\n  }\n\n  //-- Location & Areas --//\n  static createNewLocation(dispatch, data) {\n    return db.locations.add({'name': data.name, 'description': data.description}).then(() => {\n      //\n    }).catch(error => {\n      console.log('||--FAIL', error);\n      //return reject to allow catch chain\n      return Promise.reject(error);\n    });\n  }\n\n  static updateLocation(dispatch, key, data) {\n    return db.locations.update(key, {'name': data.name, 'description': data.description}).then(() => {\n      //\n    }).catch(error => {\n      console.log('||--FAIL', error);\n      //return reject to allow catch chain\n      return Promise.reject(error);\n    });\n  }\n\n  static deleteLocation(dispatch, id) {\n    return db.transaction('rw', db.locations, db.areas, async () => {\n      await db.areas.where('location_id').equals(id).delete();\n      await db.locations.delete(id);\n    }).then(result => {\n      //\n    }).catch(error => {\n      console.log('||--FAIL', error);\n      //return reject to allow catch chain\n      return Promise.reject(error);\n    });\n  }\n\n  static createNewArea(dispatch, data) {\n    return db.areas.add({'location_id': data.location_id, 'name': data.name, 'description': data.description}).then(() => {\n      //\n    }).catch(error => {\n      console.log('||--FAIL', error);\n      //return reject to allow catch chain\n      return Promise.reject(error);\n    });\n  }\n\n  static updateArea(dispatch, key, data) {\n    return db.areas.update(key, {'name': data.name, 'description': data.description}).then(() => {\n      //\n    }).catch(error => {\n      console.log('||--FAIL', error);\n      //return reject to allow catch chain\n      return Promise.reject(error);\n    });\n  }\n\n  static deleteArea(dispatch, id) {\n    return db.areas.delete(id).then(() => {\n      //\n    }).catch(error => {\n      console.log('||--FAIL', error);\n      //return reject to allow catch chain\n      return Promise.reject(error);\n    });\n  }\n\n  //-- Character --//\n  static createNewCharacter(dispatch, data) {\n    return db.characters.add({'name': data.name, 'description': data.description}).then(() => {\n      //\n    }).catch(error => {\n      console.log('||--FAIL', error);\n      //return reject to allow catch chain\n      return Promise.reject(error);\n    });\n  }\n\n  static updateCharacter(dispatch, key, data) {\n    return db.characters.update(key, {'name': data.name, 'description': data.description}).then(() => {\n      //\n    }).catch(error => {\n      console.log('||--FAIL', error);\n      //return reject to allow catch chain\n      return Promise.reject(error);\n    });\n  }\n\n  static deleteCharacter(dispatch, id) {\n    return db.characters.delete(id).then(() => {\n      //\n    }).catch(error => {\n      console.log('||--FAIL', error);\n      //return reject to allow catch chain\n      return Promise.reject(error);\n    });\n  }\n\n  //-- Custom Entities --//\n  static createNewCustomEntityDef(dispatch, data) {\n    return db.custom_entity_defs.add({'name': data.name, 'key': data.key, 'singular_name': data.singular, 'color': AppLogicUtils.getCustomEntityRandomColor()}).then(() => {\n      //\n    }).catch(error => {\n      console.log('||--FAIL', error);\n      //return reject to allow catch chain\n      return Promise.reject(error);\n    });\n  }\n\n  static deleteCustomEntityDef(dispatch, id) {\n    return db.transaction('rw', db.custom_entity_defs, db.custom_entities, async () => {\n      await db.custom_entities.where('custom_entity_def_id').equals(id).delete();\n      await db.custom_entity_defs.delete(id);\n    }).then(result => {\n      //\n    }).catch(error => {\n      console.log('||--FAIL', error);\n      //return reject to allow catch chain\n      return Promise.reject(error);\n    });\n  }\n\n  static createNewCustomEntity(dispatch, data) {\n    return db.custom_entities.add({'custom_entity_def_id': data.custom_entity_def_id, 'name': data.name, 'description': data.description}).then(() => {\n      //\n    }).catch(error => {\n      console.log('||--FAIL', error);\n      //return reject to allow catch chain\n      return Promise.reject(error);\n    });\n  }\n\n  static updateCustomEntity(dispatch, key, data) {\n    return db.custom_entities.update(key, {'name': data.name, 'description': data.description}).then(() => {\n      //\n    }).catch(error => {\n      console.log('||--FAIL', error);\n      //return reject to allow catch chain\n      return Promise.reject(error);\n    });\n  }\n\n  static deleteCustomEntity(dispatch, id) {\n    return db.custom_entities.delete(id).then(() => {\n      //\n    }).catch(error => {\n      console.log('||--FAIL', error);\n      //return reject to allow catch chain\n      return Promise.reject(error);\n    });\n  }\n\n  //-- Colors --//\n  static updateDefaultEntityColor(dispatch, key, data) {\n    return db.default_entity_colors.update(key, {'color': data.color}).then(() => {\n      //\n    }).catch(error => {\n      console.log('||--FAIL', error);\n      //return reject to allow catch chain\n      return Promise.reject(error);\n    });\n  }\n\n  static updateCustomEntityDefColor(dispatch, key, data) {\n    return db.custom_entity_defs.update(key, {'color': data.color}).then(() => {\n      //\n    }).catch(error => {\n      console.log('||--FAIL', error);\n      //return reject to allow catch chain\n      return Promise.reject(error);\n    });\n  }\n\n  //-- Chapters --//\n  static createNewChapter(dispatch, data) {\n    return db.chapters.add({'name': data.name, 'description': data.description, 'order': data.order}).then(() => {\n      //\n    }).catch(error => {\n      console.log('||--FAIL', error);\n      //return reject to allow catch chain\n      return Promise.reject(error);\n    });\n  }\n\n  static updateChapter(dispatch, key, data) {\n    //do not accept order update\n    return db.chapters.update(key, {'name': data.name, 'description': data.description}).then(() => {\n      //\n    }).catch(error => {\n      console.log('||--FAIL', error);\n      //return reject to allow catch chain\n      return Promise.reject(error);\n    });\n  }\n\n  static updateChapterOrder(dispatch, key, data) {\n    return db.transaction('rw', db.chapters, async () => {\n      const affectedChapter = await db.chapters.where('order').equals(data.order).first();\n      await db.chapters.update(key, {'order': data.order});\n      await db.chapters.update(affectedChapter.id, {'order': data.oldOrder});\n    }).then(result => {\n      //\n    }).catch(error => {\n      console.log('||--FAIL', error);\n      //return reject to allow catch chain\n      return Promise.reject(error);\n    });\n  }\n\n  static deleteChapter(dispatch, id) {\n    return db.transaction('rw', db.chapters, async () => {\n      let newBaseOrder = null;\n      let affectedChapters = [];\n      const chapters = db.chapters.orderBy('order');\n      await chapters.each(chapter => {\n        if(newBaseOrder !== null){\n          affectedChapters.push({key: chapter.id, order: newBaseOrder + affectedChapters.length});\n        }\n        if(chapter.id === id){\n          newBaseOrder = chapter.order;\n        }\n      });\n      await db.chapters.delete(id);\n      affectedChapters.forEach(async (affected) => {\n        await db.chapters.update(affected.key, {'order': affected.order});\n      });\n\n      //TODO remove acts, remove sequenced actions associated to acts, remove end conditions associated to acts\n\n\n\n    }).then(result => {\n      //\n    }).catch(error => {\n      console.log('||--FAIL', error);\n      //return reject to allow catch chain\n      return Promise.reject(error);\n    });\n  }\n\n  //-- Acts --//\n  static createNewAct(dispatch, data) {\n    return db.acts.add({'chapter_id': data.chapter_id, 'name': data.name, 'description': data.description, 'order': data.order, 'type': data.type}).then(() => {\n      //\n    }).catch(error => {\n      console.log('||--FAIL', error);\n      //return reject to allow catch chain\n      return Promise.reject(error);\n    });\n  }\n\n  static updateAct(dispatch, key, data) {\n    //do not accept order update\n    return db.acts.update(key, {'name': data.name, 'description': data.description}).then(() => {\n      //\n    }).catch(error => {\n      console.log('||--FAIL', error);\n      //return reject to allow catch chain\n      return Promise.reject(error);\n    });\n  }\n\n  static updateActOrder(dispatch, key, data) {\n    return db.transaction('rw', db.acts, async () => {\n      const affectedAct = await db.acts.where({chapter_id: data.chapter_id, order: data.order}).first();\n      await db.acts.update(key, {'order': data.order});\n      await db.acts.update(affectedAct.id, {'order': data.oldOrder});\n    }).then(result => {\n      //\n    }).catch(error => {\n      console.log('||--FAIL', error);\n      //return reject to allow catch chain\n      return Promise.reject(error);\n    });\n  }\n\n  static deleteAct(dispatch, id, chapter_id) {\n    return db.transaction('rw', db.acts, async () => {\n      let newBaseOrder = null;\n      let affectedActs = [];\n      const acts = await db.acts.where('chapter_id').equals(chapter_id).toArray();\n      const orderedActs = acts.sort((a, b) => { return a.order - b.order; });\n      await orderedActs.forEach(act => {\n        if(newBaseOrder !== null){\n          affectedActs.push({key: act.id, order: newBaseOrder + affectedActs.length});\n        }\n        if(act.id === id){\n          newBaseOrder = act.order;\n        }\n      });\n      await db.acts.delete(id);\n      affectedActs.forEach(async (affected) => {\n        await db.acts.update(affected.key, {'order': affected.order});\n      });\n\n      //TODO remove sequenced actions associated to act, remove end conditions associated to act\n\n\n    }).then(result => {\n      //\n    }).catch(error => {\n      console.log('||--FAIL', error);\n      //return reject to allow catch chain\n      return Promise.reject(error);\n    });\n  }\n\n  //-- Dev --//\n  static devStartOver(dispatch) {\n    return db.delete().then( () => window.location.reload() );\n  }\n}\n\nexport default AppLogicController;","import { useState, useEffect, useContext } from 'react';\nimport { Drawer, Form, Button, Col, Row, Input, message } from 'antd';\nimport { AppContext } from '../../stores/AppStore';\nimport AppLogicController from '../../controllers/AppLogicController';\n\nconst NewStory = ({ isDrawerVisible, onDrawerClose }) => {\n  const [,dispatch] = useContext(AppContext);\n  const [form] = Form.useForm();\n  const [visible, setVisible] = useState(false);\n  const [title, setTitle] = useState('');\n  const [version, setVersion] = useState('');\n\n  useEffect(() => {\n    if(isDrawerVisible) { //opening drawer\n      form.resetFields();\n      openDrawer();\n    }\n  }, [isDrawerVisible, form]);\n\n  const openDrawer = () => {\n    setVisible(true);\n  };\n\n  const closeDrawer = () => {\n    setVisible(false);\n    onDrawerClose && onDrawerClose();\n  };\n\n  const onFinish = (values) => {\n    const title = values.title.trim();\n    const version = values.version.trim();\n    if(title === '' || version === ''){\n      closeDrawer();\n      message.error('Something went wrong, sorry :(');\n      return;\n    }\n    const data = {title, version};\n    AppLogicController.createNewStory(dispatch, data).then(result => {\n      closeDrawer();\n      message.success('Story created!');\n    }).catch(error => {\n      closeDrawer();\n      message.error('Something went wrong, sorry :(');\n    });\n  };\n\n  return (\n    <Drawer\n      title=\"New story\"\n      width={360}\n      onClose={closeDrawer}\n      visible={visible}\n      bodyStyle={{ paddingBottom: 20 }}\n      footer={\n        <div style={{textAlign: 'right'}} >\n          <Button onClick={closeDrawer} style={{ marginRight: 8 }}>\n            Cancel\n          </Button>\n          <Button type=\"primary\" htmlType=\"submit\" form='create-story-id'>\n            Create\n          </Button>\n        </div>\n      }\n    >\n      <Form layout=\"vertical\" name='create-story' id='create-story-id' form={form} onFinish={onFinish} requiredMark={false}>\n        <Row gutter={16}>\n          <Col span={24}>\n            <Form.Item\n              name=\"title\"\n              label=\"Title\"\n              rules={[{ required: true, message: 'Please enter a title' }]}\n            >\n              <Input placeholder=\"Please enter a title\" value={title} onChange={(e) => { setTitle(e.target.value) }} />\n            </Form.Item>\n          </Col>\n        </Row>\n        <Row gutter={16}>\n          <Col span={24}>\n            <Form.Item\n              name=\"version\"\n              label=\"Version\"\n              rules={[{ required: true, message: 'Please enter a version' }]}\n            >\n              <Input placeholder=\"Please enter a version\" value={version} onChange={(e) => { setVersion(e.target.value) }} />\n            </Form.Item>\n          </Col>\n        </Row>\n      </Form>\n    </Drawer>\n  );\n};\n\nexport default NewStory;\n","import db from '../db/AppDatabase';\nimport { exportDB, importInto } from 'dexie-export-import';\nimport download from 'downloadjs';\n\nclass ImportExportStoryController {\n\n  static async downloadStory(dispatch, progressCallback = () => {}, errorCallback = () => {}) {\n    try {\n      const story = await db.stories.where('id').equals(1).first();\n      const d = new Date();\n      const date = d.getFullYear().toString() + d.getMonth().toString() + d.getDate().toString() + '-' + d.getHours().toString() + d.getMinutes().toString() + d.getSeconds().toString();\n      const fileName = story.title.replaceAll(' ', '_') + '-' + date + '.json';\n      const blob = await exportDB(db, {prettyJson: true, progressCallback});\n      download(blob, fileName, 'application/json');\n    } catch (error) {\n      errorCallback(error);\n    }\n  }\n\n  static async loadStoryFromFile(dispatch, file, progressCallback = () => {}, successCallback = () => {}) {\n    try {\n      if(db.isOpen()){\n        await db.delete().then( () => db.open() );\n      }\n      await importInto(db, file, {\n        acceptMissingTables: false,\n        acceptVersionDiff: false,\n        acceptNameDiff: false,\n        acceptChangedPrimaryKey: false,\n        progressCallback: progressCallback\n      });\n      const story = await db.stories.where('id').equals(1).first();\n      if (story !== undefined) {\n        dispatch({type: 'SET_STORY_LOADED', payload: true});\n      }\n      successCallback();\n    } catch (error) {\n      //TODO set app error state\n      dispatch({type: 'SET_APP_STORY_LOAD_ERROR', payload: error});\n      console.log(error);\n    }\n  }\n\n}\n\nexport default ImportExportStoryController;","export default \"data:image/png;base64,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\"","//-- Components --//\nimport { useState, useEffect, useContext } from 'react';\nimport { Layout, Menu, Col, Row, Button, Popconfirm, Popover, message } from 'antd';\nimport { SettingFilled, BookFilled, DownloadOutlined, UploadOutlined, DeleteFilled, PlusOutlined, BugOutlined, CaretRightOutlined, RocketOutlined } from '@ant-design/icons';\nimport NewStory from './drawers/NewStory';\n//-- Controller --//\nimport AppLogicController from '../controllers/AppLogicController';\nimport ImportExportStoryController from '../controllers/ImportExportStoryController';\n//-- Context --//\nimport { AppContext } from '../stores/AppStore';\n//-- Images --//\nimport logo from '../images/logo192.png';\n//-- Style --//\nimport '../styles/components/AppNav.scss';\n\nconst { Sider } = Layout;\n\nconst AppNav = () => {\n  const [state, dispatch] = useContext(AppContext);\n\n  const [collapsed, setCollapsed] = useState(false);\n  const [shouldRenderMenu, setShouldRenderMenu] = useState(true);\n  const [newStoryVisible, setNewStoryVisible] = useState(false);\n\n  useEffect(() => {\n    //Mount\n    document.getElementById('load-story-selector').addEventListener('change', readStoryFile, false);\n\n  }, []); // eslint-disable-line\n\n  useEffect(() => {\n    setShouldRenderMenu(false);\n    setTimeout(() => {\n      setShouldRenderMenu(true);\n    }, 5);\n  }, [state.storyLoaded]);\n\n\n  const loadStory = () => {\n    document.getElementById('load-story-selector').click();\n  };\n\n  const clearStoryTest = () => {\n    AppLogicController.devStartOver(dispatch);\n    //dispatch({type: 'SET_STORY_LOADED', payload: false});\n  };\n\n  const downloadStory = () => {\n    ImportExportStoryController.downloadStory(dispatch);\n  };\n\n  //dev\n  const devStartOver = () => {\n    AppLogicController.devStartOver(dispatch);\n  };\n\n\n  const readStoryFile = async (e) => {\n    var file = e.target.files[0];\n    if (!file) {\n      return;\n    }\n    ImportExportStoryController.loadStoryFromFile(dispatch, file, importStoryProgressCallback, importStorySuccessCallback);\n  };\n\n  const importStoryProgressCallback = ({totalRows, completedRows}) => {\n    //console.log(`Progress: ${completedRows} of ${totalRows} rows completed`);\n  };\n\n  const importStorySuccessCallback = () => {\n    message.success('Story imported successfully!');\n  };\n\n  const toggleNav = () => {\n    setCollapsed(!collapsed);\n  };\n\n  const handleClick = ({key}) => {\n    switch(key) {\n      case '1':\n        dispatch({type: 'SET_APP_PAGE', payload: 'CONFIG'});\n        break;\n      case '2':\n        dispatch({type: 'SET_APP_PAGE', payload: 'STORY'});\n        break;\n      case '3':\n        dispatch({type: 'SET_APP_PAGE', payload: 'PLAYMODE'});\n        break;\n      default:\n        break;\n    }\n  };\n\n  const renderMenu = () => {\n    return (\n      <Menu theme=\"dark\" mode=\"inline\" defaultSelectedKeys={(state.storyLoaded ? ['1'] : [])} onClick={handleClick}>\n        <Menu.Item key=\"1\" disabled={!state.storyLoaded} icon={<SettingFilled />}>\n          Configuration\n        </Menu.Item>\n        <Menu.Item key=\"2\" disabled={!state.storyLoaded} icon={<BookFilled />}>\n          Story\n        </Menu.Item>\n        <Menu.Item key=\"3\" disabled={!state.storyLoaded} icon={<CaretRightOutlined />}>\n          Play\n        </Menu.Item>\n      </Menu>\n    );\n  };\n\n  const renderLoadStory = () => {\n    return (\n      <>\n        {state.storyLoaded\n          ? \n          <Popconfirm\n            title={() => { return (<p>Download current story to avoid losing your changes.<br/>Continue loading a new story?</p>); }}\n            onConfirm={loadStory}\n            onCancel={() => {}}\n            okText='Yes'\n            cancelText='No'\n            placement='right'\n          >\n            <Button type=\"default\" block icon={<UploadOutlined />} style={{ marginBottom: 12 }}>Load story</Button>\n          </Popconfirm>\n          : \n          <Button type=\"default\" block icon={<UploadOutlined />} style={{ marginBottom: 12 }} onClick={loadStory}>Load story</Button>\n        }\n        <input type='file' id='load-story-selector' accept='.json' style={{ display: 'none' }} />\n      </>\n    );\n  };\n\n  const renderClearStory = () => {\n    return (\n      <Popconfirm\n        title='All data will be lost. Are you sure to delete this story?'\n        onConfirm={clearStoryTest}\n        onCancel={() => {}}\n        okText='Yes'\n        cancelText='No'\n        placement='right'\n      >\n        <Button type='default' block icon={<DeleteFilled />} style={{ marginBottom: 12 }}>Clear story</Button>\n      </Popconfirm>\n    );\n  };\n\n  const renderLoadSamples = () => {\n    const content = (\n      <div>\n        <Button type='default' block style={{ marginBottom: 12 }}>Sample #1 (english)</Button>\n        <Button type='default' block style={{ marginBottom: 12 }}>Sample #1 (spanish)</Button>\n      </div>\n    );\n    return (\n      <Popover placement='right' title='Select a story' content={content} trigger='click'>\n        <Button type=\"default\" block icon={<RocketOutlined />} style={{ marginBottom: 12 }}>Load samples</Button>\n      </Popover>\n    );\n  };\n\n  return (\n    <>\n      <Sider className='app-nav' collapsible collapsed={collapsed} onCollapse={toggleNav}>\n        <div className={`logo ${collapsed ? 'collapsed' : ''}`}>\n          <img src={logo} alt=\"RPG Story Playtesting\" onClick={toggleNav} />\n        </div>\n        <div className='menu-wrapper'>\n          {shouldRenderMenu && renderMenu()}\n        </div>\n        {!collapsed &&\n          <Row gutter={16} style={{ marginLeft: 8, marginRight: 8, marginTop: 32 }}>\n            <Col span={24}>\n              {!state.storyLoaded &&\n                <Button type=\"default\" onClick={() => { setNewStoryVisible(true); }} block icon={<PlusOutlined />} style={{ marginBottom: 12 }} >New story</Button>\n              }\n              {renderLoadStory()}\n              {state.storyLoaded &&\n                <>\n                  <Button type=\"default\" block icon={<DownloadOutlined />} style={{ marginBottom: 12 }} onClick={downloadStory}>Download story</Button>\n                  {renderClearStory()}\n                </>\n              }\n              {renderLoadSamples()}\n              <Button type=\"default\" block icon={<BugOutlined />} style={{ marginBottom: 12 }} onClick={devStartOver}>dev:startover</Button>\n            </Col>\n          </Row>\n        }\n      </Sider>\n      <NewStory isDrawerVisible={newStoryVisible} onDrawerClose={() => { setNewStoryVisible(false); }} />\n    </>\n  );\n};\n\nexport default AppNav;\n","import { Layout, Typography } from 'antd';\nimport { useLiveQuery } from 'dexie-react-hooks';\nimport db from '../db/AppDatabase';\nimport '../styles/components/StoryTitle.scss';\n\nconst { Header } = Layout;\nconst { Title, Text } = Typography;\n\nconst StoryTitle = () => {\n  const story = useLiveQuery(() => db.stories.where('id').equals(1).first());\n\n  if (story === undefined) return null;\n\n  return (\n    <Header className='story-title'>\n      <Title level={5}>RPG-SP: {story.title}</Title>\n      <Text type='secondary'>Version: {story.version}</Text>\n    </Header>\n  );\n};\n\nexport default StoryTitle;\n","export default __webpack_public_path__ + \"static/media/jake-reading.fddcdec6.png\";","import { Layout, Typography } from 'antd';\nimport jake_reading from '../../images/jake-reading.png';\nimport '../../styles/components/pages/EmptyProjectPage.scss';\n\nconst { Content } = Layout;\nconst { Text } = Typography;\n\nconst EmptyProjectPage = () => {\n\n  return (\n    <Content className='empty-project-page'>\n      <img src={jake_reading} alt=\"Start a new story\" />\n      <Text>Create a new story or load an existing one</Text>\n    </Content>\n  );\n};\n\nexport default EmptyProjectPage;\n","import { useState, useEffect, useContext } from 'react';\nimport { Drawer, Form, Button, Col, Row, Input, message } from 'antd';\nimport { AppContext } from '../../stores/AppStore';\nimport AppLogicController from '../../controllers/AppLogicController';\n\nconst AddCustomEntity = ({ isDrawerVisible, onDrawerClose }) => {\n  const [,dispatch] = useContext(AppContext);\n  const [form] = Form.useForm();\n  const [visible, setVisible] = useState(false);\n\n  useEffect(() => {\n    if(isDrawerVisible) { //opening drawer\n      form.resetFields();\n      openDrawer();\n    }\n  }, [isDrawerVisible, form]);\n\n  const openDrawer = () => {\n    setVisible(true);\n  };\n\n  const closeDrawer = () => {\n    setVisible(false);\n    onDrawerClose && onDrawerClose();\n  };\n\n  const onNameChange = (e) => {\n    const key = e.target.value.toLowerCase().replace(/\\s/g, '');\n    form.setFieldsValue({key: key});\n  };\n\n  const onFinish = (values) => {\n    const name = values.name.trim();\n    const key = values.key.trim();\n    const singular = values.singular.trim();\n    if(name === '' || singular === ''){\n      closeDrawer();\n      message.error('Do not leave empty fields, sorry :(');\n      return;\n    }\n    const data = {name, key, singular};\n    AppLogicController.createNewCustomEntityDef(dispatch, data).then(result => {\n      closeDrawer();\n      message.success('New entity created!');\n    }).catch(error => {\n      closeDrawer();\n      message.error('Something went wrong, sorry :(');\n    });\n  };\n\n  return (\n    <Drawer\n      title=\"Add Custom Entity\"\n      width={360}\n      onClose={closeDrawer}\n      visible={visible}\n      bodyStyle={{ paddingBottom: 20 }}\n      footer={\n        <div style={{textAlign: 'right'}} >\n          <Button onClick={closeDrawer} style={{ marginRight: 8 }}>\n            Cancel\n          </Button>\n          <Button type=\"primary\" htmlType=\"submit\" form='create-custom-entity-id'>\n            Add\n          </Button>\n        </div>\n      }\n    >\n      <Form layout=\"vertical\" name='create-custom-entity' id='create-custom-entity-id' form={form} onFinish={onFinish} requiredMark={false}>\n        <Row gutter={16}>\n          <Col span={24}>\n            <Form.Item\n              name=\"name\"\n              label=\"Name (use plural)\"\n              rules={[{ required: true, message: 'Please enter a name' }]}\n            >\n              <Input placeholder=\"Please enter a name\" onChange={onNameChange} />\n            </Form.Item>\n          </Col>\n        </Row>\n        <Row gutter={16}>\n          <Col span={24}>\n            <Form.Item\n              name=\"key\"\n              label=\"Key\"\n            >\n              <Input readOnly placeholder=\"\" />\n            </Form.Item>\n          </Col>\n        </Row>\n        <Row gutter={16}>\n          <Col span={24}>\n            <Form.Item\n              name=\"singular\"\n              label=\"Singular\"\n              rules={[{ required: true, message: 'Please enter singular entity name' }]}\n            >\n              <Input placeholder=\"Please enter singular entity name\" />\n            </Form.Item>\n          </Col>\n        </Row>\n      </Form>\n    </Drawer>\n  );\n};\n\nexport default AddCustomEntity;\n","import { useState, useEffect, useContext } from 'react';\nimport { useLiveQuery } from 'dexie-react-hooks';\nimport db from '../../db/AppDatabase';\nimport { Drawer, Button, List, Row, Col, Divider, message } from 'antd';\nimport { AppContext } from '../../stores/AppStore';\nimport AppLogicController from '../../controllers/AppLogicController';\nimport ColorPicker from 'rc-color-picker';\nimport 'rc-color-picker/assets/index.css';\n\nconst EditColors = ({ isDrawerVisible, onDrawerClose }) => {\n  const [,dispatch] = useContext(AppContext);\n  const [visible, setVisible] = useState(false);\n  const [newDefaultColors, setNewDefaultColors] = useState({});\n  const [newCustomColors, setNewCustomColors] = useState({});\n  const [saveSucceed, setSaveSucceed] = useState(true);\n\n  const customEntityDefs = useLiveQuery(() => db.custom_entity_defs.toArray());\n  const defaultEntityColors = useLiveQuery(() => db.default_entity_colors.toArray());\n\n  useEffect(() => {\n    if(isDrawerVisible) { //opening drawer\n      openDrawer();\n    }\n  }, [isDrawerVisible]);\n\n  const openDrawer = () => {\n    setNewDefaultColors({});\n    setNewCustomColors({});\n    setVisible(true);\n  };\n\n  const closeDrawer = () => {\n    setVisible(false);\n    onDrawerClose && onDrawerClose();\n  };\n\n  const setDefaultEntityColor = (id, color) => {\n    let newColors = newDefaultColors;\n    newColors[id] = color;\n    setNewDefaultColors(newColors);\n  };\n\n  const setCustomEntityColor = (id, color) => {\n    let newColors = newCustomColors;\n    newColors[id] = color;\n    setNewCustomColors(newColors);\n  };\n\n  const updateNewColors = () => {\n    setSaveSucceed(true);\n    if(Object.keys(newDefaultColors).length === 0 && Object.keys(newCustomColors).length === 0 ) {\n      closeDrawer();\n      return;\n    }\n    for (const id in newDefaultColors) {\n      AppLogicController.updateDefaultEntityColor(dispatch, parseInt(id), {'color': newDefaultColors[id]}).then(result => {\n        //\n      }).catch(error => {\n        setSaveSucceed(false);\n      });\n    }\n    for (const id in newCustomColors) {\n      AppLogicController.updateCustomEntityDefColor(dispatch, parseInt(id), {'color': newCustomColors[id]}).then(result => {\n        //\n      }).catch(error => {\n        setSaveSucceed(false);\n      });\n    }\n    if(saveSucceed) {\n      closeDrawer();\n      message.success('Colors updated!');\n    } else {\n      closeDrawer();\n      message.error('Something went wrong, sorry :(');\n    }    \n  };\n\n  return (\n    <Drawer\n      title=\"Edit Colors\"\n      width={360}\n      onClose={closeDrawer}\n      visible={visible}\n      bodyStyle={{ paddingBottom: 20 }}\n      footer={\n        <div style={{textAlign: 'right'}} >\n          <Button onClick={closeDrawer} style={{ marginRight: 8 }}>\n            Cancel\n          </Button>\n          <Button type=\"primary\" onClick={updateNewColors}>\n            Update\n          </Button>\n        </div>\n      }\n    >\n      { (defaultEntityColors !== undefined && defaultEntityColors.length > 0) && \n        <List\n          dataSource={defaultEntityColors}\n          renderItem={item => (\n            <List.Item className='default-ent-color-list-item'>\n              <Row style={{width: '100%'}}>\n                <Col span={18} style={{textTransform: 'capitalize'}}>{item.name}</Col>\n                <Col span={6} style={{textAlign: 'right'}}>\n                  <ColorPicker\n                    animation='slide-up'\n                    placement='bottomRight'\n                    enableAlpha={false}\n                    color={item.color}\n                    onChange={(colors) => { setDefaultEntityColor(item.id, colors.color) }}\n                  />\n                </Col>\n              </Row>\n            </List.Item>\n          )}\n        />\n      }\n      { (customEntityDefs !== undefined && customEntityDefs.length > 0) && \n        <>\n          <Divider style={{margin: '0'}} />\n          <List\n            dataSource={customEntityDefs}\n            renderItem={item => (\n              <List.Item className='custom-ent-color-list-item'>\n                <Row style={{width: '100%'}}>\n                  <Col span={18}>{item.name}</Col>\n                  <Col span={6} style={{textAlign: 'right'}}>\n                    <ColorPicker\n                      animation='slide-up'\n                      placement='bottomRight'\n                      enableAlpha={false}\n                      color={item.color}\n                      onChange={(colors) => { setCustomEntityColor(item.id, colors.color) }}\n                    />\n                  </Col>\n                </Row>\n              </List.Item>\n            )}\n          />\n        </>\n      }\n    </Drawer>\n  );\n};\n\nexport default EditColors;\n","import { List, Row, Col, Button, Popconfirm } from 'antd';\nimport '../../styles/components/GameStateListItem.scss';\n\nconst GameStateListItem = ({\n  gameState,\n  onEditGameStateProp = () => {},\n  onRemoveGameStateProp = () => {},\n}) => {\n\n  let defaultValue;\n  if (gameState.type.endsWith('arr')) {\n    defaultValue = '[ ' + gameState.default + ' ]';\n  } else {\n    defaultValue = gameState.default;\n  }\n\n  return (\n    <List.Item className='game-state-list-item'>\n      <Row>\n        <Col span={6}>{gameState.name}</Col>\n        <Col span={6}>{gameState.type}</Col>\n        <Col span={8}>{defaultValue}</Col>\n        <Col span={4} style={{textAlign: 'right'}}>\n          {gameState.edit_mode !== 'none' &&\n            <Button type='link' size='small' onClick={() => { onEditGameStateProp() }}>Edit</Button>\n          }\n          {gameState.removable &&\n            <Popconfirm\n              title={`Are you sure you want to remove this game state prop?`}\n              onConfirm={() => { onRemoveGameStateProp() }}\n              onCancel={() => {}}\n              okText='Yes'\n              cancelText='No'\n              placement='bottomRight'\n            >\n              <Button type='link' size='small'>Remove</Button>\n            </Popconfirm>\n          }\n        </Col>\n      </Row>\n    </List.Item>\n  );\n};\n\nexport default GameStateListItem;\n","import db from '../db/AppDatabase';\n\nclass AppValidationsController {\n  //-- validateEntityNames --//\n  static async validateEntityNames(testNames, dbTable) {\n    let invalidNames = [];\n    return db.transaction('r', dbTable, async () => {\n      for (const name of testNames) {\n        const entity = await dbTable.where({name: name}).first();\n        if(entity === undefined){\n          invalidNames.push(name);\n        }\n      }\n      if(invalidNames.length === 0) {\n        return Promise.resolve();\n      } else {\n        return Promise.reject(invalidNames);\n      }\n    });\n  }\n\n  static async validateCustomEntityNames(testNames, entityDefId) {\n    let invalidNames = [];\n    return db.transaction('r', db.custom_entities, async () => {\n      for (const name of testNames) {\n        const entity = await db.custom_entities.where({name: name, custom_entity_def_id: entityDefId}).first();\n        if(entity === undefined){\n          invalidNames.push(name);\n        }\n      }\n      if(invalidNames.length === 0) {\n        return Promise.resolve();\n      } else {\n        return Promise.reject(invalidNames);\n      }\n    });\n  }\n\n}\n\nexport default AppValidationsController;","import { useState, useEffect, useContext } from 'react';\nimport { Drawer, Form, Button, Col, Row, Input, InputNumber, Select, Switch, message } from 'antd';\nimport { AppContext } from '../../stores/AppStore';\nimport AppLogicController from '../../controllers/AppLogicController';\nimport AppValidationsController from '../../controllers/AppValidationsController';\nimport { useLiveQuery } from 'dexie-react-hooks';\nimport db from '../../db/AppDatabase';\n\nconst { TextArea } = Input;\nconst { Option } = Select;\n\nconst AddEditGameStateProp = ({ gameStateProp = null, isDrawerVisible, onDrawerClose }) => {\n  const [,dispatch] = useContext(AppContext);\n  const [form] = Form.useForm();\n  const [visible, setVisible] = useState(false);\n  const [name, setName] = useState('');\n  const [type, setType] = useState('');\n  const [defaultValueInt, setDefaultValueInt] = useState(0);\n  const [defaultValueBool, setDefaultValueBool] = useState(true);\n  const [defaultValueString, setDefaultValueString] = useState('');\n  const [defaultValueArray, setDefaultValueArray] = useState(true);\n\n  const customEntityDefs = useLiveQuery(() => db.custom_entity_defs.toArray());\n\n  useEffect(() => {\n    const populateDefault = (defaultValue) => {\n      if(!type.endsWith('arr')) { //not array\n        switch(type) {\n          case 'int':\n            form.setFieldsValue({defaultValueInt: defaultValue});\n            break;\n          case 'boolean':\n            form.setFieldsValue({defaultValueBool: defaultValue});\n            setDefaultValueBool(defaultValue);\n            break;\n          case 'string':\n          case 'location':\n          case 'area':\n          case 'character':\n          default: //custom entity\n            form.setFieldsValue({defaultValueString: defaultValue});\n            break;\n        }\n      } else { //array\n        if(defaultValue.length === 0) {\n          return;\n        }\n        const valuesArray = defaultValue.split(',');\n        switch(type) {\n          case 'intarr':\n          case 'booleanarr':\n            form.setFieldsValue({defaultValueArray: valuesArray.join('\\n')});\n            break;\n          case 'stringarr':\n          case 'locationarr':\n          case 'areaarr':\n          case 'characterarr':\n          default: //custom entity array\n            let unquotedEntries = [];\n            for (const entry of valuesArray) {\n              unquotedEntries.push(entry.slice(1, -1));\n            }\n            form.setFieldsValue({defaultValueArray: unquotedEntries.join('\\n')});\n            break;\n        }\n      }\n    };\n\n    if(isDrawerVisible) { //opening drawer\n      form.resetFields();\n      setType('');\n      if (gameStateProp) {\n        form.setFieldsValue({name: gameStateProp.name, type: gameStateProp.type});\n        setType(gameStateProp.type);\n        populateDefault(gameStateProp.default);\n      }\n      openDrawer();\n    }\n  }, [isDrawerVisible, form, gameStateProp]); // eslint-disable-line\n\n  const openDrawer = () => {\n    setVisible(true);\n  };\n\n  const closeDrawer = () => {\n    setVisible(false);\n    onDrawerClose && onDrawerClose();\n  };\n\n  const handleTypeChange = (value) => {\n    if(value === 'int') {\n      form.setFieldsValue({defaultValueInt: ''});\n    }\n    if(value === 'boolean') {\n      form.setFieldsValue({defaultValueBool: defaultValueBool});\n    }\n    if(value.endsWith('arr')){\n      form.setFieldsValue({defaultValueArray: ''});\n    }\n    if(value !== '' && value !== 'int' && value !== 'boolean' && !value.endsWith('arr')){\n      form.setFieldsValue({defaultValueString: ''});\n    }\n    setType(value);\n  };\n\n  const displaySingleLineDefaultField = () => {\n    return type !== '' && type !== 'int' && type !== 'boolean' && !type.endsWith('arr');\n  };\n\n  const displayArrayDefaultField = () => {\n    return type.endsWith('arr');\n  };\n\n  const arrayFieldLabelAndPlaceholder = (label = true) => {\n    switch(type) {\n      case 'intarr':\n        return label ? 'int[]' : 'Place one integer per line';\n      case 'booleanarr':\n        return label ? 'boolean[]' : 'Place one boolean per line';\n      case 'stringarr':\n        return label ? 'string[]' : 'Place one string per line';\n      case 'locationarr':\n        return label ? 'location[]' : 'Place one location per line';\n      case 'areaarr':\n        return label ? 'area[]' : 'Place one area per line';\n      case 'characterarr':\n        return label ? 'character[]' : 'Place one character per line';\n      default:\n        if(type.endsWith('arr')) {\n          const singular_name = type.slice(0, -3);\n          return label ? singular_name+'[]' : 'Place one '+singular_name+' per line';\n        } else {\n          return label ? '[]' : 'Place one item per line';\n        }\n    }\n  };\n\n  const onFinish = (values) => {\n    const name = values.name.trim();\n    if(name === ''){\n      message.error('Do not leave name empty');\n      return;\n    }\n    //validate type & default value\n    switch(type) {\n      case 'int':\n        if(!Number.isInteger(parseInt(values.defaultValueInt))){\n          message.error('Default is not an integer');\n        } else {\n          saveGameStateProp(values);\n        }\n        break;\n      case 'boolean':\n      case 'string':\n        saveGameStateProp(values);\n        break;\n      case 'location':\n        const defaultLocation = values.defaultValueString.trim();\n        AppValidationsController.validateEntityNames([defaultLocation], db.locations).then(() => {\n          saveGameStateProp(values);\n        }).catch(invalidLocations => {\n          message.error('Invalid values: ' + invalidLocations.join(', '));\n        });\n        break;\n      case 'area':\n        const defaultArea = values.defaultValueString.trim();\n        AppValidationsController.validateEntityNames([defaultArea], db.areas).then(() => {\n          saveGameStateProp(values);\n        }).catch(invalidAreas => {\n          message.error('Invalid values: ' + invalidAreas.join(', '));\n        });\n        break;\n      case 'character':\n        const defaultCharacter = values.defaultValueString.trim();\n        AppValidationsController.validateEntityNames([defaultCharacter], db.characters).then(() => {\n          saveGameStateProp(values);\n        }).catch(invalidCharacters => {\n          message.error('Invalid values: ' + invalidCharacters.join(', '));\n        });\n        break;\n      default:\n        if(!type.endsWith('arr')) { \n          if(type !== 'boolean' && type !== 'string') { //custom entity\n            const customEntityDef = customEntityDefs.find(customEntityDef => customEntityDef.singular_name === type);\n            if (customEntityDef) {\n              const defaultEntity = values.defaultValueString.trim();\n              AppValidationsController.validateCustomEntityNames([defaultEntity], customEntityDef.id).then(() => {\n                saveGameStateProp(values);\n              }).catch(invalidEntities => {\n                message.error('Invalid values: ' + invalidEntities.join(', '));\n              });\n            }\n          }\n        } else { //any array type\n          valudateArrayTypes(values)\n        }\n        break;\n    }\n  };\n\n  const valudateArrayTypes = (values) => {\n    const defaultValues = values.defaultValueArray;\n    if(defaultValues.length === 0) {\n      saveGameStateProp(values);\n    } else {\n      const valuesArray = defaultValues.split('\\n');\n      switch(type) {\n        case 'intarr':\n          for (const integerValue of valuesArray) {\n            if(!Number.isInteger(parseInt(integerValue))){\n              message.error('All values in array must be integers');\n              return;\n            }\n          }\n          saveGameStateProp(values);\n          break;\n        case 'booleanarr':\n          for (const booleanValue of valuesArray) {\n            if(!(booleanValue === 'true' || booleanValue === 'false')){\n              message.error('All values in array must be \"true\" or \"false\"');\n              return;\n            }\n          }\n          saveGameStateProp(values);\n          break;\n        case 'stringarr':\n          for (const stringValue of valuesArray) {\n            if(stringValue.trim() === ''){\n              message.error('Do not leave empty strings (just spaces are considered empty)');\n              return;\n            }\n          }\n          saveGameStateProp(values);\n          break;\n        case 'locationarr':\n          AppValidationsController.validateEntityNames(valuesArray, db.locations).then(() => {\n            saveGameStateProp(values);\n          }).catch(invalidLocations => {\n            message.error('Invalid values: ' + invalidLocations.join(', '));\n          });\n          break;\n        case 'areaarr':\n          AppValidationsController.validateEntityNames(valuesArray, db.areas).then(() => {\n            saveGameStateProp(values);\n          }).catch(invalidAreas => {\n            message.error('Invalid values: ' + invalidAreas.join(', '));\n          });\n          break;\n        case 'characterarr':\n          AppValidationsController.validateEntityNames(valuesArray, db.characters).then(() => {\n            saveGameStateProp(values);\n          }).catch(invalidCharacters => {\n            message.error('Invalid values: ' + invalidCharacters.join(', '));\n          });\n          break;\n        default: //custom entities\n          const singular_name = type.slice(0, -3);\n          const customEntityDef = customEntityDefs.find(customEntityDef => customEntityDef.singular_name === singular_name);\n          if (customEntityDef) {\n            AppValidationsController.validateCustomEntityNames(valuesArray, customEntityDef.id).then(() => {\n              saveGameStateProp(values);\n            }).catch(invalidEntities => {\n              message.error('Invalid values: ' + invalidEntities.join(', '));\n            });\n          }\n          break;\n      }\n    }\n  };\n\n  const saveGameStateProp = (values) => {\n    if (gameStateProp === null) { //new gameStateProp\n      const name = values.name.trim();\n      const defaultValue = getDefaultValue(values);\n      const editMode = 'name|default';\n      const removable = true;\n      const newData = {name, type, defaultValue, editMode, removable};\n      AppLogicController.createNewGameStateProp(dispatch, newData).then(result => {\n        closeDrawer();\n        message.success('New game state prop created!');\n      }).catch(error => {\n        closeDrawer();\n        message.error('Something went wrong, sorry :(');\n      });\n    } else { //editing gameStateProp\n      const name = values.name.trim();\n      const defaultValue = getDefaultValue(values);\n      const editMode = gameStateProp.edit_mode;\n      const removable = gameStateProp.removable;\n      const editData = {name, type, defaultValue, editMode, removable};\n      AppLogicController.updateGameStateProp(dispatch, gameStateProp.id, editData).then(result => {\n        closeDrawer();\n        message.success('Game state prop edited!');\n      }).catch(error => {\n        closeDrawer();\n        message.error('Something went wrong, sorry :(');\n      });\n    }\n  };\n\n  const getDefaultValue = (values) => {\n    if(!type.endsWith('arr')) { //not array\n      switch(type) {\n        case 'int':\n          return parseInt(values.defaultValueInt);\n        case 'boolean':\n          return values.defaultValueBool;\n        case 'string':\n        case 'location':\n        case 'area':\n        case 'character':\n        default: //custom entity\n          return values.defaultValueString;\n      }\n    } else { //array\n      const defaultValues = values.defaultValueArray;\n      if(defaultValues.length === 0) {\n        return '';\n      }\n      const valuesArray = defaultValues.split('\\n');\n      switch(type) {\n        case 'intarr':\n        case 'booleanarr':\n          return valuesArray.join(',');\n        case 'stringarr':\n        case 'locationarr':\n        case 'areaarr':\n        case 'characterarr':\n        default: //custom entity array\n          let quotesWrappedEntries = [];\n          for (const entry of valuesArray) {\n            quotesWrappedEntries.push('\"' + entry + '\"');\n          }\n          return quotesWrappedEntries.join(',');\n      }\n    }\n  };\n\n  const isNameDisabled = () => {\n    if(gameStateProp === null) {\n      return false;\n    } else {\n      const editMode = gameStateProp.edit_mode.split('|');\n      return editMode.indexOf('all') < 0 && editMode.indexOf('name') < 0;\n    } \n  };\n\n  const isTypeDisabled = () => {\n    if(gameStateProp === null) {\n      return false;\n    } else {\n      const editMode = gameStateProp.edit_mode.split('|');\n      return editMode.indexOf('all') < 0 && editMode.indexOf('type') < 0;\n    } \n  };\n\n  const isDefaultDisabled = () => {\n    if(gameStateProp === null) {\n      return false;\n    } else {\n      const editMode = gameStateProp.edit_mode.split('|');\n      return editMode.indexOf('all') < 0 && editMode.indexOf('default') < 0;\n    } \n  };\n\n  return (\n    <Drawer\n      title={(gameStateProp === null) ? 'New prop' : 'Edit prop'}\n      width={360}\n      onClose={closeDrawer}\n      visible={visible}\n      bodyStyle={{ paddingBottom: 20 }}\n      footer={\n        <div style={{textAlign: 'right'}} >\n          <Button onClick={closeDrawer} style={{ marginRight: 8 }}>\n            Cancel\n          </Button>\n          <Button type=\"primary\" htmlType=\"submit\" form='add-edit-game-state-prop-id'>\n            {(gameStateProp === null) ? 'Create' : 'Update'}\n          </Button>\n        </div>\n      }\n    >\n      <Form layout='vertical' name='add-edit-game-state-prop' id='add-edit-game-state-prop-id' form={form} onFinish={onFinish} requiredMark={false}>\n        <Row gutter={16}>\n          <Col span={24}>\n            <Form.Item\n              name=\"name\"\n              label=\"Name\"\n              rules={[{ required: true, message: 'Please enter a name' }]}\n            >\n              <Input placeholder=\"Please enter a name\" value={name} onChange={(e) => { setName(e.target.value) }} disabled={isNameDisabled()} />\n            </Form.Item>\n          </Col>\n        </Row>\n        <Row gutter={16}>\n          <Col span={24}>\n            <Form.Item\n              name=\"type\"\n              label=\"Type\"\n              rules={[{ required: true, message: 'Please select a type' }]}\n            >\n              <Select value={type} onChange={(e) => { handleTypeChange(e) }} disabled={isTypeDisabled()}>\n                <Option value='int'>int</Option>\n                <Option value='intarr'>int[]</Option>\n                <Option value='boolean'>boolean</Option>\n                <Option value='booleanarr'>boolean[]</Option>\n                <Option value='string'>string</Option>\n                <Option value='stringarr'>string[]</Option>\n                <Option value='location'>location</Option>\n                <Option value='locationarr'>location[]</Option>\n                <Option value='area'>area</Option>\n                <Option value='areaarr'>area[]</Option>\n                <Option value='character'>character</Option>\n                <Option value='characterarr'>character[]</Option>\n                { customEntityDefs !== undefined && customEntityDefs.map((customEntityDef) =>\n                  <>\n                    <Option value={customEntityDef.singular_name}>{customEntityDef.singular_name}</Option>\n                    <Option value={customEntityDef.singular_name + 'arr'}>{customEntityDef.singular_name}[]</Option>\n                  </>\n                  )\n                }\n              </Select>\n            </Form.Item>\n          </Col>\n        </Row>\n        <Row gutter={16} style={{display: (type === 'int' ? 'block' : 'none')}}>\n          <Col span={24}>\n            <Form.Item\n              name=\"defaultValueInt\"\n              label=\"Default value (int)\"\n              rules={[{ required: (type === 'int'), message: 'Please enter an integer' }]}\n            >\n              <InputNumber disabled={isDefaultDisabled()} placeholder=\"Please enter an integer\" value={defaultValueInt} onChange={(e) => { setDefaultValueInt(e) }} style={{width: '100%'}} />\n            </Form.Item>\n          </Col>\n        </Row>\n        <Row gutter={16} style={{display: (type === 'boolean' ? 'block' : 'none')}}>\n          <Col span={24}>\n            <Form.Item\n              name=\"defaultValueBool\"\n              label=\"Default value (boolean)\"\n            >\n              <Switch disabled={isDefaultDisabled()} checkedChildren=\"true\" unCheckedChildren=\"false\" checked={defaultValueBool} defaultChecked onChange={(e) => { setDefaultValueBool(e) }} />\n            </Form.Item>\n          </Col>\n        </Row>\n        <Row gutter={16} style={{display: (displaySingleLineDefaultField() ? 'block' : 'none')}}>\n          <Col span={24}>\n            <Form.Item\n              name=\"defaultValueString\"\n              label=\"Default value (string)\"\n              rules={[{ required: displaySingleLineDefaultField() && type !== 'string', message: 'Please enter a default value' }]}\n            >\n              <Input disabled={isDefaultDisabled()} placeholder=\"Please enter a default value\" value={defaultValueString} onChange={(e) => { setDefaultValueString(e.target.value) }} />\n            </Form.Item>\n          </Col>\n        </Row>\n        <Row gutter={16} style={{display: (displayArrayDefaultField() ? 'block' : 'none')}}>\n          <Col span={24}>\n            <Form.Item\n              name=\"defaultValueArray\"\n              label={'Default value (' + arrayFieldLabelAndPlaceholder() + ')'}\n            >\n              <TextArea disabled={isDefaultDisabled()} rows={10} placeholder={arrayFieldLabelAndPlaceholder(false) + ' Leave empty for empty array.'} value={defaultValueArray} onChange={(e) => { setDefaultValueArray(e.target.value) }} />\n            </Form.Item>\n          </Col>\n        </Row>\n      </Form>\n    </Drawer>\n  );\n};\n\nexport default AddEditGameStateProp;\n","import { useState, useContext } from 'react';\nimport { AppContext } from '../../stores/AppStore';\nimport AppLogicController from '../../controllers/AppLogicController';\nimport { useLiveQuery } from 'dexie-react-hooks';\nimport db from '../../db/AppDatabase';\nimport GameStateListItem from '../entity_views/GameStateListItem';\nimport { List, Row, Col, Typography, Button, message } from 'antd';\nimport AddEditGameStateProp from '../drawers/AddEditGameStateProp';\n\nconst { Text } = Typography;\n\nconst GameStateConfigSection = () => {\n  const [,dispatch] = useContext(AppContext);\n  const [addEditGameStatePropVisible, setAddEditGameStatePropVisible] = useState(false);\n  const [currentGameStateProp, setCurrentGameStateProp] = useState(null);\n\n  const gameStates = useLiveQuery(() => db.game_state_props.toArray());\n\n  const addGameStateProp = () => {\n    setCurrentGameStateProp(null);\n    setAddEditGameStatePropVisible(true);\n  };\n\n  const editGameStateProp = (gameStateProp) => {\n    setCurrentGameStateProp(gameStateProp);\n    setAddEditGameStatePropVisible(true);\n  };\n\n  const removeGameStateProp = (gameStateProp) => {\n    AppLogicController.deleteGameStateProp(dispatch, gameStateProp.id).then(result => {\n      message.success('Game state prop removed!');\n    }).catch(error => {\n      message.error('Something went wrong, sorry :(');\n    });\n  };\n\n  const header = (\n    <Row>\n      <Col span={6}><Text strong>Name</Text></Col>\n      <Col span={6}><Text strong>Type</Text></Col>\n      <Col span={8}><Text strong>Default</Text></Col>\n      <Col span={4}></Col>\n    </Row>\n  );\n\n  return (\n    <div>\n      { (gameStates !== undefined && gameStates.length > 0) && \n        <List\n          style={{marginBottom: '20px', maxWidth: '94%'}}\n          header={header}\n          dataSource={gameStates}\n          renderItem={item => (\n            <GameStateListItem\n              gameState={item}\n              onEditGameStateProp={() => { editGameStateProp(item); }} \n              onRemoveGameStateProp={() => { removeGameStateProp(item); }} \n            />\n          )}\n        />\n      }\n      <Button type='primary' onClick={addGameStateProp}>\n        Add Game State Prop\n      </Button>\n      <AddEditGameStateProp\n        gameStateProp={currentGameStateProp}\n        isDrawerVisible={addEditGameStatePropVisible} \n        onDrawerClose={() => { setAddEditGameStatePropVisible(false); }} \n      />\n    </div>\n  );\n};\n\nexport default GameStateConfigSection;","import { Card, Divider, Typography, Button, List, Row, Col, Popconfirm } from 'antd';\nimport { useLiveQuery } from 'dexie-react-hooks';\nimport db from '../../db/AppDatabase';\nimport '../../styles/components/LocationView.scss';\n\nconst { Text } = Typography;\n\nconst LocationView = ({ \n  location,  \n  canEdit = true, \n  canRemove = true,\n  onRemove = () => {},\n  onEdit = () => {},\n  //\n  onAddArea = () => {},\n  onEditArea = () => {},\n  onRemoveArea = () => {},\n}) => {\n\n  const areas = useLiveQuery(() => db.areas.where('location_id').equals(location.id).toArray());\n\n  const options = [];\n  if(canEdit) {\n    options.push(<Button key='edit-location' type='link' size='small' onClick={onEdit}>Edit</Button>);\n  }\n  if(canRemove) {\n    options.push(\n      <Popconfirm\n        key='remove-location'\n        title={`Are you sure you want to remove this location and all its areas?`}\n        onConfirm={onRemove}\n        onCancel={() => {}}\n        okText='Yes'\n        cancelText='No'\n        placement='bottomRight'\n      >\n        <Button type='link' size='small'>Remove</Button>\n      </Popconfirm>\n    );\n  }\n\n  const header = (\n    <Row>\n      <Col span={6}><Text strong>Area Name</Text></Col>\n      <Col span={12}><Text strong>Description</Text></Col>\n      <Col span={6}></Col>\n    </Row>\n  );\n\n  return (\n    <Card className='location-view' size='small' title={location.name} extra={options} headStyle={{ background: '#f5f5f5'}} >\n      <Text>{location.description}</Text>\n      <Divider />\n      { (areas !== undefined && areas.length > 0) && \n        <List\n          header={header}\n          dataSource={areas}\n          renderItem={area => (\n            <List.Item className='area-list-item'>\n              <Row>\n                <Col span={6}>{area.name}</Col>\n                <Col span={12}>{area.description}</Col>\n                <Col span={6} style={{textAlign: 'right'}}>\n                  <Button type='link' size='small' onClick={() => { onEditArea(area) }}>Edit</Button>\n                  <Popconfirm\n                    title={`Are you sure you want to remove this area?`}\n                    onConfirm={() => { onRemoveArea(area) }}\n                    onCancel={() => {}}\n                    okText='Yes'\n                    cancelText='No'\n                    placement='bottomRight'\n                  >\n                    <Button type='link' size='small'>Remove</Button>\n                  </Popconfirm>\n                </Col>\n              </Row>\n            </List.Item>\n          )}\n        />\n      }\n      <Button type='default' size='small' onClick={onAddArea}>\n        Add Area\n      </Button>\n    </Card>\n  );\n};\n\nexport default LocationView;\n","import { useState, useEffect, useContext } from 'react';\nimport { Drawer, Form, Button, Col, Row, Input, message } from 'antd';\nimport { AppContext } from '../../stores/AppStore';\nimport AppLogicController from '../../controllers/AppLogicController';\n\nconst { TextArea } = Input;\n\nconst AddEditLocation = ({ location = null, isDrawerVisible, onDrawerClose }) => {\n  const [,dispatch] = useContext(AppContext);\n  const [form] = Form.useForm();\n  const [visible, setVisible] = useState(false);\n  const [name, setName] = useState('');\n  const [description, setDescription] = useState('');\n\n  useEffect(() => {\n    if(isDrawerVisible) { //opening drawer\n      form.resetFields();\n      if (location) {\n        form.setFieldsValue({name: location.name, description: location.description});\n      }\n      openDrawer();\n    }\n  }, [isDrawerVisible, form, location]);\n\n  const openDrawer = () => {\n    setVisible(true);\n  };\n\n  const closeDrawer = () => {\n    setVisible(false);\n    onDrawerClose && onDrawerClose();\n  };\n\n  const onFinish = (values) => {\n    const name = values.name.trim();\n    const description = values.description.trim();\n    if(name === '' || description === ''){\n      closeDrawer();\n      message.error('Do not leave empty fields, sorry :(');\n      return;\n    }\n    const data = {name, description};\n    if (location === null) { //new location\n      AppLogicController.createNewLocation(dispatch, data).then(result => {\n        closeDrawer();\n        message.success('New location created!');\n      }).catch(error => {\n        closeDrawer();\n        message.error('Something went wrong, sorry :(');\n      });\n    } else { //editing location\n      AppLogicController.updateLocation(dispatch, location.id, data).then(result => {\n        closeDrawer();\n        message.success('Location edited!');\n      }).catch(error => {\n        closeDrawer();\n        message.error('Something went wrong, sorry :(');\n      });\n    }\n  };\n\n  return (\n    <Drawer\n      title={(location === null) ? 'New location' : 'Edit location'}\n      width={360}\n      onClose={closeDrawer}\n      visible={visible}\n      bodyStyle={{ paddingBottom: 20 }}\n      footer={\n        <div style={{textAlign: 'right'}} >\n          <Button onClick={closeDrawer} style={{ marginRight: 8 }}>\n            Cancel\n          </Button>\n          <Button type=\"primary\" htmlType=\"submit\" form='add-edit-location-id'>\n            {(location === null) ? 'Create' : 'Update'}\n          </Button>\n        </div>\n      }\n    >\n      <Form layout='vertical' name='add-edit-location' id='add-edit-location-id' form={form} onFinish={onFinish} requiredMark={false}>\n        <Row gutter={16}>\n          <Col span={24}>\n            <Form.Item\n              name=\"name\"\n              label=\"Name\"\n              rules={[{ required: true, message: 'Please enter a name' }]}\n            >\n              <Input placeholder=\"Please enter a name\" value={name} onChange={(e) => { setName(e.target.value) }} />\n            </Form.Item>\n          </Col>\n        </Row>\n        <Row gutter={16}>\n          <Col span={24}>\n            <Form.Item\n              name=\"description\"\n              label=\"Description\"\n              rules={[{ required: true, message: 'Please enter a description' }]}\n            >\n              <TextArea rows={10} placeholder=\"Please enter a description\" value={description} onChange={(e) => { setDescription(e.target.value) }} />\n            </Form.Item>\n          </Col>\n        </Row>\n      </Form>\n    </Drawer>\n  );\n};\n\nexport default AddEditLocation;\n","import { useState, useEffect, useContext } from 'react';\nimport { Drawer, Form, Button, Col, Row, Input, message } from 'antd';\nimport { AppContext } from '../../stores/AppStore';\nimport AppLogicController from '../../controllers/AppLogicController';\n\nconst { TextArea } = Input;\n\nconst AddEditArea = ({ area = null, location, isDrawerVisible, onDrawerClose }) => {\n  const [,dispatch] = useContext(AppContext);\n  const [form] = Form.useForm();\n  const [visible, setVisible] = useState(false);\n  const [name, setName] = useState('');\n  const [description, setDescription] = useState('');\n\n  useEffect(() => {\n    if(isDrawerVisible) { //opening drawer\n      form.resetFields();\n      if (area) {\n        form.setFieldsValue({name: area.name, description: area.description});\n      }\n      openDrawer();\n    }\n  }, [isDrawerVisible, form, area]);\n\n  const openDrawer = () => {\n    setVisible(true);\n  };\n\n  const closeDrawer = () => {\n    setVisible(false);\n    onDrawerClose && onDrawerClose();\n  };\n\n  const onFinish = (values) => {\n    const name = values.name.trim();\n    const description = values.description.trim();\n    if(name === '' || description === ''){\n      closeDrawer();\n      message.error('Do not leave empty fields, sorry :(');\n      return;\n    }\n    let data = {name, description};\n    if (area === null) { //new area\n      data.location_id = location.id;\n      AppLogicController.createNewArea(dispatch, data).then(result => {\n        closeDrawer();\n        message.success('New area created!');\n      }).catch(error => {\n        closeDrawer();\n        message.error('Something went wrong, sorry :(');\n      });\n    } else { //editing area\n      AppLogicController.updateArea(dispatch, area.id, data).then(result => {\n        closeDrawer();\n        message.success('Area edited!');\n      }).catch(error => {\n        closeDrawer();\n        message.error('Something went wrong, sorry :(');\n      });\n    }\n  };\n\n  return (\n    <Drawer\n      title={((area === null) ? 'New area' : 'Edit area') + ' in ' + (location && location.name)}\n      width={360}\n      onClose={closeDrawer}\n      visible={visible}\n      bodyStyle={{ paddingBottom: 20 }}\n      footer={\n        <div style={{textAlign: 'right'}} >\n          <Button onClick={closeDrawer} style={{ marginRight: 8 }}>\n            Cancel\n          </Button>\n          <Button type=\"primary\" htmlType=\"submit\" form='add-edit-area-id'>\n            {(area === null) ? 'Create' : 'Update'}\n          </Button>\n        </div>\n      }\n    >\n      <Form layout='vertical' name='add-edit-area' id='add-edit-area-id' form={form} onFinish={onFinish} requiredMark={false}>\n        <Row gutter={16}>\n          <Col span={24}>\n            <Form.Item\n              name=\"name\"\n              label=\"Name\"\n              rules={[{ required: true, message: 'Please enter a name' }]}\n            >\n              <Input placeholder=\"Please enter a name\" value={name} onChange={(e) => { setName(e.target.value) }} />\n            </Form.Item>\n          </Col>\n        </Row>\n        <Row gutter={16}>\n          <Col span={24}>\n            <Form.Item\n              name=\"description\"\n              label=\"Description\"\n              rules={[{ required: true, message: 'Please enter a description' }]}\n            >\n              <TextArea rows={10} placeholder=\"Please enter a description\" value={description} onChange={(e) => { setDescription(e.target.value) }} />\n            </Form.Item>\n          </Col>\n        </Row>\n      </Form>\n    </Drawer>\n  );\n};\n\nexport default AddEditArea;\n","import { useState, useContext } from 'react';\nimport { AppContext } from '../../stores/AppStore';\nimport AppLogicController from '../../controllers/AppLogicController';\nimport { Button, message } from 'antd';\nimport { useLiveQuery } from 'dexie-react-hooks';\nimport db from '../../db/AppDatabase';\nimport LocationView from '../entity_views/LocationView';\nimport AddEditLocation from '../drawers/AddEditLocation';\nimport AddEditArea from '../drawers/AddEditArea';\n\nconst LocationConfigSection = () => {\n  const [,dispatch] = useContext(AppContext);\n  const [addEditLocationVisible, setAddEditLocationVisible] = useState(false);\n  const [addEditAreaVisible, setAddEditAreaVisible] = useState(false);\n  const [currentLocation, setCurrentLocation] = useState(null);\n  const [currentArea, setCurrentArea] = useState(null);\n\n  const locations = useLiveQuery(() => db.locations.toArray());\n\n  //location handlers\n  const addLocation = () => {\n    setCurrentLocation(null);\n    setAddEditLocationVisible(true);\n  };\n\n  const editLocation = (location) => {\n    setCurrentLocation(location);\n    setAddEditLocationVisible(true);\n  };\n\n  const removeLocation = (location) => {\n    AppLogicController.deleteLocation(dispatch, location.id).then(result => {\n      message.success('Location removed!');\n    }).catch(error => {\n      message.error('Something went wrong, sorry :(');\n    });\n  };\n\n  //area handlers\n  const addArea = (location) => {\n    setCurrentArea(null);\n    setCurrentLocation(location);\n    setAddEditAreaVisible(true);\n  };\n\n  const editArea = (area, location) => {\n    setCurrentLocation(location);\n    setCurrentArea(area);\n    setAddEditAreaVisible(true);\n  };\n\n  const removeArea = (area) => {\n    AppLogicController.deleteArea(dispatch, area.id).then(result => {\n      message.success('Area removed!');\n    }).catch(error => {\n      message.error('Something went wrong, sorry :(');\n    });\n  };\n\n  return (\n    <div>\n      { locations !== undefined && locations.map(location =>\n        <LocationView \n          key={location.id} \n          location={location} \n          onRemove={() => { removeLocation(location) }} \n          onEdit={() => { editLocation(location) }} \n          onAddArea={() => { addArea(location) }} \n          onEditArea={(area) => { editArea(area, location) }}\n          onRemoveArea={(area) => { removeArea(area) }}\n        />\n        )\n      }\n      <Button type='primary' onClick={addLocation}>\n        Add Location\n      </Button>\n      <AddEditLocation\n        location={currentLocation}\n        isDrawerVisible={addEditLocationVisible} \n        onDrawerClose={() => { setAddEditLocationVisible(false); }} \n      />\n      <AddEditArea\n        area={currentArea}\n        location={currentLocation}\n        isDrawerVisible={addEditAreaVisible} \n        onDrawerClose={() => { setAddEditAreaVisible(false); }} \n      />\n    </div>\n  );\n};\n\nexport default LocationConfigSection;\n","import { Card, Typography, Button, Popconfirm } from 'antd';\nimport '../../styles/components/SimpleEntityView.scss';\n\nconst { Text } = Typography;\n\nconst SimpleEntityView = ({ \n  entity, \n  entityName = 'entity', \n  canEdit = true, \n  canRemove = true,\n  onRemove = () => {},\n  onEdit = () => {},\n}) => {\n\n  const options = [];\n  if(canEdit) {\n    options.push(<Button key='edit-entity' type='link' size='small' onClick={onEdit}>Edit</Button>);\n  }\n  if(canRemove) {\n    options.push(\n      <Popconfirm\n        key='remove-entity'\n        title={`Are you sure you want to remove this ${entityName}?`}\n        onConfirm={onRemove}\n        onCancel={() => {}}\n        okText='Yes'\n        cancelText='No'\n        placement='bottomRight'\n      >\n        <Button type='link' size='small'>Remove</Button>\n      </Popconfirm>\n    );\n  }\n\n  return (\n    <Card className='simple-entity-view' size='small' title={entity.name} extra={options} headStyle={{ background: '#f5f5f5'}} >\n      <Text>{entity.description}</Text>\n    </Card>\n  );\n};\n\nexport default SimpleEntityView;\n","import { useState, useEffect, useContext } from 'react';\nimport { Drawer, Form, Button, Col, Row, Input, message } from 'antd';\nimport { AppContext } from '../../stores/AppStore';\nimport AppLogicController from '../../controllers/AppLogicController';\n\nconst { TextArea } = Input;\n\nconst AddEditCharacter = ({ character = null, isDrawerVisible, onDrawerClose }) => {\n  const [,dispatch] = useContext(AppContext);\n  const [form] = Form.useForm();\n  const [visible, setVisible] = useState(false);\n  const [name, setName] = useState('');\n  const [description, setDescription] = useState('');\n\n  useEffect(() => {\n    if(isDrawerVisible) { //opening drawer\n      form.resetFields();\n      if (character) {\n        form.setFieldsValue({name: character.name, description: character.description});\n      }\n      openDrawer();\n    }\n  }, [isDrawerVisible, form, character]);\n\n  const openDrawer = () => {\n    setVisible(true);\n  };\n\n  const closeDrawer = () => {\n    setVisible(false);\n    onDrawerClose && onDrawerClose();\n  };\n\n  const onFinish = (values) => {\n    const name = values.name.trim();\n    const description = values.description.trim();\n    if(name === '' || description === ''){\n      closeDrawer();\n      message.error('Do not leave empty fields, sorry :(');\n      return;\n    }\n    const data = {name, description};\n    if (character === null) { //new character\n      AppLogicController.createNewCharacter(dispatch, data).then(result => {\n        closeDrawer();\n        message.success('New character created!');\n      }).catch(error => {\n        closeDrawer();\n        message.error('Something went wrong, sorry :(');\n      });\n    } else { //editing character\n      AppLogicController.updateCharacter(dispatch, character.id, data).then(result => {\n        closeDrawer();\n        message.success('Character edited!');\n      }).catch(error => {\n        closeDrawer();\n        message.error('Something went wrong, sorry :(');\n      });\n    }\n  };\n\n  return (\n    <Drawer\n      title={(character === null) ? 'New character' : 'Edit character'}\n      width={360}\n      onClose={closeDrawer}\n      visible={visible}\n      bodyStyle={{ paddingBottom: 20 }}\n      footer={\n        <div style={{textAlign: 'right'}} >\n          <Button onClick={closeDrawer} style={{ marginRight: 8 }}>\n            Cancel\n          </Button>\n          <Button type=\"primary\" htmlType=\"submit\" form='add-edit-character-id'>\n            {(character === null) ? 'Create' : 'Update'}\n          </Button>\n        </div>\n      }\n    >\n      <Form layout='vertical' name='add-edit-character' id='add-edit-character-id' form={form} onFinish={onFinish} requiredMark={false}>\n        <Row gutter={16}>\n          <Col span={24}>\n            <Form.Item\n              name=\"name\"\n              label=\"Name\"\n              rules={[{ required: true, message: 'Please enter a name' }]}\n            >\n              <Input placeholder=\"Please enter a name\" value={name} onChange={(e) => { setName(e.target.value) }} />\n            </Form.Item>\n          </Col>\n        </Row>\n        <Row gutter={16}>\n          <Col span={24}>\n            <Form.Item\n              name=\"description\"\n              label=\"Description\"\n              rules={[{ required: true, message: 'Please enter a description' }]}\n            >\n              <TextArea rows={10} placeholder=\"Please enter a description\" value={description} onChange={(e) => { setDescription(e.target.value) }} />\n            </Form.Item>\n          </Col>\n        </Row>\n      </Form>\n    </Drawer>\n  );\n};\n\nexport default AddEditCharacter;\n","import { useState, useContext } from 'react';\nimport { AppContext } from '../../stores/AppStore';\nimport AppLogicController from '../../controllers/AppLogicController';\nimport { Button, message } from 'antd';\nimport { useLiveQuery } from 'dexie-react-hooks';\nimport db from '../../db/AppDatabase';\nimport SimpleEntityView from '../entity_views/SimpleEntityView';\nimport AddEditCharacter from '../drawers/AddEditCharacter';\n\nconst CharacterConfigSection = () => {\n  const [,dispatch] = useContext(AppContext);\n  const [addEditCharacterVisible, setAddEditCharacterVisible] = useState(false);\n  const [currentCharacter, setCurrentCharacter] = useState(null);\n\n  const characters = useLiveQuery(() => db.characters.toArray());\n\n  const addCharacter = () => {\n    setCurrentCharacter(null);\n    setAddEditCharacterVisible(true);\n  };\n\n  const editCharacter = (character) => {\n    setCurrentCharacter(character);\n    setAddEditCharacterVisible(true);\n  };\n\n  const removeCharacter = (character) => {\n    AppLogicController.deleteCharacter(dispatch, character.id).then(result => {\n      message.success('Character removed!');\n    }).catch(error => {\n      message.error('Something went wrong, sorry :(');\n    });\n  };\n\n  return (\n    <div>\n      { characters !== undefined && characters.map(character =>\n        <SimpleEntityView \n          key={character.id} \n          entity={character} \n          entityName='character' \n          onRemove={() => { removeCharacter(character) }} \n          onEdit={() => { editCharacter(character) }} \n        />\n        )\n      }\n      <Button type='primary' onClick={addCharacter}>\n        Add Character\n      </Button>\n      <AddEditCharacter\n        character={currentCharacter}\n        isDrawerVisible={addEditCharacterVisible} \n        onDrawerClose={() => { setAddEditCharacterVisible(false); }} \n      />\n    </div>\n  );\n};\n\nexport default CharacterConfigSection;\n","import { useState, useEffect, useContext } from 'react';\nimport { Drawer, Form, Button, Col, Row, Input, message } from 'antd';\nimport { AppContext } from '../../stores/AppStore';\nimport AppLogicController from '../../controllers/AppLogicController';\n\nconst { TextArea } = Input;\n\nconst AddEditCustomEntity = ({ entity = null, entityDef, isDrawerVisible, onDrawerClose }) => {\n  const [,dispatch] = useContext(AppContext);\n  const [form] = Form.useForm();\n  const [visible, setVisible] = useState(false);\n  const [name, setName] = useState('');\n  const [description, setDescription] = useState('');\n  const singularCapitalized = entityDef.singular_name.toLowerCase().charAt(0).toUpperCase() + entityDef.singular_name.toLowerCase().slice(1);\n\n  useEffect(() => {\n    if(isDrawerVisible) { //opening drawer\n      form.resetFields();\n      if (entity) {\n        form.setFieldsValue({name: entity.name, description: entity.description});\n      }\n      openDrawer();\n    }\n  }, [isDrawerVisible, form, entity]);\n\n  const openDrawer = () => {\n    setVisible(true);\n  };\n\n  const closeDrawer = () => {\n    setVisible(false);\n    onDrawerClose && onDrawerClose();\n  };\n\n  const onFinish = (values) => {\n    const name = values.name.trim();\n    const description = values.description.trim();\n    if(name === '' || description === ''){\n      closeDrawer();\n      message.error('Do not leave empty fields, sorry :(');\n      return;\n    }\n    let data = {name, description};\n    if (entity === null) { //new entity\n      data.custom_entity_def_id = entityDef.id;\n      AppLogicController.createNewCustomEntity(dispatch, data).then(result => {\n        closeDrawer();\n        message.success('New ' + entityDef.singular_name.toLowerCase() + ' created!');\n      }).catch(error => {\n        closeDrawer();\n        message.error('Something went wrong, sorry :(');\n      });\n    } else { //editing entity\n      AppLogicController.updateCustomEntity(dispatch, entity.id, data).then(result => {\n        closeDrawer();\n        message.success(singularCapitalized + ' edited!');\n      }).catch(error => {\n        closeDrawer();\n        message.error('Something went wrong, sorry :(');\n      });\n    }\n  };\n\n  return (\n    <Drawer\n      title={((entity === null) ? 'New' : 'Edit') + ' ' + entityDef.singular_name.toLowerCase()}\n      width={360}\n      onClose={closeDrawer}\n      visible={visible}\n      bodyStyle={{ paddingBottom: 20 }}\n      footer={\n        <div style={{textAlign: 'right'}} >\n          <Button onClick={closeDrawer} style={{ marginRight: 8 }}>\n            Cancel\n          </Button>\n          <Button type=\"primary\" htmlType=\"submit\" form={'add-edit-custom-entity-id-' + entityDef.key}>\n            {(entity === null) ? 'Create' : 'Update'}\n          </Button>\n        </div>\n      }\n    >\n      <Form layout='vertical' name={'add-edit-custom-entity-' + entityDef.key} id={'add-edit-custom-entity-id-' + entityDef.key} form={form} onFinish={(values) => { onFinish(values) }} requiredMark={false}>\n        <Row gutter={16}>\n          <Col span={24}>\n            <Form.Item\n              name=\"name\"\n              label=\"Name\"\n              rules={[{ required: true, message: 'Please enter a name' }]}\n            >\n              <Input placeholder=\"Please enter a name\" value={name} onChange={(e) => { setName(e.target.value) }} />\n            </Form.Item>\n          </Col>\n        </Row>\n        <Row gutter={16}>\n          <Col span={24}>\n            <Form.Item\n              name=\"description\"\n              label=\"Description\"\n              rules={[{ required: true, message: 'Please enter a description' }]}\n            >\n              <TextArea rows={10} placeholder=\"Please enter a description\" value={description} onChange={(e) => { setDescription(e.target.value) }} />\n            </Form.Item>\n          </Col>\n        </Row>\n      </Form>\n    </Drawer>\n  );\n};\n\nexport default AddEditCustomEntity;\n","import { useState, useContext } from 'react';\nimport { AppContext } from '../../stores/AppStore';\nimport AppLogicController from '../../controllers/AppLogicController';\nimport { Button, Popconfirm, message } from 'antd';\nimport { useLiveQuery } from 'dexie-react-hooks';\nimport db from '../../db/AppDatabase';\nimport SimpleEntityView from '../entity_views/SimpleEntityView';\nimport AddEditCustomEntity from '../drawers/AddEditCustomEntity';\n\nconst CustomEntityConfigSection = ({ entityDef }) => {\n  const [,dispatch] = useContext(AppContext);\n  const singularCapitalized = entityDef.singular_name.toLowerCase().charAt(0).toUpperCase() + entityDef.singular_name.toLowerCase().slice(1);\n  const [addEditCustomEntityVisible, setAddEditCustomEntityVisible] = useState(false);\n  const [currentCustomEntity, setCurrentCustomEntity] = useState(null);\n\n  const entities = useLiveQuery(() => db.custom_entities.where('custom_entity_def_id').equals(entityDef.id).toArray());\n\n  const addCustomEntity = () => {\n    setCurrentCustomEntity(null);\n    setAddEditCustomEntityVisible(true);\n  };\n\n  const editEntity = (entity) => {\n    setCurrentCustomEntity(entity);\n    setAddEditCustomEntityVisible(true);\n  };\n\n  const removeEntity = (entity) => {\n    AppLogicController.deleteCustomEntity(dispatch, entity.id).then(result => {\n      message.success(singularCapitalized + ' removed!');\n    }).catch(error => {\n      message.error('Something went wrong, sorry :(');\n    });\n  };\n\n  const onRemoveEntityDef = () => {\n    AppLogicController.deleteCustomEntityDef(dispatch, entityDef.id).then(result => {\n      message.success(entityDef.name + ' removed!');\n    }).catch(error => {\n      message.error('Something went wrong, sorry :(');\n    });\n  };\n\n  return (\n    <div>\n      <div style={{textAlign: 'right', marginBottom: '20px'}} >\n        <Popconfirm\n          key='remove-entity-def'\n          title={`This section and all its content will be removed!! Are you sure you want to remove this entity?`}\n          onConfirm={onRemoveEntityDef}\n          onCancel={() => {}}\n          okText='Yes'\n          cancelText='No'\n          placement='bottomRight'\n        >\n          <Button type='default' danger>\n            Remove entity\n          </Button>\n        </Popconfirm>\n      </div>\n      { entities !== undefined && entities.map(entity =>\n        <SimpleEntityView \n          key={entity.id} \n          entity={entity} \n          entityName={entityDef.singular_name.toLowerCase()} \n          onRemove={() => { removeEntity(entity) }} \n          onEdit={() => { editEntity(entity) }} \n        />\n        )\n      }\n      <Button type='primary' onClick={addCustomEntity}>\n        Add {singularCapitalized}\n      </Button>\n      <AddEditCustomEntity\n        entity={currentCustomEntity}\n        entityDef={entityDef}\n        isDrawerVisible={addEditCustomEntityVisible} \n        onDrawerClose={() => { setAddEditCustomEntityVisible(false); }} \n      />\n    </div>\n  );\n};\n\nexport default CustomEntityConfigSection;\n","import { useState } from 'react';\nimport { Layout, Tabs, Button } from 'antd';\nimport '../../styles/components/pages/ConfigPage.scss';\nimport { PlusSquareOutlined, BgColorsOutlined } from '@ant-design/icons';\nimport AddCustomEntity from '../drawers/AddCustomEntity';\nimport EditColors from '../drawers/EditColors';\nimport { useLiveQuery } from 'dexie-react-hooks';\nimport db from '../../db/AppDatabase';\nimport GameStateConfigSection from '../sections/GameStateConfigSection';\nimport LocationConfigSection from '../sections/LocationConfigSection';\nimport CharacterConfigSection from '../sections/CharacterConfigSection';\nimport CustomEntityConfigSection from '../sections/CustomEntityConfigSection';\n\nconst { Content } = Layout;\nconst { TabPane } = Tabs;\n\nconst ConfigPage = () => {\n  const [addCustomEntityVisible, setAddCustomEntityVisible] = useState(false);\n  const [editColorsVisible, setEditColorsVisible] = useState(false);\n\n  const customEntityDefs = useLiveQuery(() => db.custom_entity_defs.toArray());\n\n  const addCustomEntityButton = <Button size='small' key='add-custom' icon={<PlusSquareOutlined />} onClick={() => { setAddCustomEntityVisible(true); }}>Add entity</Button>;\n\n  const colorsButton = <Button size='small' key='edit-colors' icon={<BgColorsOutlined />} style={{marginRight: '4px'}} onClick={() => { setEditColorsVisible(true); }}>Colors</Button>;\n\n  const buttons = [colorsButton, addCustomEntityButton];\n\n  return (\n    <>\n      <Content className='config-page'>\n        <Tabs type=\"card\" size=\"small\" tabBarExtraContent={buttons}>\n          <TabPane tab=\"Game State\" key=\"1\">\n            <GameStateConfigSection />\n          </TabPane>\n          <TabPane tab=\"Locations\" key=\"2\">\n            <LocationConfigSection />\n          </TabPane>\n          <TabPane tab=\"Characters\" key=\"3\">\n            <CharacterConfigSection />\n          </TabPane>\n          { customEntityDefs !== undefined && customEntityDefs.map((customEntityDef, index) =>\n              <TabPane tab={customEntityDef.name} key={index + 4}>\n                <CustomEntityConfigSection entityDef={customEntityDef} />\n              </TabPane>\n            )\n          }\n        </Tabs>\n      </Content>\n      <AddCustomEntity isDrawerVisible={addCustomEntityVisible} onDrawerClose={() => { setAddCustomEntityVisible(false); }} />\n      <EditColors isDrawerVisible={editColorsVisible} onDrawerClose={() => { setEditColorsVisible(false); }} />\n    </>\n  );\n};\n\nexport default ConfigPage;\n","import { Card, Typography, Button, Popconfirm } from 'antd';\nimport { CaretUpOutlined, CaretDownOutlined } from '@ant-design/icons';\nimport '../../styles/components/entity_views/ActView.scss';\n\nconst { Text } = Typography;\n\nconst ActView = ({ \n  act,\n  actIndex = null,\n  totalActs = 0,\n  canEdit = true, \n  canRemove = true,\n  onRemove = () => {},\n  onEdit = () => {},\n  onMoveOrderUp = () => {},\n  onMoveOrderDown = () => {},\n}) => {\n\n  const options = [];\n  options.push(<Text key='act-type' type='success' style={{marginRight: '24px'}}>{(act.type === 'interactive') ? 'Interactive' : 'Sequence'}</Text>);\n  options.push(\n    <Button \n      type=\"default\"\n      key='move-up' \n      icon={<CaretUpOutlined />} \n      size='small' style={{marginRight: '4px'}} \n      disabled={actIndex === 0}\n      onClick={onMoveOrderUp} />\n  );\n  options.push(\n    <Button \n      type=\"default\" \n      key='move-down' \n      icon={<CaretDownOutlined />} \n      size='small' \n      style={{marginRight: '24px'}} \n      disabled={actIndex === (totalActs-1)}\n      onClick={onMoveOrderDown} />\n  );\n  if(canEdit) {\n    options.push(<Button key='edit-act' type='link' size='small' onClick={onEdit}>Edit</Button>);\n  }\n  if(canRemove) {\n    options.push(\n      <Popconfirm\n        key='remove-act'\n        title={() => { return (<p>Are you sure you want to remove this act?<br/>All sequence actions and end conditions associated will be removed.</p>); }}\n        onConfirm={onRemove}\n        onCancel={() => {}}\n        okText='Yes'\n        cancelText='No'\n        placement='bottomRight'\n      >\n        <Button type='link' size='small'>Remove</Button>\n      </Popconfirm>\n    );\n  }\n\n  const title = 'Act ' + act.order + ': ' + act.name;\n\n  return (\n    <Card className='act-view' size='small' title={title} extra={options} headStyle={{ background: '#d9d9d9'}} >\n      <Text>{act.description}</Text>\n    </Card>\n  );\n};\n\nexport default ActView;\n","import { useContext } from 'react';\nimport { Card, Typography, Button, Popconfirm, Collapse, message } from 'antd';\nimport { CaretUpOutlined, CaretDownOutlined } from '@ant-design/icons';\nimport ActView from './ActView';\nimport { useLiveQuery } from 'dexie-react-hooks';\nimport db from '../../db/AppDatabase';\nimport AppLogicController from '../../controllers/AppLogicController';\nimport { AppContext } from '../../stores/AppStore';\nimport '../../styles/components/entity_views/ChapterView.scss';\n\nconst { Text } = Typography;\nconst { Panel } = Collapse;\n\nconst ChapterView = ({ \n  chapter,\n  chapterIndex = null,\n  totalChapters = 0,\n  canEdit = true, \n  canRemove = true,\n  onRemove = () => {},\n  onEdit = () => {},\n  onMoveOrderUp = () => {},\n  onMoveOrderDown = () => {},\n  //\n  onAddAct = () => {},\n  onEditAct = () => {},\n  onRemoveAct = () => {},\n}) => {\n  const [,dispatch] = useContext(AppContext);\n\n  const acts = useLiveQuery(() => db.acts.where('chapter_id').equals(chapter.id).toArray() );\n\n  const options = [];\n  options.push(\n    <Button \n      type=\"default\"\n      key='move-up' \n      icon={<CaretUpOutlined />} \n      size='small' style={{marginRight: '4px'}} \n      disabled={chapterIndex === 0}\n      onClick={onMoveOrderUp} />\n  );\n  options.push(\n    <Button \n      type=\"default\" \n      key='move-down' \n      icon={<CaretDownOutlined />} \n      size='small' \n      style={{marginRight: '24px'}} \n      disabled={chapterIndex === (totalChapters-1)}\n      onClick={onMoveOrderDown} />\n  );\n  if(canEdit) {\n    options.push(<Button key='edit-chapter' type='link' size='small' onClick={onEdit}>Edit</Button>);\n  }\n  if(canRemove) {\n    options.push(\n      <Popconfirm\n        key='remove-chapter'\n        title={() => { return (<p>Are you sure you want to remove this chapter?<br/>All acts, sequence actions and end conditions associated will be removed.</p>); }}\n        onConfirm={onRemove}\n        onCancel={() => {}}\n        okText='Yes'\n        cancelText='No'\n        placement='bottomRight'\n      >\n        <Button type='link' size='small'>Remove</Button>\n      </Popconfirm>\n    );\n  }\n\n  const moveActUp = (act) => {\n    const orderInfo = {oldOrder: act.order, order: act.order - 1, chapter_id: chapter.id};\n    AppLogicController.updateActOrder(dispatch, act.id, orderInfo).then(result => {\n      //\n    }).catch(error => {\n      message.error('Something went wrong, sorry :(');\n    });\n  };\n\n  const moveActDown = (act) => {\n    const orderInfo = {oldOrder: act.order, order: act.order + 1, chapter_id: chapter.id};\n    AppLogicController.updateActOrder(dispatch, act.id, orderInfo).then(result => {\n      //\n    }).catch(error => {\n      message.error('Something went wrong, sorry :(');\n    });\n  };\n\n  const title = 'Chapter ' + chapter.order + ': ' + chapter.name;\n  const totalActs = (acts !== undefined) ? acts.length : 0;\n  const actsCollapseHeader = (totalActs === 0) ? 'No acts' : ((totalActs === 1) ? '1 act' : totalActs + ' acts');\n\n  return (\n    <Card className='chapter-view' size='small' title={title} extra={options} headStyle={{ background: '#f5f5f5'}} >\n      <Text>{chapter.description}</Text>\n      <Collapse defaultActiveKey={['1']} ghost>\n        <Panel header={actsCollapseHeader} key=\"1\">\n          { acts !== undefined && acts.sort((a, b) => { return a.order - b.order; }).map((act, index) =>\n            <ActView \n              key={act.id} \n              act={act}\n              actIndex={index} \n              totalActs={totalActs}\n              onRemove={() => { onRemoveAct(act) }} \n              onEdit={() => { onEditAct(act) }} \n              onMoveOrderUp={() => { moveActUp(act) }} \n              onMoveOrderDown={() => { moveActDown(act) }} \n            />\n            )\n          }\n          <Button type='default' size='small' onClick={() => { onAddAct(totalActs)}}>\n            Add Act\n          </Button>\n        </Panel>\n      </Collapse>\n    </Card>\n  );\n};\n/*\n              onMoveOrderUp={() => { moveCharpterUp(chapter) }} \n              onMoveOrderDown={() => { moveCharpterDown(chapter) }} */\n\nexport default ChapterView;\n","import { useState, useEffect, useContext } from 'react';\nimport { Drawer, Form, Button, Col, Row, Input, message } from 'antd';\nimport { AppContext } from '../../stores/AppStore';\nimport AppLogicController from '../../controllers/AppLogicController';\n\nconst { TextArea } = Input;\n\nconst AddEditChapter = ({ chapter = null, totalChapters = 0, isDrawerVisible, onDrawerClose }) => {\n  const [,dispatch] = useContext(AppContext);\n  const [form] = Form.useForm();\n  const [visible, setVisible] = useState(false);\n  const [chapterIndex, setChapterIndex] = useState(0);\n  const [name, setName] = useState('');\n  const [description, setDescription] = useState('');\n\n  useEffect(() => {\n    if(isDrawerVisible) { //opening drawer\n      form.resetFields();\n      if (chapter) {\n        form.setFieldsValue({name: chapter.name, description: chapter.description, chapterIndex: chapter.order});\n        setChapterIndex(chapter.order);\n      } else {\n        const index = totalChapters + 1;\n        form.setFieldsValue({chapterIndex: index});\n        setChapterIndex(index);\n      }\n      openDrawer();\n    }\n  }, [isDrawerVisible, form, chapter, totalChapters]);\n\n  const openDrawer = () => {\n    setVisible(true);\n  };\n\n  const closeDrawer = () => {\n    setVisible(false);\n    onDrawerClose && onDrawerClose();\n  };\n\n  const onFinish = (values) => {\n    const name = values.name.trim();\n    const description = values.description.trim();\n    if(name === '' || description === ''){\n      closeDrawer();\n      message.error('Do not leave empty fields, sorry :(');\n      return;\n    }\n    const data = {name, description, order: chapterIndex};\n    if (chapter === null) { //new chapter\n      AppLogicController.createNewChapter(dispatch, data).then(result => {\n        closeDrawer();\n        message.success('New chapter created!');\n      }).catch(error => {\n        closeDrawer();\n        message.error('Something went wrong, sorry :(');\n      });\n    } else { //editing chapter\n      AppLogicController.updateChapter(dispatch, chapter.id, data).then(result => {\n        closeDrawer();\n        message.success('Chapter edited!');\n      }).catch(error => {\n        closeDrawer();\n        message.error('Something went wrong, sorry :(');\n      });\n    }\n  };\n\n  return (\n    <Drawer\n      title={(chapter === null) ? 'New chapter' : 'Edit chapter'}\n      width={360}\n      onClose={closeDrawer}\n      visible={visible}\n      bodyStyle={{ paddingBottom: 20 }}\n      footer={\n        <div style={{textAlign: 'right'}} >\n          <Button onClick={closeDrawer} style={{ marginRight: 8 }}>\n            Cancel\n          </Button>\n          <Button type=\"primary\" htmlType=\"submit\" form='add-edit-chapter-id'>\n            {(chapter === null) ? 'Create' : 'Update'}\n          </Button>\n        </div>\n      }\n    >\n      <Form layout='vertical' name='add-edit-chapter' id='add-edit-chapter-id' form={form} onFinish={onFinish} requiredMark={false}>\n        <Row gutter={16}>\n          <Col span={24}>\n            <Form.Item\n              name=\"chapterIndex\"\n              label=\"Chapter\"\n            >\n              <Input placeholder=\"#\" value={chapterIndex} disabled />\n            </Form.Item>\n          </Col>\n        </Row>\n        <Row gutter={16}>\n          <Col span={24}>\n            <Form.Item\n              name=\"name\"\n              label=\"Name\"\n              rules={[{ required: true, message: 'Please enter a name' }]}\n            >\n              <Input placeholder=\"Please enter a name\" value={name} onChange={(e) => { setName(e.target.value) }} />\n            </Form.Item>\n          </Col>\n        </Row>\n        <Row gutter={16}>\n          <Col span={24}>\n            <Form.Item\n              name=\"description\"\n              label=\"Description\"\n              rules={[{ required: true, message: 'Please enter a description' }]}\n            >\n              <TextArea rows={10} placeholder=\"Please enter a description\" value={description} onChange={(e) => { setDescription(e.target.value) }} />\n            </Form.Item>\n          </Col>\n        </Row>\n      </Form>\n    </Drawer>\n  );\n};\n\nexport default AddEditChapter;\n","import { useState, useEffect, useContext } from 'react';\nimport { Drawer, Form, Button, Col, Row, Input, Radio, Typography, message } from 'antd';\nimport { AppContext } from '../../stores/AppStore';\nimport AppLogicController from '../../controllers/AppLogicController';\n\nconst { TextArea } = Input;\nconst { Text } = Typography;\n\nconst AddEditAct = ({ act = null, chapter = null, totalActs = 0, isDrawerVisible, onDrawerClose }) => {\n  const [,dispatch] = useContext(AppContext);\n  const [form] = Form.useForm();\n  const [visible, setVisible] = useState(false);\n  const [actIndex, setActIndex] = useState(0);\n  const [actType, setActType] = useState('interactive');\n  const [name, setName] = useState('');\n  const [description, setDescription] = useState('');\n\n  useEffect(() => {\n    if(isDrawerVisible) { //opening drawer\n      form.resetFields();\n      if (act) {\n        form.setFieldsValue({name: act.name, description: act.description, actIndex: act.order, actType: act.type});\n        setActIndex(act.order);\n      } else {\n        const index = totalActs + 1;\n        form.setFieldsValue({actIndex: index});\n        setActIndex(index);\n      }\n      setActType('interactive');\n      openDrawer();\n    }\n  }, [isDrawerVisible, form, act, totalActs]);\n\n  const openDrawer = () => {\n    setVisible(true);\n  };\n\n  const closeDrawer = () => {\n    setVisible(false);\n    onDrawerClose && onDrawerClose();\n  };\n\n  const onFinish = (values) => {\n    const name = values.name.trim();\n    const description = values.description.trim();\n    if(name === '' || description === ''){\n      closeDrawer();\n      message.error('Do not leave empty fields, sorry :(');\n      return;\n    }\n    const data = {name, description, order: actIndex, chapter_id: chapter.id, type: actType};\n    if (act === null) { //new act\n      AppLogicController.createNewAct(dispatch, data).then(result => {\n        closeDrawer();\n        message.success('New act created!');\n      }).catch(error => {\n        closeDrawer();\n        message.error('Something went wrong, sorry :(');\n      });\n    } else { //editing act\n      AppLogicController.updateAct(dispatch, act.id, data).then(result => {\n        closeDrawer();\n        message.success('Act edited!');\n      }).catch(error => {\n        closeDrawer();\n        message.error('Something went wrong, sorry :(');\n      });\n    }\n  };\n\n  return (\n    <Drawer\n      title={(act === null) ? 'New act' : 'Edit act'}\n      width={360}\n      onClose={closeDrawer}\n      visible={visible}\n      bodyStyle={{ paddingBottom: 20 }}\n      footer={\n        <div style={{textAlign: 'right'}} >\n          <Button onClick={closeDrawer} style={{ marginRight: 8 }}>\n            Cancel\n          </Button>\n          <Button type=\"primary\" htmlType=\"submit\" form='add-edit-act-id'>\n            {(act === null) ? 'Create' : 'Update'}\n          </Button>\n        </div>\n      }\n    >\n      <Form layout='vertical' name='add-edit-act' id='add-edit-act-id' form={form} onFinish={onFinish} requiredMark={false}>\n        <Row gutter={16}>\n          <Col span={24}>\n            <Form.Item\n              name=\"actIndex\"\n              label=\"Act\"\n            >\n              <Input placeholder=\"#\" value={actIndex} disabled />\n            </Form.Item>\n          </Col>\n        </Row>\n        <Row gutter={16}>\n          <Col span={24}>\n            <Form.Item\n              name=\"name\"\n              label=\"Name\"\n              rules={[{ required: true, message: 'Please enter a name' }]}\n            >\n              <Input placeholder=\"Please enter a name\" value={name} onChange={(e) => { setName(e.target.value) }} />\n            </Form.Item>\n          </Col>\n        </Row>\n        <Row gutter={16}>\n          <Col span={24}>\n            <Form.Item\n              name=\"description\"\n              label=\"Description\"\n              rules={[{ required: true, message: 'Please enter a description' }]}\n            >\n              <TextArea rows={10} placeholder=\"Please enter a description\" value={description} onChange={(e) => { setDescription(e.target.value) }} />\n            </Form.Item>\n          </Col>\n        </Row>\n        <Row gutter={16} style={{display: (act === null ? 'block' : 'none')}}>\n          <Col span={24}>\n            <Form.Item\n              name=\"actType\"\n              label=\"Act type\"\n              initialValue='interactive'\n            >\n              <Radio.Group value={actType} onChange={(e) => { setActType(e.target.value) }} buttonStyle='solid'>\n                <Radio.Button value='interactive'>Interactive</Radio.Button>\n                <Radio.Button value='sequence'>Sequence</Radio.Button>\n              </Radio.Group>\n              <Text type='secondary' style={{display: 'block'}}>\n                { (actType === 'interactive') \n                  ? 'Interactive act allows player to choose different actions while act\\'s finished condition has not been accomplished' \n                  : 'Sequence act is used for predefined dialogs or fixed sequences (i.e. cinematics)' \n                }\n              </Text>\n            </Form.Item>\n          </Col>\n        </Row>\n      </Form>\n    </Drawer>\n  );\n};\n\nexport default AddEditAct;\n","import { useState, useContext } from 'react';\nimport { AppContext } from '../../stores/AppStore';\nimport AppLogicController from '../../controllers/AppLogicController';\nimport { Button, message } from 'antd';\nimport { useLiveQuery } from 'dexie-react-hooks';\nimport db from '../../db/AppDatabase';\nimport ChapterView from '../entity_views/ChapterView';\nimport AddEditChapter from '../drawers/AddEditChapter';\nimport AddEditAct from '../drawers/AddEditAct';\n\nconst StorylineSection = () => {\n  const [,dispatch] = useContext(AppContext);\n  const [addEditChapterVisible, setAddEditChapterVisible] = useState(false);\n  const [addEditActVisible, setAddEditActVisible] = useState(false);\n  const [currentChapter, setCurrentChapter] = useState(null);\n  const [currentAct, setCurrentAct] = useState(null);\n  const [currentChapterTotalActs, setCurrentChapterTotalActs] = useState(0);\n\n  const chapters = useLiveQuery(() => db.chapters.orderBy('order').toArray());\n\n  const addChapter = () => {\n    setCurrentChapter(null);\n    setAddEditChapterVisible(true);\n  };\n\n  const editCharpter = (chapter) => {\n    setCurrentChapter(chapter);\n    setAddEditChapterVisible(true);\n  };\n\n  const moveCharpterUp = (chapter) => {\n    const orderInfo = {oldOrder: chapter.order, order: chapter.order - 1};\n    AppLogicController.updateChapterOrder(dispatch, chapter.id, orderInfo).then(result => {\n      //\n    }).catch(error => {\n      message.error('Something went wrong, sorry :(');\n    });\n  };\n\n  const moveCharpterDown = (chapter) => {\n    const orderInfo = {oldOrder: chapter.order, order: chapter.order + 1};\n    AppLogicController.updateChapterOrder(dispatch, chapter.id, orderInfo).then(result => {\n      //\n    }).catch(error => {\n      message.error('Something went wrong, sorry :(');\n    });\n  };\n\n  const removeChapter = (chapter) => {\n    AppLogicController.deleteChapter(dispatch, chapter.id).then(result => {\n      message.success('Chapter removed!');\n    }).catch(error => {\n      message.error('Something went wrong, sorry :(');\n    });\n  };\n\n  //act handlers\n  const addAct = (chapter, totalActs) => {\n    setCurrentAct(null);\n    setCurrentChapter(chapter);\n    setCurrentChapterTotalActs(totalActs);\n    setAddEditActVisible(true);\n  };\n\n  const editAct = (act, chapter) => {\n    setCurrentChapter(chapter);\n    setCurrentAct(act);\n    setAddEditActVisible(true);\n  };\n\n  const removeAct = (act, chapter) => {\n    AppLogicController.deleteAct(dispatch, act.id, chapter.id).then(result => {\n      message.success('Act removed!');\n    }).catch(error => {\n      message.error('Something went wrong, sorry :(');\n    });\n  };\n\n  const totalChapters = (chapters !== undefined) ? chapters.length : 0;\n\n  return (\n    <div>\n      { chapters !== undefined && chapters.map((chapter, index) =>\n        <ChapterView \n          key={chapter.id} \n          chapter={chapter}\n          chapterIndex={index} \n          totalChapters={totalChapters}\n          onRemove={() => { removeChapter(chapter) }} \n          onEdit={() => { editCharpter(chapter) }} \n          onMoveOrderUp={() => { moveCharpterUp(chapter) }} \n          onMoveOrderDown={() => { moveCharpterDown(chapter) }} \n          onAddAct={(totalActs) => { addAct(chapter, totalActs) }} \n          onEditAct={(act) => { editAct(act, chapter) }}\n          onRemoveAct={(act) => { removeAct(act, chapter) }}\n        />\n        )\n      }\n      <Button type='primary' onClick={addChapter}>\n        Add Chapter\n      </Button>\n      <AddEditChapter\n        chapter={currentChapter}\n        totalChapters={totalChapters}\n        isDrawerVisible={addEditChapterVisible} \n        onDrawerClose={() => { setAddEditChapterVisible(false); }} \n      />\n      <AddEditAct\n        act={currentAct}\n        chapter={currentChapter}\n        totalActs={currentChapterTotalActs}\n        isDrawerVisible={addEditActVisible} \n        onDrawerClose={() => { setAddEditActVisible(false); }} \n      />\n    </div>\n  );\n};\n\nexport default StorylineSection;\n","import { Layout, Tabs } from 'antd';\nimport '../../styles/components/pages/StoryPage.scss';\nimport StorylineSection from '../sections/StorylineSection';\n\nconst { Content } = Layout;\nconst { TabPane } = Tabs;\n\nconst StoryPage = () => {\n\n  return (\n    <Content className='story-page'>\n      <Tabs type='card' size='small'>\n        <TabPane tab='Storyline' key='1'>\n          <StorylineSection />\n        </TabPane>\n        <TabPane tab='Sequence Actions' key='2'>\n          <p>Sequence Actions</p>\n        </TabPane>\n      </Tabs>\n    </Content>\n  );\n};\n\nexport default StoryPage;\n","import { Layout } from 'antd';\nimport '../../styles/components/pages/PlayModePage.scss';\n\nconst { Content } = Layout;\n\nconst PlayModePage = () => {\n\n  return (\n    <Content className='play-mode-page'>\n      <ul>\n        <li>Required conditions to run</li>\n        <li>Launch game experience (separate page)</li>\n      </ul>\n    </Content>\n  );\n};\n\nexport default PlayModePage;\n","//-- Components --//\nimport React, { useEffect, useContext } from 'react';\nimport { Layout, Typography, Spin } from 'antd';\nimport AppNav from './components/AppNav';\nimport StoryTitle from './components/StoryTitle';\nimport EmptyProjectPage from './components/pages/EmptyProjectPage';\nimport ConfigPage from './components/pages/ConfigPage';\nimport StoryPage from './components/pages/StoryPage';\nimport PlayModePage from './components/pages/PlayModePage';\n//-- Context --//\nimport { AppContext } from './stores/AppStore';\n//-- Controller --//\nimport AppLogicController from './controllers/AppLogicController';\n//-- Images --//\nimport logo from './images/logo192.png';\n\n\nconst { Text } = Typography;\n\nconst AppLayout = () => {\n  const [state, dispatch] = useContext(AppContext);\n\n  useEffect(() => {\n    //Mount\n    AppLogicController.checkDatabaseOk(dispatch);\n    AppLogicController.checkStoryLoaded(dispatch);\n\n  }, []); // eslint-disable-line\n\n  if(!state.initialCheckDone) {\n    return (\n      <div className='app loading'>\n        <img src={logo} alt='RPG Story Playtesting' />\n        <Spin size='large' />\n      </div>\n    );\n    \n  }\n\n  if(state.databaseLoadError) {\n    return (\n      <Text style={{display: 'block', textAlign: 'center', paddingTop: 50}}>\n        This application requires IndexedDB. Please use a browser that supports this feature.\n      </Text>\n    );\n  }\n\n  if(state.storyLoadError) {\n    return (\n      <Text style={{display: 'block', textAlign: 'center', paddingTop: 50}}>\n        We were unable to load your story, please reload and make sure your file contains a RPG-SP story.<br />\n        {state.storyErrorMessage !== null && 'Error info: ' + state.storyErrorMessage}\n      </Text>\n    );\n  }\n\n  let currentPage = null;\n  if(state.storyLoaded) {\n    switch(state.page) {\n      case 'PLAYMODE': currentPage = PlayModePage; break;\n      case 'STORY': currentPage = StoryPage; break;\n      case 'CONFIG': currentPage = ConfigPage; break;\n      default: currentPage = ConfigPage; break;\n    }\n  }\n  \n\n  return (\n    <div className=\"app\">\n      <Layout>\n        <AppNav />\n        <Layout className=\"app-layout\">\n          {state.storyLoaded\n            ?\n              <>\n                <StoryTitle />\n                {React.createElement(currentPage)}\n              </>\n            : \n              <EmptyProjectPage />\n          }\n        </Layout>\n        \n      </Layout>\n    </div>\n  );\n};\n\nexport default AppLayout;\n","import AppLayout from './AppLayout';\nimport AppStore from './stores/AppStore';\nimport './styles/AntDThemeConfig.less';\nimport './styles/App.scss';\n\nconst App = () => {\n  return (\n    <AppStore>\n      <AppLayout />\n    </AppStore>\n  );\n};\n\nexport default App;\n","const reportWebVitals = onPerfEntry => {\n  if (onPerfEntry && onPerfEntry instanceof Function) {\n    import('web-vitals').then(({ getCLS, getFID, getFCP, getLCP, getTTFB }) => {\n      getCLS(onPerfEntry);\n      getFID(onPerfEntry);\n      getFCP(onPerfEntry);\n      getLCP(onPerfEntry);\n      getTTFB(onPerfEntry);\n    });\n  }\n};\n\nexport default reportWebVitals;\n","import React from 'react';\nimport ReactDOM from 'react-dom';\nimport './index.css';\nimport App from './App';\nimport reportWebVitals from './reportWebVitals';\n\nReactDOM.render(\n  <React.StrictMode>\n    <App />\n  </React.StrictMode>,\n  document.getElementById('root')\n);\n\n// If you want to start measuring performance in your app, pass a function\n// to log results (for example: reportWebVitals(console.log))\n// or send to an analytics endpoint. Learn more: https://bit.ly/CRA-vitals\nreportWebVitals();\n"],"sourceRoot":""}